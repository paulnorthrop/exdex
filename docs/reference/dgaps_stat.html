<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Sufficient statistics for the left-censored inter-exceedances time model — dgaps_stat • exdex</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sufficient statistics for the left-censored inter-exceedances time model — dgaps_stat"><meta name="description" content="Calculates sufficient statistics for the the left-censored inter-exceedances
time \(D\)-gaps model for the extremal index \(\theta\)."><meta property="og:description" content="Calculates sufficient statistics for the the left-censored inter-exceedances
time \(D\)-gaps model for the extremal index \(\theta\)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">exdex</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/exdex-vignette.html">Introducing exdex: Estimation of the Extremal Index</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/paulnorthrop/exdex/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Sufficient statistics for the left-censored inter-exceedances time model</h1>
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/exdex/blob/HEAD/R/dgaps.R"><code>R/dgaps.R</code></a></small>
      <div class="d-none name"><code>dgaps_stat.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates sufficient statistics for the the left-censored inter-exceedances
time \(D\)-gaps model for the extremal index \(\theta\).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dgaps_stat</span><span class="op">(</span><span class="va">data</span>, <span class="va">u</span>, <span class="va">q_u</span>, D <span class="op">=</span> <span class="fl">1</span>, inc_cens <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A numeric vector of raw data.  No missing values are allowed.</p></dd>


<dt id="arg-u">u<a class="anchor" aria-label="anchor" href="#arg-u"></a></dt>
<dd><p>A numeric scalar.  Extreme value threshold applied to data.</p></dd>


<dt id="arg-q-u">q_u<a class="anchor" aria-label="anchor" href="#arg-q-u"></a></dt>
<dd><p>A numeric scalar.  An estimate of the probability with which
the threshold <code>u</code> is exceeded.  If <code>q_u</code> is missing then it is
calculated using <code>mean(data &gt; u, na.rm = TRUE)</code>.</p></dd>


<dt id="arg-d">D<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>A numeric scalar.  Run parameter \(K\), as defined in Suveges and
Davison (2010).  Threshold inter-exceedances times that are not larger
than <code>k</code> units are assigned to the same cluster, resulting in a
\(K\)-gap equal to zero.  Specifically, the \(K\)-gap \(S\)
corresponding to an inter-exceedance time of \(T\) is given by
\(S = \max(T - K, 0)\).</p></dd>


<dt id="arg-inc-cens">inc_cens<a class="anchor" aria-label="anchor" href="#arg-inc-cens"></a></dt>
<dd><p>A logical scalar indicating whether or not to include
contributions from right-censored inter-exceedance times relating to the
first and last observation.  It is known that these times are greater
than or equal to the time observed. See Attalides (2015) for details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the sufficient statistics, with components</p>
<dl><dt><code>N0</code> </dt>
<dd><p>the number of left-censored inter-exceedance times.</p></dd>

    <dt><code>N1</code> </dt>
<dd><p>contribution from inter-exceedance times that are not
      left-censored (see <strong>Details</strong>).</p></dd>

    <dt><code>sum_qtd</code> </dt>
<dd><p>the sum of the (scaled) inter-exceedance times
      that are not left-censored, that is,
      \(q (I_0 T_0 + \cdots + I_N T_N)\),
      where \(q\) is estimated by the proportion of threshold
      exceedances.</p></dd>

    <dt><code>n_dgaps</code> </dt>
<dd><p>the number of inter-exceedances that contribute
      to the log-likelihood.</p></dd>

    <dt><code>q_u</code> </dt>
<dd><p>the sample proportion of values that exceed the
      threshold.</p></dd>

    <dt><code>D</code> </dt>
<dd><p>the input value of <code>D</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The sample inter-exceedance times are
  \(T_0, T_1, ..., T_{N-1}, T_N\),
  where \(T_1, ..., T_{N-1}\) are uncensored and
  \(T_0\) and \(T_N\) are right-censored.  Under the assumption that the
  inter-exceedance times are independent, the log-likelihood of the
  \(D\)-gaps model is given by
  $$l(\theta; T_0, \ldots, T_N) = N_0 \log(1 - \theta e^{-\theta d}) +
    2 N_1 \log \theta - \theta q (I_0 T_0 + \cdots + I_N T_N),$$
   where</p><ul><li><p>\(q\) is the threshold exceedance probability, estimated by
        the proportion of threshold exceedances,</p></li>
<li><p>\(d = q D\),</p></li>
<li><p>\(I_j = 1\) if \(T_j &gt; D\) and \(I_j = 0\) otherwise,</p></li>
<li><p>\(N_0\) is the number of sample inter-exceedance times that
        are left-censored, that is, are less than or equal to \(D\),</p></li>
<li><p>(apart from an adjustment for the contributions of \(T_0\) and
        \(T_N\)) \(N_1\) is the number of inter-exceedance times that
        are uncensored, that is, are greater than \(D\),</p></li>
<li><p>specifically, if <code>inc_cens = TRUE</code> then \(N_1\) is equal
        to the number of \(T_1, ..., T_{N-1}\) that are
        uncensored plus \((I_0 + I_N) / 2\).</p></li>
</ul><p>The differing treatment of uncensored and censored \(K\)-gaps reflects
   differing contributions to the likelihood. Right-censored
   inter-exceedance times whose observed values are less than or equal to
   \(D\) add no information to the likelihood because we do not know to
   which part of the likelihood they should contribute.</p>
<p>If \(N_1 = 0\) then we are in the degenerate case where there is one
   cluster (all inter-exceedance times are left-censored) and the likelihood
   is maximized at \(\theta = 0\).</p>
<p>If \(N_0 = 0\) then all exceedances occur singly (no inter-exceedance
   times are left-censored) and the likelihood is maximized at
   \(\theta = 1\).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Holesovsky, J. and Fusek, M. Estimation of the extremal index
  using censored distributions. Extremes 23, 197-213 (2020).
  <a href="https://doi.org/10.1007/s10687-020-00374-3" class="external-link">doi:10.1007/s10687-020-00374-3</a></p>
<p>Attalides, N. (2015) Threshold-based extreme value modelling,
  PhD thesis, University College London.
  <a href="https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf" class="external-link">https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="dgaps.html">dgaps</a></code> for maximum likelihood estimation of the
  extremal index \(\theta\) using the \(D\)-gaps model.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">newlyn</span>, probs <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">dgaps_stat</span><span class="op">(</span><span class="va">newlyn</span>, u <span class="op">=</span> <span class="va">u</span>, D <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $N0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 184</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $N1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sum_qtd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 270.5256</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n_dgaps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul J. Northrop, Constantinos Christodoulides.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

