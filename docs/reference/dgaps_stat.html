<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Sufficient statistics for the left-censored inter-exceedances time model — dgaps_stat • exdex</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Sufficient statistics for the left-censored inter-exceedances time model — dgaps_stat"><meta property="og:description" content="Calculates sufficient statistics for the the left-censored inter-exceedances
time \(D\)-gaps model for the extremal index \(\theta\)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">exdex</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/exdex-vignette.html">Introducing exdex: Estimation of the Extremal Index</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/paulnorthrop/exdex/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sufficient statistics for the left-censored inter-exceedances time model</h1>
    <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/exdex/blob/HEAD/R/dgaps.R" class="external-link"><code>R/dgaps.R</code></a></small>
    <div class="hidden name"><code>dgaps_stat.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates sufficient statistics for the the left-censored inter-exceedances
time \(D\)-gaps model for the extremal index \(\theta\).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">dgaps_stat</span><span class="op">(</span><span class="va">data</span>, <span class="va">u</span>, <span class="va">q_u</span>, D <span class="op">=</span> <span class="fl">1</span>, inc_cens <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>A numeric vector of raw data.  No missing values are allowed.</p></dd>
<dt>u</dt>
<dd><p>A numeric scalar.  Extreme value threshold applied to data.</p></dd>
<dt>q_u</dt>
<dd><p>A numeric scalar.  An estimate of the probability with which
the threshold <code>u</code> is exceeded.  If <code>q_u</code> is missing then it is
calculated using <code>mean(data &gt; u, na.rm = TRUE)</code>.</p></dd>
<dt>D</dt>
<dd><p>A numeric scalar.  Run parameter \(K\), as defined in Suveges and
Davison (2010).  Threshold inter-exceedances times that are not larger
than <code>k</code> units are assigned to the same cluster, resulting in a
\(K\)-gap equal to zero.  Specifically, the \(K\)-gap \(S\)
corresponding to an inter-exceedance time of \(T\) is given by
\(S = \max(T - K, 0)\).</p></dd>
<dt>inc_cens</dt>
<dd><p>A logical scalar indicating whether or not to include
contributions from right-censored inter-exceedance times relating to the
first and last observation.  It is known that these times are greater
than or equal to the time observed. See Attalides (2015) for details.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list containing the sufficient statistics, with components</p>
<dl><dt><code>N0</code> </dt>
<dd><p>the number of left-censored inter-exceedance times.</p></dd>
<dt><code>N1</code> </dt>
<dd><p>contribution from inter-exceedance times that are not
      left-censored (see <strong>Details</strong>).</p></dd>
<dt><code>sum_qtd</code> </dt>
<dd><p>the sum of the (scaled) inter-exceedance times
      that are not left-censored, that is,
      \(q (I_0 T_0 + \cdots + I_N T_N)\),
      where \(q\) is estimated by the proportion of threshold
      exceedances.</p></dd>
<dt><code>n_dgaps</code> </dt>
<dd><p>the number of inter-exceedances that contribute
      to the log-likelihood.</p></dd>
<dt><code>q_u</code> </dt>
<dd><p>the sample proportion of values that exceed the
      threshold.</p></dd>
<dt><code>D</code> </dt>
<dd><p>the input value of <code>D</code>.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The sample inter-exceedance times are
  \(T_0, T_1, ..., T_{N-1}, T_N\),
  where \(T_1, ..., T_{N-1}\) are uncensored and
  \(T_0\) and \(T_N\) are right-censored.  Under the assumption that the
  inter-exceedance times are independent, the log-likelihood of the
  \(D\)-gaps model is given by
  $$l(\theta; T_0, \ldots, T_N) = N_0 \log(1 - \theta e^{-\theta d}) +
    2 N_1 \log \theta - \theta q (I_0 T_0 + \cdots + I_N T_N),$$
   where</p><ul><li><p>\(q\) is the threshold exceedance probability, estimated by
        the proportion of threshold exceedances,</p></li>
<li><p>\(d = q D\),</p></li>
<li><p>\(I_j = 1\) if \(T_j &gt; D\) and \(I_j = 0\) otherwise,</p></li>
<li><p>\(N_0\) is the number of sample inter-exceedance times that
        are left-censored, that is, are less than or equal to \(D\),</p></li>
<li><p>(apart from an adjustment for the contributions of \(T_0\) and
        \(T_N\)) \(N_1\) is the number of inter-exceedance times that
        are uncensored, that is, are greater than \(D\),</p></li>
<li><p>specifically, if <code>inc_cens = TRUE</code> then \(N_1\) is equal
        to the number of \(T_1, ..., T_{N-1}\) that are
        uncensored plus \((I_0 + I_N) / 2\).</p></li>
</ul><p>The differing treatment of uncensored and censored \(K\)-gaps reflects
   differing contributions to the likelihood. Right-censored
   inter-exceedance times whose observed values are less than or equal to
   \(D\) add no information to the likelihood because we do not know to
   which part of the likelihood they should contribute.</p>
<p>If \(N_1 = 0\) then we are in the degenerate case where there is one
   cluster (all inter-exceedance times are left-censored) and the likelihood
   is maximized at \(\theta = 0\).</p>
<p>If \(N_0 = 0\) then all exceedances occur singly (no inter-exceedance
   times are left-censored) and the likelihood is maximized at
   \(\theta = 1\).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Holesovsky, J. and Fusek, M. Estimation of the extremal index
  using censored distributions. Extremes 23, 197-213 (2020).
  doi: <a href="https://doi.org/10.1007/s10687-020-00374-3" class="external-link">10.1007/s10687-020-00374-3</a></p>
<p>Attalides, N. (2015) Threshold-based extreme value modelling,
  PhD thesis, University College London.
  <a href="http://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf" class="external-link">http://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="dgaps.html">dgaps</a></code> for maximum likelihood estimation of the
  extremal index \(\theta\) using the \(D\)-gaps model.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">newlyn</span>, probs <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">dgaps_stat</span><span class="op">(</span><span class="va">newlyn</span>, u <span class="op">=</span> <span class="va">u</span>, D <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $N0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 184</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $N1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sum_qtd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 270.5256</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n_dgaps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Paul J. Northrop, Constantinos Christodoulides.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

