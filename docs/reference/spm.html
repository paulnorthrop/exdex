<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Semiparametric maxima estimator of the extremal index — spm • exdex</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Semiparametric maxima estimator of the extremal index — spm" />
<meta property="og:description" content="Estimates the extremal index \(\theta\) using a semiparametric block
maxima estimator of Northrop (2015) (&quot;N2015&quot;) and a variant of this
estimator studied by Berghaus and Bucher (2018) (&quot;BB2018&quot;), using
both sliding (overlapping) block maxima and disjoint (non-overlapping) block
maxima.  A simple modification (subtraction of \(1 / b\), where \(b\) is
the block size) of the Berghaus and Bucher (2018) estimator
(&quot;BB2018b&quot;) is also calculated.  Estimates of uncertainty are
calculated using the asymptotic theory developed by Berghaus and Bucher
(2018)." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">exdex</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/exdex-vignette.html">Introducing exdex: Estimation of the Extremal Index</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/paulnorthrop/exdex">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Semiparametric maxima estimator of the extremal index</h1>
    <small class="dont-index">Source: <a href='https://github.com/paulnorthrop/exdex/blob/master/R/spm_rcpp.R'><code>R/spm_rcpp.R</code></a></small>
    <div class="hidden name"><code>spm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimates the extremal index \(\theta\) using a semiparametric block
maxima estimator of Northrop (2015) (<code>"N2015"</code>) and a variant of this
estimator studied by Berghaus and Bucher (2018) (<code>"BB2018"</code>), using
both sliding (overlapping) block maxima and disjoint (non-overlapping) block
maxima.  A simple modification (subtraction of \(1 / b\), where \(b\) is
the block size) of the Berghaus and Bucher (2018) estimator
(<code>"BB2018b"</code>) is also calculated.  Estimates of uncertainty are
calculated using the asymptotic theory developed by Berghaus and Bucher
(2018).</p>
    </div>

    <pre class="usage"><span class='fu'>spm</span>(<span class='no'>data</span>, <span class='no'>b</span>, <span class='kw'>bias_adjust</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"BB3"</span>, <span class='st'>"BB1"</span>, <span class='st'>"N"</span>, <span class='st'>"none"</span>),
  <span class='kw'>constrain</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>varN</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>which_dj</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"last"</span>, <span class='st'>"first"</span>))</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A numeric vector of raw data.  No missing values are allowed.</p></td>
    </tr>
    <tr>
      <th>b</th>
      <td><p>A numeric scalar.  The block size.</p></td>
    </tr>
    <tr>
      <th>bias_adjust</th>
      <td><p>A character scalar.  Is bias-adjustment of the
raw estimate of \(\theta\) performed using the bias-reduced
estimator (<code>bias_adjust = "BB3"</code>), derived in Section 5 of
Berghaus and Bucher (2018); or a simpler version
(<code>bias_adjust = "BB1"</code>), in which the raw estimate is multiplied by
\((k-1) / k\), where \(k\) is the number of blocks; or the
bias-adjustment of the empirical distribution function used to calculate
the estimate, as detailed in Section 2 of Northrop (2015).  When disjoint
maxima are used <code>bias_adjust = "BB1"</code> and <code>bias_adjust = "N"</code>
give identical estimates of the Berghaus and Bucher (2018) variant,
as explained at the end of Section 5 of Berghaus and Bucher (2018).
If <code>bias_adjust = "none"</code> then no bias-adjustment is performed.</p></td>
    </tr>
    <tr>
      <th>constrain</th>
      <td><p>A logical scalar.  If <code>constrain = TRUE</code> then
any estimates that are greater than 1 are set to 1,
that is, they are constrained to lie in (0, 1].  This is carried out
<em>after</em> any bias-adjustment.  Otherwise,
estimates that are greater than 1 may be obtained.</p></td>
    </tr>
    <tr>
      <th>varN</th>
      <td><p>A logical scalar.  If <code>varN = TRUE</code> then the estimation
of the sampling variance of the Northrop (2015) estimator is tailored
to that estimator.  Otherwise, the sampling variance derived in
Berghaus and Bucher (2018) is used.
See <strong>Details</strong> for further information.</p></td>
    </tr>
    <tr>
      <th>which_dj</th>
      <td><p>A character scalar.  Determines which set of disjoint
maxima are used to calculate an estimate of \(\theta\): <code>"first"</code>,
only the set whose first block starts on the first observation in
<code>x</code>; <code>"last"</code>, only the set whose last block ends on the last
observation in <code>x</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of class <code><a href='https://rdrr.io/r/base/c.html'>c("spm", "exdex")</a></code> containing the
  components listed below.  The components that are vectors are
  labelled to indicate the estimator to which the constituent values
  relate: <code>"N2015"</code> for Northrop (2015), <code>"BB2018"</code> for
  Berghaus and Bucher (2018) and <code>"BB2018b"</code> for the modified version.</p>
<dt>theta_sl, theta_dj</dt><dd><p>Vectors containing the estimates of
    \(\theta\) resulting from sliding maxima and disjoint maxima
    respectively.</p></dd>
  <dt>se_sl, se_dj</dt><dd><p>The estimated standard errors associated
    with the estimates in <code>theta_sl</code> and <code>theta_dj</code>.
    The values for <code>"BB2018"</code> and <code>"BB2018b"</code> are identical.</p></dd>
  <dt>bias_sl, bias_dj</dt><dd><p>The respective values of the
      bias-adjustment applied to the raw estimates, that is, the values
      subtracted from the raw estimates.  For estimator
      <code>BB2018b</code> this includes a contribution for the subtraction
      of <code>1 / b</code>.
      If <code>bias_adjust = "N"</code> or <code>"none"</code> then
      <code>bias_sl</code> and <code>bias_dj</code> are <code><a href='https://rdrr.io/r/base/c.html'>c(0, 0, 1 / b)</a></code>.</p></dd>
  <dt>raw_theta_sl, raw_theta_dj</dt><dd><p>Vectors containing the raw estimates
    of \(\theta\), prior to any bias_adjustment.</p></dd>
  <dt>uncon_theta_sl, uncon_theta_dj</dt><dd><p>The (bias_adjusted) estimates of
    \(\theta\) before the constraint that they lie in (0, 1] has been
    applied.</p></dd>
  <dt>data_sl, data_dj</dt><dd><p>Matrices containing the \(Y\)-data and
    \(Z\)-data for the sliding an disjoint maxima respectively.
    The first columns are the \(Y\)-data, the second columns the
    \(Z\)-data.</p></dd>
  <dt>sigma2dj, sigma2dj_for_sl</dt><dd><p>Estimates of the variance
   \(\sigma_{{\rm dj}}^2\)
   defined on pages 2314-2315 of Berghaus and Bucher (2018).
   The form of the estimates is given on page 2319.
   <code>sigma2dj</code> is used in estimating the standard error <code>se_dj</code>,
   <code>sigma2dj_for_sl</code> in estimating the standard error <code>se_sl</code>.</p></dd>
  <dt>sigma2sl</dt><dd><p>Estimates of the variance
    \(\sigma_{{\rm sl}}^2\).
    defined on pages 2314-2315 of Berghaus and Bucher (2018).
    The form of the estimates is given on page 2319.
    <code>sigma2dj_for_sl</code> is used to estimate
    \(\sigma_{{\rm dj}}^2\) for this purpose.</p></dd>
  <dt>b</dt><dd><p>The input value of <code>b</code>.</p></dd>
  <dt>bias_adjust</dt><dd><p>The input value of <code>bias_adjust</code>.</p></dd>
  <dt>call</dt><dd><p>The call to <code>spm</code>.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The extremal index \(\theta\) is estimated using the
  semiparametric maxima estimator of Northrop (2015) and variant
  of this studied by Berghaus and Bucher (2018).  In each case a sample
  of 'data' is derived from the input data <code>data</code>, based on the
  empirical distribution function of these data evaluated at the
  maximum values of  of blocks of <code>b</code> contiguous values in <code>data</code>.</p>
<p>The estimators are based on an assumption that these 'data' are sampled
  approximately from an exponential distribution with mean \(1/\theta\).
  For details see page 2309 of Berghaus and Bucher (2018), where the
  'data' for the Northrop (2015) estimator are denoted \(Y\) and
  those for the Berghaus and Bucher (2018) are denoted \(Z\).
  For convenience, we will refer to these values as the
  \(Y\)-data and the \(Z\)-data.</p>
<p>The approximate nature of the model for the \(Y\)-data arises from the
  estimation of the distribution function \(F\).  A further
  approximation motivates the use of the \(Z\)-data.  If \(F\) is known
  then the variable \(Z / b\) has a beta(1, \(b\theta\)) distribution,
  so that that is, \(Z\) has mean \(1 / (\theta + 1/b)\).
  Therefore, an exponential distribution with mean \(1 / (\theta + 1/b)\)
  may provide a better approximate model, which provides the motivation for
  subtracting \(1 / b\) from the Berghaus and Bucher (2018) estimator.
  Indeed, the resulting estimates are typically close to those
  of the Northrop (2015) estimator.</p>
<p>If <code>sliding = TRUE</code> then the function uses sliding block maxima,
  that is, the largest value observed in <em>all</em>
  (<code>length(data) - b + 1</code>) blocks of <code>b</code> observations.
  If <code>sliding = FALSE</code> then disjoint block maxima, that is, the
  largest values in (<code><a href='https://rdrr.io/r/base/Round.html'>floor(n / b)</a></code>) disjoint blocks of <code>b</code>
  observations, are used.</p>
<p>Estimation of the sampling variances of the estimators is based
  on Proposition 4.1 on page 2319 of Berghaus and Bucher (2018).
  For the Northrop (2015) variant the user has the choice either to
  use the sampling variance based on the Berghaus and Bucher (2018)
  estimator, i.e. the \(Z\)-data (<code>varN = FALSE</code>) or an analogous
  version tailored to the Northrop (2015) estimator that uses the
  \(Y\)-data (<code>varN = TRUE</code>).</p>
<p>The estimates of the sampling variances of the sliding blocks estimators
  are inferred from those of the disjoint blocks estimators (see page 2319
  of Berhaus and Bucher (2018)).  The calculation of the latter uses a set
  of disjoint block maxima.  If <code><a href='https://rdrr.io/r/base/length.html'>length(data)</a></code> is not an integer
  multiple of <code>b</code> then there will be more than one set of these, and
  all are equally valid.  In this event we perform the calculation for all
  such sets and use the mean of the resulting estimates.  This reduces the
  sampling variability of the estimates at the expense of slowing down
  the calculation somewhat, particularly if <code>b</code> is small.  This may
  become apparent when calling <code>spm</code> repeatedly in
  <code><a href='choose_b.html'>choose_b</a></code>.</p>
<p>This estimator of the sampling variance of the sliding blocks estimator is
  not constrained to be positive: a negative estimate may result if the
  block size is small.  In this event
  <strong>no warning will be given until the returned object is printed</strong> and,
  for the affected estimator (<code>"N2015"</code> or <code>"BB2018/BB2018b"</code>),</p><ul>
<li><p>the corresponding estimated standard errors using sliding
            blocks will be missing in <code>se_sl</code> in the returned object,</p></li>
<li><p>if <code>bias_adjust == "BB3"</code> then bias-adjustment
            based on <code>bias_adjust == "BB1"</code> will instead be performed
            when using sliding blocks, because the former relies on the
            estimated variances of the estimators.</p></li>
</ul><p>Similarly, bias adjustment under <code>adjust = "BB3"</code> and/or subtraction
 of \(1 / b\) in the <code>"BB2018b"</code> case may, rare cases, produce a
 negative estimate of \(\theta\).  In these instances an estimate of
 zero is returned, but the values returned in <code>bias_dj</code> and
 <code>bias_sl</code> are not changed.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Northrop, P. J. (2015) An efficient semiparametric maxima
estimator of the extremal index. <em>Extremes</em> <strong>18</strong>(4), 585-603.
<a href='https://doi.org/10.1007/s10687-015-0221-5'>https://doi.org/10.1007/s10687-015-0221-5</a></p>
<p>Berghaus, B., Bucher, A. (2018) Weak convergence of a pseudo
maximum likelihood estimator for the extremal index. <em>Ann. Statist.</em>
<strong>46</strong>(5), 2307-2335. <a href='https://doi.org/10.1214/17-AOS1621'>https://doi.org/10.1214/17-AOS1621</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='confint.spm.html'>confint.spm</a></code> to estimate confidence intervals
  for \(theta\).</p>
<p><code><a href='kgaps.html'>kgaps</a></code> for maximum likelihood estimation of the
  extremal index \(\theta\) using the \(K\)-gaps model.</p>
<p><code><a href='iwls.html'>iwls</a></code>: iterated weighted least squares estimator.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>### Newlyn sea surges</span>
<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='fu'>spm</span>(<span class='no'>newlyn</span>, <span class='fl'>20</span>)
<span class='no'>theta</span></div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; spm(data = newlyn, b = 20)
#&gt; 
#&gt; Estimates of the extremal index theta:
#&gt;           N2015   BB2018  BB2018b
#&gt; sliding   0.2392  0.3078  0.2578 
#&gt; disjoint  0.2350  0.3042  0.2542 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>theta</span>)</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; spm(data = newlyn, b = 20)
#&gt; 
#&gt;                   Estimate Std. Error Bias adj.
#&gt; N2015, sliding      0.2392    0.01990  0.003317
#&gt; BB2018, sliding     0.3078    0.01642  0.003026
#&gt; BB2018b, sliding    0.2578    0.01642  0.053030
#&gt; N2015, disjoint     0.2350    0.02222  0.003726
#&gt; BB2018, disjoint    0.3042    0.02101  0.003571
#&gt; BB2018b, disjoint   0.2542    0.02101  0.053570</div><div class='input'>
<span class='co'>### S&amp;P 500 index</span>
<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='fu'>spm</span>(<span class='no'>sp500</span>, <span class='fl'>100</span>)
<span class='no'>theta</span></div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; spm(data = sp500, b = 100)
#&gt; 
#&gt; Estimates of the extremal index theta:
#&gt;           N2015   BB2018  BB2018b
#&gt; sliding   0.3264  0.3359  0.3259 
#&gt; disjoint  0.3248  0.3343  0.3243 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>theta</span>)</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; spm(data = sp500, b = 100)
#&gt; 
#&gt;                   Estimate Std. Error Bias adj.
#&gt; N2015, sliding      0.3264    0.03348  0.007996
#&gt; BB2018, sliding     0.3359    0.03343  0.008026
#&gt; BB2018b, sliding    0.3259    0.03343  0.018030
#&gt; N2015, disjoint     0.3248    0.03836  0.009045
#&gt; BB2018, disjoint    0.3343    0.03862  0.009114
#&gt; BB2018b, disjoint   0.3243    0.03862  0.019110</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Paul J. Northrop, Constantinos Christodoulides.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


