<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introducing exdex: Estimation of the Extremal Index • exdex</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introducing exdex: Estimation of the Extremal Index">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">exdex</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/exdex-vignette.html">Introducing exdex: Estimation of the Extremal Index</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/paulnorthrop/exdex">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introducing exdex: Estimation of the Extremal Index</h1>
                        <h4 class="author">Paul Northrop</h4>
            
            <h4 class="date">2019-11-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/exdex/blob/master/vignettes/exdex-vignette.Rmd"><code>vignettes/exdex-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>exdex-vignette.Rmd</code></div>

    </div>

    
    
<p>The extremal value index <span class="math inline">\(\theta\)</span> is a measure of the extent of clustering in the extremes of a stationary process, representing the reciprocal of the mean cluster size.</p>
<p>The main purpose of the <em>exdex</em> package is to implement the semiparametric maxima estimators developed in <span class="citation">Northrop (2015)</span> and <span class="citation">Berghaus and Bücher (2018)</span>. A feature of these works is the use of sliding block maxima, that is, the use of <em>all</em> blocks of consecutive values, rather than maxima over disjoint block of values. This improves efficiency of estimation, albeit at the cost of complicating theoretical work. Also provided are functions to estimate <span class="math inline">\(\theta\)</span> using two threshold-based methods: the <span class="math inline">\(K\)</span>-gaps estimator (<span class="citation">Süveges and Davison (2010)</span>) and the iterated weighted least squares estimator (<span class="citation">Süveges (2007)</span>).</p>
<div id="semiparametric-maxima-estimators" class="section level2">
<h2 class="hasAnchor">
<a href="#semiparametric-maxima-estimators" class="anchor"></a>Semiparametric maxima estimators</h2>
<p>These estimators are based on the approximate relation <span class="math inline">\(G(u_b) = F(u_b)^{b\theta}\)</span> between the marginal distribution function <span class="math inline">\(F\)</span> of the process and the distribution function <span class="math inline">\(G\)</span> of the block maximum <span class="math inline">\(M\)</span> of <span class="math inline">\(b\)</span> consecutive variables, which applies provided that <span class="math inline">\(b\)</span> and <span class="math inline">\(u_b\)</span> are large. If <span class="math inline">\(G = F^{b\theta}\)</span> then <span class="math inline">\(Y = -b\log F(M)\)</span> has an exponential(<span class="math inline">\(\theta\)</span>) distribution and <span class="math inline">\(Z = b(1 - F(M))\)</span> is a multiple <span class="math inline">\(b\)</span> of a beta(<span class="math inline">\(1, b\theta\)</span>) distribution.</p>
<p>Let <span class="math inline">\((M_1, \ldots, M_k)\)</span> be a sample of block maxima of <span class="math inline">\(b\)</span> consecutive values. The marginal distribution function <span class="math inline">\(F\)</span> is not known so we estimate it using the empirical distribution function <span class="math inline">\(\hat{F}\)</span> set <span class="math display">\[ \quad Y_i = -b \log \hat{F}(M_i), \quad Z_i = b(1 - \hat{F}(M_i)), \quad i = 1, \ldots, k \]</span> and define the estimators <span class="math display">\[ \hat{\theta}_N = \left( \frac{1}{k} \sum_{i=1}^k Y_i \right)^{-1} \quad 
\hat{\theta}_{BB} = \left( \frac{1}{k} \sum_{i=1}^k Z_i \right)^{-1}. \]</span> These two estimators are equivalent asymptotically. The former is the estimator proposed in <span class="citation">Northrop (2015)</span>. <span class="citation">Berghaus and Bücher (2018)</span> derived asymptotic properties of the latter, because it is more amenable to mathematical analysis.</p>
<p>The function <code>spm</code> provides three estimators, estimated using both sliding and disjoint block maxima and four types of bias-adjustment. The estimators are <span class="math inline">\(\hat{\theta}_N, \hat{\theta}_{BB}\)</span> and <span class="math inline">\(\hat{\theta}_{BB}-1/b\)</span>. The latter is motivated by the observation that E<span class="math inline">\((Z) = (\theta + 1/b)^{-1} &lt; \theta^{-1}\)</span> and therefore the subtraction of <span class="math inline">\(1 / b\)</span> provides further bias-adjustment. In fact empirical results indicate that <span class="math inline">\(\hat{\theta}_N\)</span> and <span class="math inline">\(\hat{\theta}_{BB} - 1/b\)</span> produce similar estimates.</p>
<div id="newlyn-sea-surges" class="section level3">
<h3 class="hasAnchor">
<a href="#newlyn-sea-surges" class="anchor"></a>Newlyn sea surges</h3>
<p>We provide an illustration of the <code>spm</code> function using the <code>newlyn</code> data, a time series of 2894 maximum seas surges measured at Newlyn, Cornwall, UK over the period 1971-1976. We use a block size <span class="math inline">\(b = 20\)</span>. We explain in <a href="#choosb">Block size selection</a> how this value was chosen.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(exdex)
theta &lt;-<span class="st"> </span><span class="kw"><a href="../reference/spm.html">spm</a></span>(newlyn, <span class="dv">20</span>)
<span class="co"># Estimates: BB2018b is BB2018 - 1/b</span>
theta
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; spm(data = newlyn, b = 20)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates of the extremal index theta:</span>
<span class="co">#&gt;           N2015   BB2018  BB2018b</span>
<span class="co">#&gt; sliding   0.2392  0.3078  0.2578 </span>
<span class="co">#&gt; disjoint  0.2350  0.3042  0.2542</span>
<span class="co"># Estimates, SEs and bias-adjustments</span>
<span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(theta)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; spm(data = newlyn, b = 20)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                   Estimate Std. Error Bias adj.</span>
<span class="co">#&gt; N2015, sliding      0.2392    0.01990  0.003317</span>
<span class="co">#&gt; BB2018, sliding     0.3078    0.01642  0.003026</span>
<span class="co">#&gt; BB2018b, sliding    0.2578    0.01642  0.053030</span>
<span class="co">#&gt; N2015, disjoint     0.2350    0.02222  0.003726</span>
<span class="co">#&gt; BB2018, disjoint    0.3042    0.02101  0.003571</span>
<span class="co">#&gt; BB2018b, disjoint   0.2542    0.02101  0.053570</span></code></pre></div>
<p>There is a <code>confint</code> method for calculating confidence intervals using objects returned from <code>spm</code>. The likelihood-based intervals are based on an adjustment (performed by the <code>chandwich</code> package <span class="citation">Northrop and Chandler (2019)</span>) of the naive (pseudo-)loglikelihood so that the curvature of the adjusted loglikelihood agrees with the estimated standard errors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Sliding maxima, symmetric intervals</span>
conf &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span>(theta)
<span class="co"># Sliding maxima, likelihood-based intervals</span>
conf &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span>(theta, <span class="dt">interval_type =</span> <span class="st">"lik"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(conf)</code></pre></div>
<p><img src="exdex-vignette_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>For this small block size of <span class="math inline">\(b = 20\)</span> there is an appreciable difference between the inferences from the N2015 and BB2018 estimates.</p>
</div>
<div id="sp-500-index" class="section level3">
<h3 class="hasAnchor">
<a href="#sp-500-index" class="anchor"></a>S&amp;P 500 index</h3>
<p>We also consider a dataset (<code>sp500</code>) that is similar to one analysed in <span class="citation">Berghaus and Bücher (2018)</span>: daily log returns of the S&amp;P 500 index, from 3rd January 1990 to 9th October 2018. We use a block size <span class="math inline">\(b = 225\)</span>, which is similar to that chosen by <span class="citation">Berghaus and Bücher (2018)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">theta &lt;-<span class="st"> </span><span class="kw"><a href="../reference/spm.html">spm</a></span>(sp500, <span class="dv">225</span>)
<span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(theta)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; spm(data = sp500, b = 225)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                   Estimate Std. Error Bias adj.</span>
<span class="co">#&gt; N2015, sliding      0.2454    0.04075   0.01451</span>
<span class="co">#&gt; BB2018, sliding     0.2497    0.04069   0.01452</span>
<span class="co">#&gt; BB2018b, sliding    0.2453    0.04069   0.01897</span>
<span class="co">#&gt; N2015, disjoint     0.2402    0.04150   0.01472</span>
<span class="co">#&gt; BB2018, disjoint    0.2446    0.04152   0.01475</span>
<span class="co">#&gt; BB2018b, disjoint   0.2401    0.04152   0.01920</span>
conf &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span>(theta, <span class="dt">interval_type =</span> <span class="st">"lik"</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(conf)</code></pre></div>
<p><img src="exdex-vignette_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>For this large block size there is very little difference between the inferences produce by the three estimators.</p>
</div>
<div id="chooseb" class="section level3">
<h3 class="hasAnchor">
<a href="#chooseb" class="anchor"></a>Block size selection</h3>
<p>An informal way to choose the value of <span class="math inline">\(b\)</span> is plots estimates of <span class="math inline">\(\theta\)</span> over a range of values of <span class="math inline">\(b\)</span> and to select the smallest <span class="math inline">\(b\)</span> above which these estimates appear to be constant with respect to <span class="math inline">\(b\)</span>, taking into account sampling variability. The function <code>choose_b</code>, and its associated plot method, does this, quantifying sampling variability using pointwise confidence intervals. The plot method allows us to select one of 3 estimators and choose whether to use sliding or disjoint block maxima. The default is to plot the estimates using the <span class="citation">Northrop (2015)</span> estimator applied to sliding maxima.</p>
<p>For the <code>newlyn</code> data we obtain the following plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot like the top left of Northrop (2015)</span>
<span class="co"># We remove the 14 values because 2880 has lots of factors</span>
b_vals &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">24</span>,<span class="dv">30</span>,<span class="dv">32</span>,<span class="dv">36</span>,<span class="dv">40</span>,<span class="dv">45</span>,<span class="dv">48</span>,<span class="dv">54</span>,<span class="dv">60</span>)
res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/choose_b.html">choose_b</a></span>(newlyn[<span class="dv">1</span><span class="op">:</span><span class="dv">2880</span>], b_vals)
<span class="co"># Some b are too small for the sampling variance of the sliding blocks</span>
<span class="co"># estimator to be estimated</span>
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(res, <span class="dt">ylim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">1</span>))</code></pre></div>
<p><img src="exdex-vignette_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>This plots suggests that <span class="math inline">\(b = 20\)</span> is a reasonable block size to choose. Indeed the point estimates varies smoothly with <span class="math inline">\(b\)</span> and varies little for <span class="math inline">\(b \geq 20\)</span>. The confidence intervals tend to widen as <span class="math inline">\(b\)</span> increases, although the method for estimating these intervals is somewhat sensitive to block size owing to its use of disjoint block maxima. See the help file for <code>spm</code> and <span class="citation">Berghaus and Bücher (2018)</span> for further information. Note that for very small values of <span class="math inline">\(b\)</span> it may not be possible to estimate the confidence intervals, hence the missing intervals in this plot.</p>
<p>For the <code>sp500</code> data we obtain the following plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">b_vals &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">10</span>, <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dt">from =</span> <span class="dv">25</span>, <span class="dt">to =</span> <span class="dv">350</span>, <span class="dt">by =</span> <span class="dv">25</span>), <span class="dv">357</span>)
res500 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/choose_b.html">choose_b</a></span>(sp500, b_vals)
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(res500, <span class="dt">ylim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">1</span>))</code></pre></div>
<p><img src="exdex-vignette_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>The estimates of <span class="math inline">\(\theta\)</span> stabilise less quickly than for the <code>newlyn</code> data but <span class="math inline">\(b = 225\)</span> seems to be reasonable choice.</p>
</div>
</div>
<div id="threshold-based-estimators" class="section level2">
<h2 class="hasAnchor">
<a href="#threshold-based-estimators" class="anchor"></a>Threshold-based estimators</h2>
<p>These estimators are based on the distribution of the times at which observations exceed some high threshold <span class="math inline">\(u\)</span>. They are based on <span class="citation">Ferro and Segers (2003)</span>, which uses a limiting (<span class="math inline">\(u \rightarrow \infty\)</span>) mixture model to represent the distribution of within- and between-cluster interexceedance times. Under the model with probability <span class="math inline">\(\theta\)</span> an interexceedance time has an exponential distribution with mean <span class="math inline">\(1/\theta\)</span> (a between-cluster time) and otherwise the interexceedance time is, in theory, zero (a within-cluster time).</p>
<p>In practice, zero interexceedance times are impossible and some adjustment is advisable in order to mitigate the effects of the model not fitting well for small interexceedance times. The following estimators take different approaches to solving this problem.</p>
<div id="k-gaps" class="section level3">
<h3 class="hasAnchor">
<a href="#k-gaps" class="anchor"></a><span class="math inline">\(K\)</span>-gaps</h3>
<p><span class="citation">Süveges and Davison (2010)</span> to introduce an extra tuning parameter, <em>run</em> parameter <span class="math inline">\(K\)</span> that truncates interexceedance times, with the effect that any interexceedance time that is <span class="math inline">\(\leq K\)</span> is set to zero. Provided that a suitable value of <span class="math inline">\(K\)</span> is chosen <span class="math inline">\(\theta\)</span> may be estimated under the mixture model using maximum likelihood estimation. The following code does this using a particular threshold and <span class="math inline">\(K = 1\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">u &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(sp500, <span class="dt">probs =</span> <span class="fl">0.60</span>)
theta &lt;-<span class="st"> </span><span class="kw"><a href="../reference/kgaps.html">kgaps</a></span>(sp500, u, <span class="dt">k =</span> <span class="dv">1</span>)
<span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(theta)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; kgaps(data = sp500, u = u, k = 1)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       Estimate Std. Error</span>
<span class="co">#&gt; theta   0.6953   0.007234</span></code></pre></div>
<p><span class="citation">Süveges and Davison (2010)</span> propose a diagnostic test, an information matrix text (IMT), to inform the choice of <span class="math inline">\((u, K)\)</span>. The test is based on a statistics that compares the Fisher information for <span class="math inline">\(\theta\)</span> to the variance of the score statistic, both evaluated at the estimate <span class="math inline">\(\hat{\theta}\)</span>, because these two quantities are equal for a well-specified regular model. The following code performs this test, using a test of size <span class="math inline">\(\alpha = 0.05\)</span>, for a range of values of <span class="math inline">\(u\)</span> and <span class="math inline">\(K\)</span> and produces graphical summary containing a horizontal line to indicator the critical value of the test.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">u &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(sp500, <span class="dt">probs =</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="dt">by =</span> <span class="fl">0.1</span>))
imt_theta &lt;-<span class="st"> </span><span class="kw"><a href="../reference/choose_uk.html">choose_uk</a></span>(sp500, <span class="dt">u =</span> u, <span class="dt">k =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(imt_theta, <span class="dt">uprob =</span> <span class="ot">TRUE</span>, <span class="dt">alpha =</span> <span class="fl">0.05</span>)</code></pre></div>
<p><img src="exdex-vignette_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>Large values of the IMT statistic suggest a poor choice of <span class="math inline">\((u, K)\)</span>. Diagnostic plots like this are never clear cut but the fact that for <span class="math inline">\(K = 1\)</span> the IMT statistics drops below the critical value at around the sample 60% quantile suggests the combination of <span class="math inline">\(u\)</span> and <span class="math inline">\(K\)</span> that we used above.</p>
</div>
<div id="iterated-weighted-least-squares" class="section level3">
<h3 class="hasAnchor">
<a href="#iterated-weighted-least-squares" class="anchor"></a>Iterated weighted least squares</h3>
<p>Under the limiting mixture model <span class="math inline">\(\theta\)</span> is the proportion of interexceedance times that are between clusters. <span class="citation">Süveges (2007)</span> uses this to devise and iterated scheme for estimating <span class="math inline">\(\theta\)</span>. An initial estimate of <span class="math inline">\(\theta\)</span> is set. An exponential distribution is fitted to the largest <span class="math inline">\(100\theta\%\)</span> of the interexceedance times using weighted least squares estimation. Then the new estimate of <span class="math inline">\(\theta\)</span> is used to set the putative exponential sample and the estimation proceeds until the estimate of <span class="math inline">\(\theta\)</span> converges.</p>
<p>The current implementation of this estimator in <em>exdex</em> is very limited: only an estimate is produced, with no estimates of uncertainty. The next release of <em>exdex</em> will rectify this.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">u &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(newlyn, <span class="dt">probs =</span> <span class="fl">0.90</span>)
theta &lt;-<span class="st"> </span><span class="kw"><a href="../reference/iwls.html">iwls</a></span>(newlyn, u)
theta
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; iwls(data = newlyn, u = u)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Convergence (0 means success): 0 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimate of the extremal index theta:</span>
<span class="co">#&gt; [1]  0.2514</span></code></pre></div>
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script><div id="refs" class="references">
<div id="ref-BB2018">
<p>Berghaus, B., and A. Bücher. 2018. “Weak Convergence of a Pseudo Maximum Likelihood Estimator for the Extremal Index.” <em>Ann. Statist.</em> 46 (5). The Institute of Mathematical Statistics: 2307–35. doi:<a href="https://doi.org/10.1214/17-AOS1621">10.1214/17-AOS1621</a>.</p>
</div>
<div id="ref-FS2003">
<p>Ferro, C. A. T., and J. Segers. 2003. “Inference for Clusters of Extreme Values.” <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 65 (2). Blackwell Publishing: 545–56. doi:<a href="https://doi.org/10.1111/1467-9868.00401">10.1111/1467-9868.00401</a>.</p>
</div>
<div id="ref-Northrop2015">
<p>Northrop, P. J. 2015. “An Efficient Semiparametric Maxima Estimator of the Extremal Index.” <em>Extremes</em> 18 (4): 585–603. doi:<a href="https://doi.org/10.1007/s10687-015-0221-5">10.1007/s10687-015-0221-5</a>.</p>
</div>
<div id="ref-chandwich">
<p>Northrop, P. J., and R. E. Chandler. 2019. <em>Chandwich: Chandler-Bate Sandwich Loglikelihood Adjustment</em>. <a href="http://github.com/paulnorthrop/chandwich" class="uri">http://github.com/paulnorthrop/chandwich</a>.</p>
</div>
<div id="ref-Suveges2007">
<p>Süveges, M. 2007. “Likelihood Estimation of the Extremal Index.” <em>Extremes</em> 10 (1-2): 41–55. doi:<a href="https://doi.org/10.1007/s10687-007-0034-2">10.1007/s10687-007-0034-2</a>.</p>
</div>
<div id="ref-SD2010">
<p>Süveges, M., and A. C. Davison. 2010. “Model Misspecification in Peaks over Threshold Analysis.” <em>The Annals of Applied Statistics</em> 4 (1): 203–21. doi:<a href="https://doi.org/10.1214/09-AOAS292">10.1214/09-AOAS292</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#semiparametric-maxima-estimators">Semiparametric maxima estimators</a></li>
      <li><a href="#threshold-based-estimators">Threshold-based estimators</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Paul J. Northrop, Constantinos Christodoulides.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
