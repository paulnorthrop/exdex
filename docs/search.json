[{"path":"https://github.com/paulnorthrop/exdex/articles/exdex-vignette.html","id":"semiparametric-maxima-estimators","dir":"Articles","previous_headings":"","what":"Semiparametric maxima estimators","title":"Introducing exdex: Estimation of the Extremal Index","text":"estimators based approximate relation \\(G(u_b) = F(u_b)^{b\\theta}\\) marginal distribution function \\(F\\) process distribution function \\(G\\) block maximum \\(M\\) \\(b\\) consecutive variables, applies provided \\(b\\) \\(u_b\\) large. \\(G = F^{b\\theta}\\) \\(Y = -b\\log F(M)\\) exponential(\\(\\theta\\)) distribution \\(Z = b(1 - F(M))\\) multiple \\(b\\) beta(\\(1, b\\theta\\)) distribution. Let \\((M_1, \\ldots, M_k)\\) sample block maxima \\(b\\) consecutive values. marginal distribution function \\(F\\) known estimate using empirical distribution function \\(\\hat{F}\\) set \\[ \\quad Y_i = -b \\log \\hat{F}(M_i), \\quad Z_i = b(1 - \\hat{F}(M_i)), \\quad = 1, \\ldots, k \\] define estimators \\[ \\hat{\\theta}_N = \\left( \\frac{1}{k} \\sum_{=1}^k Y_i \\right)^{-1} \\quad \\hat{\\theta}_{BB} = \\left( \\frac{1}{k} \\sum_{=1}^k Z_i \\right)^{-1}. \\] two estimators equivalent asymptotically. former estimator proposed Northrop (2015). Berghaus Bücher (2018) derived asymptotic properties latter, amenable mathematical analysis. function spm provides three estimators, estimated using sliding disjoint block maxima four types bias-adjustment. estimators \\(\\hat{\\theta}_N, \\hat{\\theta}_{BB}\\) \\(\\hat{\\theta}_{BB}-1/b\\). latter motivated observation E\\((Z) = (\\theta + 1/b)^{-1} < \\theta^{-1}\\) therefore subtraction \\(1 / b\\) provides bias-adjustment. fact empirical results indicate \\(\\hat{\\theta}_N\\) \\(\\hat{\\theta}_{BB} - 1/b\\) produce similar estimates.","code":""},{"path":"https://github.com/paulnorthrop/exdex/articles/exdex-vignette.html","id":"newlyn-sea-surges","dir":"Articles","previous_headings":"Semiparametric maxima estimators","what":"Newlyn sea surges","title":"Introducing exdex: Estimation of the Extremal Index","text":"provide illustration spm function using newlyn data, time series 2894 maximum seas surges measured Newlyn, Cornwall, UK period 1971-1976. use block size \\(b = 20\\). explain Block size selection value chosen. confint method calculating confidence intervals using objects returned spm. likelihood-based intervals based adjustment (performed chandwich package Northrop Chandler (2021)) naive (pseudo-)loglikelihood curvature adjusted loglikelihood agrees estimated standard errors.  small block size \\(b = 20\\) appreciable difference inferences N2015 BB2018 estimates.","code":"library(exdex) theta <- spm(newlyn, 20) # Estimates: BB2018b is BB2018 - 1/b theta #>  #> Call: #> spm(data = newlyn, b = 20) #>  #> Estimates of the extremal index theta: #>           N2015   BB2018  BB2018b #> sliding   0.2392  0.3078  0.2578  #> disjoint  0.2350  0.3042  0.2542 # Estimates, SEs and bias-adjustments summary(theta) #>  #> Call: #> spm(data = newlyn, b = 20) #>  #>                   Estimate Std. Error Bias adj. #> N2015, sliding      0.2392    0.01990  0.003317 #> BB2018, sliding     0.3078    0.01642  0.003026 #> BB2018b, sliding    0.2578    0.01642  0.053030 #> N2015, disjoint     0.2350    0.02222  0.003726 #> BB2018, disjoint    0.3042    0.02101  0.003571 #> BB2018b, disjoint   0.2542    0.02101  0.053570 # Sliding maxima, symmetric intervals conf <- confint(theta) # Sliding maxima, likelihood-based intervals conf <- confint(theta, interval_type = \"lik\") plot(conf)"},{"path":"https://github.com/paulnorthrop/exdex/articles/exdex-vignette.html","id":"sp-500-index","dir":"Articles","previous_headings":"Semiparametric maxima estimators","what":"S&P 500 index","title":"Introducing exdex: Estimation of the Extremal Index","text":"also consider dataset (sp500) similar one analysed Berghaus Bücher (2018): daily log returns S&P 500 index, 3rd January 1990 9th October 2018. use block size \\(b = 225\\), similar chosen Berghaus Bücher (2018).  large block size little difference inferences produce three estimators.","code":"theta <- spm(sp500, 225) summary(theta) #>  #> Call: #> spm(data = sp500, b = 225) #>  #>                   Estimate Std. Error Bias adj. #> N2015, sliding      0.2454    0.04075   0.01451 #> BB2018, sliding     0.2497    0.04069   0.01452 #> BB2018b, sliding    0.2453    0.04069   0.01897 #> N2015, disjoint     0.2402    0.04150   0.01472 #> BB2018, disjoint    0.2446    0.04152   0.01475 #> BB2018b, disjoint   0.2401    0.04152   0.01920 conf <- confint(theta, interval_type = \"lik\") plot(conf)"},{"path":"https://github.com/paulnorthrop/exdex/articles/exdex-vignette.html","id":"chooseb","dir":"Articles","previous_headings":"Semiparametric maxima estimators","what":"Block size selection","title":"Introducing exdex: Estimation of the Extremal Index","text":"informal way choose value \\(b\\) plots estimates \\(\\theta\\) range values \\(b\\) select smallest \\(b\\) estimates appear constant respect \\(b\\), taking account sampling variability. function choose_b, associated plot method, , quantifying sampling variability using pointwise confidence intervals. plot method allows us select one 3 estimators choose whether use sliding disjoint block maxima. default plot estimates using Northrop (2015) estimator applied sliding maxima. newlyn data obtain following plot.  plots suggests \\(b = 20\\) reasonable block size choose. Indeed point estimates varies smoothly \\(b\\) varies little \\(b \\geq 20\\). confidence intervals tend widen \\(b\\) increases, although method estimating intervals somewhat sensitive block size owing use disjoint block maxima. See help file spm Berghaus Bücher (2018) information. Note small values \\(b\\) may possible estimate confidence intervals, hence missing intervals plot. sp500 data obtain following plot.  estimates \\(\\theta\\) stabilise less quickly newlyn data \\(b = 225\\) seems reasonable choice.","code":"# Plot like the top left of Northrop (2015) # We remove the 14 values because 2880 has lots of factors b_vals <- c(2,3,4,5,6,8,9,10,12,15,16,18,20,24,30,32,36,40,45,48,54,60) res <- choose_b(newlyn[1:2880], b_vals) # Some b are too small for the sampling variance of the sliding blocks # estimator to be estimated plot(res, ylim = c(0, 1)) b_vals <- c(10, seq(from = 25, to = 350, by = 25), 357) res500 <- choose_b(sp500, b_vals) plot(res500, ylim = c(0, 1))"},{"path":"https://github.com/paulnorthrop/exdex/articles/exdex-vignette.html","id":"threshold-based-estimators","dir":"Articles","previous_headings":"","what":"Threshold-based estimators","title":"Introducing exdex: Estimation of the Extremal Index","text":"estimators based distribution times observations exceed high threshold \\(u\\). based Ferro Segers (2003), uses limiting (\\(u \\rightarrow \\infty\\)) mixture model represent distribution within- -cluster inter-exceedance times. model probability \\(\\theta\\) inter-exceedance time exponential distribution mean \\(1/\\theta\\) (-cluster time) otherwise inter-exceedance time , theory, zero (within-cluster time). practice, zero inter-exceedance times impossible adjustment advisable order mitigate effects model fitting well small inter-exceedance times. following estimators take different approaches solving problem.","code":""},{"path":"https://github.com/paulnorthrop/exdex/articles/exdex-vignette.html","id":"k-gaps","dir":"Articles","previous_headings":"Threshold-based estimators","what":"\\(K\\)-gaps","title":"Introducing exdex: Estimation of the Extremal Index","text":"Süveges Davison (2010) introduce extra tuning parameter, run parameter \\(K\\) truncates inter-exceedance times, effect inter-exceedance time \\(\\leq K\\) set zero. Provided suitable value \\(K\\) chosen \\(\\theta\\) may estimated mixture model using maximum likelihood estimation. following code using particular threshold \\(K = 1\\). Süveges Davison (2010) propose diagnostic test, information matrix text (IMT), inform choice \\((u, K)\\). test based statistics compares Fisher information \\(\\theta\\) variance score statistic, evaluated estimate \\(\\hat{\\theta}\\), two quantities equal well-specified regular model. following code performs test, using test size \\(\\alpha = 0.05\\), range values \\(u\\) \\(K\\) produces graphical summary containing horizontal line indicator critical value test.  Large values IMT statistic suggest poor choice \\((u, K)\\). Diagnostic plots like never clear cut fact \\(K = 1\\) IMT statistics drops critical value around sample 60% quantile suggests combination \\(u\\) \\(K\\) used .","code":"u <- quantile(sp500, probs = 0.60) theta <- kgaps(sp500, u, k = 1) summary(theta) #>  #> Call: #> kgaps(data = sp500, u = u, k = 1) #>  #>       Estimate Std. Error #> theta   0.6953   0.007234 u <- quantile(sp500, probs = seq(0.1, 0.9, by = 0.1)) imt_theta <- choose_uk(sp500, u = u, k = 1:5) plot(imt_theta, uprob = TRUE, alpha = 0.05)"},{"path":"https://github.com/paulnorthrop/exdex/articles/exdex-vignette.html","id":"multiple-time-series-and-missing-values","dir":"Articles","previous_headings":"Threshold-based estimators > \\(K\\)-gaps","what":"Multiple time series and missing values","title":"Introducing exdex: Estimation of the Extremal Index","text":"cheeseboro dataset contains hourly maximum wind gusts recorded Cheeseboro weather station near Thousand Oaks, Southern California, USA month January period 2000-2009. Therefore, data contain 10 time series shall consider approximately independent . data also contain several missing values. Inside kgaps() data divided sequences non-missing values sequence stored separate column matrix. \\(K\\)-gaps log-likelihood constructed sum contributions columns.  data diagnostic graphic choosing \\((u, K)\\) perhaps less clear sp500 data. example, use \\(u = 45\\) mph \\(K = 3\\) .","code":"summary(cheeseboro) #>       2000            2001            2002            2003       #>  Min.   : 0.00   Min.   : 3.00   Min.   : 2.00   Min.   : 1.00   #>  1st Qu.: 8.00   1st Qu.:10.00   1st Qu.: 8.00   1st Qu.: 7.00   #>  Median :11.00   Median :15.00   Median :12.00   Median :12.00   #>  Mean   :13.59   Mean   :18.88   Mean   :14.68   Mean   :16.47   #>  3rd Qu.:16.00   3rd Qu.:25.00   3rd Qu.:19.00   3rd Qu.:20.00   #>  Max.   :63.00   Max.   :69.00   Max.   :62.00   Max.   :92.00   #>  NA's   :12      NA's   :9       NA's   :14      NA's   :4       #>       2004            2005            2006            2007           2008       #>  Min.   : 2.00   Min.   : 0.00   Min.   : 2.00   Min.   : 1.0   Min.   : 2.00   #>  1st Qu.: 9.00   1st Qu.: 8.00   1st Qu.: 9.00   1st Qu.: 9.0   1st Qu.:10.00   #>  Median :13.00   Median :13.00   Median :14.00   Median :15.0   Median :15.00   #>  Mean   :15.61   Mean   :16.23   Mean   :18.83   Mean   :18.7   Mean   :17.47   #>  3rd Qu.:20.00   3rd Qu.:22.00   3rd Qu.:25.00   3rd Qu.:27.0   3rd Qu.:23.00   #>  Max.   :53.00   Max.   :51.00   Max.   :71.00   Max.   :60.0   Max.   :53.00   #>                  NA's   :1       NA's   :2                                      #>       2009       #>  Min.   : 0.00   #>  1st Qu.: 9.00   #>  Median :15.00   #>  Mean   :18.86   #>  3rd Qu.:27.00   #>  Max.   :62.00   #> probs <- c(seq(0.5, 0.98, by = 0.025), 0.99) u <- quantile(cheeseboro, probs = probs, na.rm = TRUE) imt_theta <- choose_uk(cheeseboro, u, k = 1:10) plot(imt_theta, uprob = FALSE, lwd = 2) theta <- kgaps(cheeseboro, 45, k = 3) theta #>  #> Call: #> kgaps(data = cheeseboro, u = 45, k = 3) #>  #> Estimate of the extremal index theta: #>  theta   #> 0.2405 summary(theta) #>  #> Call: #> kgaps(data = cheeseboro, u = 45, k = 3) #>  #>       Estimate Std. Error #> theta   0.2405    0.02336"},{"path":"https://github.com/paulnorthrop/exdex/articles/exdex-vignette.html","id":"d-gaps","dir":"Articles","previous_headings":"Threshold-based estimators","what":"\\(D\\)-gaps","title":"Introducing exdex: Estimation of the Extremal Index","text":"version 1.2.1 exdex estimator \\(\\theta\\) developed Holesovsky Fusek (2020) available, involves censoring parameter \\(D\\). estimator similar \\(K\\)-gaps estimator, treatment small inter-exceedance times different. Threshold inter-exceedances times larger units left-censored contribute log-likelihood information \\(\\leq D\\). function dgaps calculates maximum likelihood estimates \\(\\theta\\).","code":"theta <- dgaps(cheeseboro, 45, D = 3) theta #>  #> Call: #> dgaps(data = cheeseboro, u = 45, D = 3) #>  #> Estimate of the extremal index theta: #>  theta   #> 0.2431 summary(theta) #>  #> Call: #> dgaps(data = cheeseboro, u = 45, D = 3) #>  #>       Estimate Std. Error #> theta   0.2431    0.02396"},{"path":"https://github.com/paulnorthrop/exdex/articles/exdex-vignette.html","id":"iterated-weighted-least-squares","dir":"Articles","previous_headings":"Threshold-based estimators","what":"Iterated weighted least squares","title":"Introducing exdex: Estimation of the Extremal Index","text":"limiting mixture model \\(\\theta\\) proportion inter-exceedance times clusters. Süveges (2007) uses devise iterated scheme estimating \\(\\theta\\). initial estimate \\(\\theta\\) set. exponential distribution fitted largest \\(100\\theta\\%\\) inter-exceedance times using weighted least squares estimation. new estimate \\(\\theta\\) used set putative exponential sample estimation proceeds estimate \\(\\theta\\) converges. current implementation estimator exdex limited: estimate produced, estimates uncertainty. next release exdex rectify .","code":"u <- quantile(newlyn, probs = 0.90) theta <- iwls(newlyn, u) theta #>  #> Call: #> iwls(data = newlyn, u = u) #>  #> Convergence (0 means success): 0  #>  #> Estimate of the extremal index theta: #> [1]  0.2514"},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Paul J. Northrop. Author, maintainer, copyright holder. Constantinos Christodoulides. Author, copyright holder.","code":""},{"path":"https://github.com/paulnorthrop/exdex/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Northrop PJ, Christodoulides C (2026). exdex: Estimation Extremal Index. R package version 1.2.4, https://github.com/paulnorthrop/exdex.","code":"@Manual{,   title = {exdex: Estimation of the Extremal Index},   author = {Paul J. Northrop and Constantinos Christodoulides},   year = {2026},   note = {R package version 1.2.4},   url = {https://github.com/paulnorthrop/exdex}, }"},{"path":"https://github.com/paulnorthrop/exdex/index.html","id":"exdex-","dir":"","previous_headings":"","what":"Estimation of the Extremal Index","title":"Estimation of the Extremal Index","text":"See also translations main estimation functions exdex Python: Py-exdex Matlab/Octave: M-exdex, courtesy Luke Jenkins.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/index.html","id":"what-does-exdex-do","dir":"","previous_headings":"Estimation of the Extremal Index","what":"What does exdex do?","title":"Estimation of the Extremal Index","text":"extremal index \\(\\theta\\) measure degree local dependence extremes stationary process. exdex package performs frequentist inference \\(\\theta\\) using two types methodology. One type (Northrop, 2015) based model relates distribution block maxima marginal distribution data, leading semiparametric maxima estimator. Two versions type estimator provided, following Northrop, 2015 Berghaus Bücher, 2018. slightly modified version latter also provided. Estimates produced using disjoint sliding block maxima, latter providing greater precision estimation. graphical block size diagnostic provided. type methodology uses model distribution threshold inter-exceedance times (Ferro Segers, 2003). Three versions type approach provided: iterated weight least squares approach Süveges (2007), \\(K\\)-gaps model Süveges Davison (2010) similar approach Holesovsky Fusek (2020) refer D-gaps. \\(K\\)-gaps \\(D\\)-gaps models exdex package allows missing values data, can accommodate independent subsets data, monthly seasonal time series different years, can incorporate information censored inter-exceedance times. Graphical diagnostics threshold level respective tuning parameters \\(K\\) \\(D\\) provided.","code":""},{"path":"https://github.com/paulnorthrop/exdex/index.html","id":"a-simple-example","dir":"","previous_headings":"Estimation of the Extremal Index","what":"A simple example","title":"Estimation of the Extremal Index","text":"following code estimates extremal index using semiparametric maxima estimators, example dataset containing time series sea surges measured Newlyn, Cornwall, UK period 1971-1976. block size 20 chosen using graphical diagnostic provided choose_b(). Now estimate \\(\\theta\\) using \\(K\\)-gaps model. threshold \\(u\\) runs parameter \\(K\\) chosen using graphical diagnostic provided choose_uk().","code":"library(exdex) theta <- spm(newlyn, 20) theta #>  #> Call: #> spm(data = newlyn, b = 20) #>  #> Estimates of the extremal index theta: #>           N2015   BB2018  BB2018b #> sliding   0.2392  0.3078  0.2578  #> disjoint  0.2350  0.3042  0.2542 summary(theta) #>  #> Call: #> spm(data = newlyn, b = 20) #>  #>                   Estimate Std. Error Bias adj. #> N2015, sliding      0.2392    0.01990  0.003317 #> BB2018, sliding     0.3078    0.01642  0.003026 #> BB2018b, sliding    0.2578    0.01642  0.053030 #> N2015, disjoint     0.2350    0.02222  0.003726 #> BB2018, disjoint    0.3042    0.02101  0.003571 #> BB2018b, disjoint   0.2542    0.02101  0.053570 u <- quantile(newlyn, probs = 0.60) theta <- kgaps(newlyn, u, k = 2) theta #>  #> Call: #> kgaps(data = newlyn, u = u, k = 2) #>  #> Estimate of the extremal index theta: #>  theta   #> 0.1758 summary(theta) #>  #> Call: #> kgaps(data = newlyn, u = u, k = 2) #>  #>       Estimate Std. Error #> theta   0.1758   0.009211"},{"path":"https://github.com/paulnorthrop/exdex/index.html","id":"installation","dir":"","previous_headings":"Estimation of the Extremal Index","what":"Installation","title":"Estimation of the Extremal Index","text":"get current released version CRAN:","code":"install.packages(\"exdex\")"},{"path":"https://github.com/paulnorthrop/exdex/index.html","id":"vignette","dir":"","previous_headings":"Estimation of the Extremal Index","what":"Vignette","title":"Estimation of the Extremal Index","text":"See vignette(\"exdex-vignette\", package = \"exdex\") overview package.","code":""},{"path":"https://github.com/paulnorthrop/exdex/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"GNU General Public License","title":"GNU General Public License","text":"Version 3, 29 June 2007Copyright © 2007 Free Software Foundation, Inc. <http://fsf.org/> Everyone permitted copy distribute verbatim copies license document, changing allowed.","code":""},{"path":"https://github.com/paulnorthrop/exdex/LICENSE.html","id":"preamble","dir":"","previous_headings":"","what":"Preamble","title":"GNU General Public License","text":"GNU General Public License free, copyleft license software kinds works. licenses software practical works designed take away freedom share change works. contrast, GNU General Public License intended guarantee freedom share change versions program–make sure remains free software users. , Free Software Foundation, use GNU General Public License software; applies also work released way authors. can apply programs, . speak free software, referring freedom, price. General Public Licenses designed make sure freedom distribute copies free software (charge wish), receive source code can get want , can change software use pieces new free programs, know can things. protect rights, need prevent others denying rights asking surrender rights. Therefore, certain responsibilities distribute copies software, modify : responsibilities respect freedom others. example, distribute copies program, whether gratis fee, must pass recipients freedoms received. must make sure , , receive can get source code. must show terms know rights. Developers use GNU GPL protect rights two steps: (1) assert copyright software, (2) offer License giving legal permission copy, distribute /modify . developers’ authors’ protection, GPL clearly explains warranty free software. users’ authors’ sake, GPL requires modified versions marked changed, problems attributed erroneously authors previous versions. devices designed deny users access install run modified versions software inside , although manufacturer can . fundamentally incompatible aim protecting users’ freedom change software. systematic pattern abuse occurs area products individuals use, precisely unacceptable. Therefore, designed version GPL prohibit practice products. problems arise substantially domains, stand ready extend provision domains future versions GPL, needed protect freedom users. Finally, every program threatened constantly software patents. States allow patents restrict development use software general-purpose computers, , wish avoid special danger patents applied free program make effectively proprietary. prevent , GPL assures patents used render program non-free. precise terms conditions copying, distribution modification follow.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/LICENSE.html","id":"id_0-definitions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"0. Definitions","title":"GNU General Public License","text":"“License” refers version 3 GNU General Public License. “Copyright” also means copyright-like laws apply kinds works, semiconductor masks. “Program” refers copyrightable work licensed License. licensee addressed “”. “Licensees” “recipients” may individuals organizations. “modify” work means copy adapt part work fashion requiring copyright permission, making exact copy. resulting work called “modified version” earlier work work “based ” earlier work. “covered work” means either unmodified Program work based Program. “propagate” work means anything , without permission, make directly secondarily liable infringement applicable copyright law, except executing computer modifying private copy. Propagation includes copying, distribution (without modification), making available public, countries activities well. “convey” work means kind propagation enables parties make receive copies. Mere interaction user computer network, transfer copy, conveying. interactive user interface displays “Appropriate Legal Notices” extent includes convenient prominently visible feature (1) displays appropriate copyright notice, (2) tells user warranty work (except extent warranties provided), licensees may convey work License, view copy License. interface presents list user commands options, menu, prominent item list meets criterion.","code":""},{"path":"https://github.com/paulnorthrop/exdex/LICENSE.html","id":"id_1-source-code","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"1. Source Code","title":"GNU General Public License","text":"“source code” work means preferred form work making modifications . “Object code” means non-source form work. “Standard Interface” means interface either official standard defined recognized standards body, , case interfaces specified particular programming language, one widely used among developers working language. “System Libraries” executable work include anything, work whole, () included normal form packaging Major Component, part Major Component, (b) serves enable use work Major Component, implement Standard Interface implementation available public source code form. “Major Component”, context, means major essential component (kernel, window system, ) specific operating system () executable work runs, compiler used produce work, object code interpreter used run . “Corresponding Source” work object code form means source code needed generate, install, (executable work) run object code modify work, including scripts control activities. However, include work’s System Libraries, general-purpose tools generally available free programs used unmodified performing activities part work. example, Corresponding Source includes interface definition files associated source files work, source code shared libraries dynamically linked subprograms work specifically designed require, intimate data communication control flow subprograms parts work. Corresponding Source need include anything users can regenerate automatically parts Corresponding Source. Corresponding Source work source code form work.","code":""},{"path":"https://github.com/paulnorthrop/exdex/LICENSE.html","id":"id_2-basic-permissions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"2. Basic Permissions","title":"GNU General Public License","text":"rights granted License granted term copyright Program, irrevocable provided stated conditions met. License explicitly affirms unlimited permission run unmodified Program. output running covered work covered License output, given content, constitutes covered work. License acknowledges rights fair use equivalent, provided copyright law. may make, run propagate covered works convey, without conditions long license otherwise remains force. may convey covered works others sole purpose make modifications exclusively , provide facilities running works, provided comply terms License conveying material control copyright. thus making running covered works must exclusively behalf, direction control, terms prohibit making copies copyrighted material outside relationship . Conveying circumstances permitted solely conditions stated . Sublicensing allowed; section 10 makes unnecessary.","code":""},{"path":"https://github.com/paulnorthrop/exdex/LICENSE.html","id":"id_3-protecting-users-legal-rights-from-anti-circumvention-law","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"3. Protecting Users’ Legal Rights From Anti-Circumvention Law","title":"GNU General Public License","text":"covered work shall deemed part effective technological measure applicable law fulfilling obligations article 11 WIPO copyright treaty adopted 20 December 1996, similar laws prohibiting restricting circumvention measures. convey covered work, waive legal power forbid circumvention technological measures extent circumvention effected exercising rights License respect covered work, disclaim intention limit operation modification work means enforcing, work’s users, third parties’ legal rights forbid circumvention technological measures.","code":""},{"path":"https://github.com/paulnorthrop/exdex/LICENSE.html","id":"id_4-conveying-verbatim-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"4. Conveying Verbatim Copies","title":"GNU General Public License","text":"may convey verbatim copies Program’s source code receive , medium, provided conspicuously appropriately publish copy appropriate copyright notice; keep intact notices stating License non-permissive terms added accord section 7 apply code; keep intact notices absence warranty; give recipients copy License along Program. may charge price price copy convey, may offer support warranty protection fee.","code":""},{"path":"https://github.com/paulnorthrop/exdex/LICENSE.html","id":"id_5-conveying-modified-source-versions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"5. Conveying Modified Source Versions","title":"GNU General Public License","text":"may convey work based Program, modifications produce Program, form source code terms section 4, provided also meet conditions: ) work must carry prominent notices stating modified , giving relevant date. b) work must carry prominent notices stating released License conditions added section 7. requirement modifies requirement section 4 “keep intact notices”. c) must license entire work, whole, License anyone comes possession copy. License therefore apply, along applicable section 7 additional terms, whole work, parts, regardless packaged. License gives permission license work way, invalidate permission separately received . d) work interactive user interfaces, must display Appropriate Legal Notices; however, Program interactive interfaces display Appropriate Legal Notices, work need make . compilation covered work separate independent works, nature extensions covered work, combined form larger program, volume storage distribution medium, called “aggregate” compilation resulting copyright used limit access legal rights compilation’s users beyond individual works permit. Inclusion covered work aggregate cause License apply parts aggregate.","code":""},{"path":"https://github.com/paulnorthrop/exdex/LICENSE.html","id":"id_6-conveying-non-source-forms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"6. Conveying Non-Source Forms","title":"GNU General Public License","text":"may convey covered work object code form terms sections 4 5, provided also convey machine-readable Corresponding Source terms License, one ways: ) Convey object code , embodied , physical product (including physical distribution medium), accompanied Corresponding Source fixed durable physical medium customarily used software interchange. b) Convey object code , embodied , physical product (including physical distribution medium), accompanied written offer, valid least three years valid long offer spare parts customer support product model, give anyone possesses object code either (1) copy Corresponding Source software product covered License, durable physical medium customarily used software interchange, price reasonable cost physically performing conveying source, (2) access copy Corresponding Source network server charge. c) Convey individual copies object code copy written offer provide Corresponding Source. alternative allowed occasionally noncommercially, received object code offer, accord subsection 6b. d) Convey object code offering access designated place (gratis charge), offer equivalent access Corresponding Source way place charge. need require recipients copy Corresponding Source along object code. place copy object code network server, Corresponding Source may different server (operated third party) supports equivalent copying facilities, provided maintain clear directions next object code saying find Corresponding Source. Regardless server hosts Corresponding Source, remain obligated ensure available long needed satisfy requirements. e) Convey object code using peer--peer transmission, provided inform peers object code Corresponding Source work offered general public charge subsection 6d. separable portion object code, whose source code excluded Corresponding Source System Library, need included conveying object code work. “User Product” either (1) “consumer product”, means tangible personal property normally used personal, family, household purposes, (2) anything designed sold incorporation dwelling. determining whether product consumer product, doubtful cases shall resolved favor coverage. particular product received particular user, “normally used” refers typical common use class product, regardless status particular user way particular user actually uses, expects expected use, product. product consumer product regardless whether product substantial commercial, industrial non-consumer uses, unless uses represent significant mode use product. “Installation Information” User Product means methods, procedures, authorization keys, information required install execute modified versions covered work User Product modified version Corresponding Source. information must suffice ensure continued functioning modified object code case prevented interfered solely modification made. convey object code work section , , specifically use , User Product, conveying occurs part transaction right possession use User Product transferred recipient perpetuity fixed term (regardless transaction characterized), Corresponding Source conveyed section must accompanied Installation Information. requirement apply neither third party retains ability install modified object code User Product (example, work installed ROM). requirement provide Installation Information include requirement continue provide support service, warranty, updates work modified installed recipient, User Product modified installed. Access network may denied modification materially adversely affects operation network violates rules protocols communication across network. Corresponding Source conveyed, Installation Information provided, accord section must format publicly documented (implementation available public source code form), must require special password key unpacking, reading copying.","code":""},{"path":"https://github.com/paulnorthrop/exdex/LICENSE.html","id":"id_7-additional-terms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"7. Additional Terms","title":"GNU General Public License","text":"“Additional permissions” terms supplement terms License making exceptions one conditions. Additional permissions applicable entire Program shall treated though included License, extent valid applicable law. additional permissions apply part Program, part may used separately permissions, entire Program remains governed License without regard additional permissions. convey copy covered work, may option remove additional permissions copy, part . (Additional permissions may written require removal certain cases modify work.) may place additional permissions material, added covered work, can give appropriate copyright permission. Notwithstanding provision License, material add covered work, may (authorized copyright holders material) supplement terms License terms: ) Disclaiming warranty limiting liability differently terms sections 15 16 License; b) Requiring preservation specified reasonable legal notices author attributions material Appropriate Legal Notices displayed works containing ; c) Prohibiting misrepresentation origin material, requiring modified versions material marked reasonable ways different original version; d) Limiting use publicity purposes names licensors authors material; e) Declining grant rights trademark law use trade names, trademarks, service marks; f) Requiring indemnification licensors authors material anyone conveys material (modified versions ) contractual assumptions liability recipient, liability contractual assumptions directly impose licensors authors. non-permissive additional terms considered “restrictions” within meaning section 10. Program received , part , contains notice stating governed License along term restriction, may remove term. license document contains restriction permits relicensing conveying License, may add covered work material governed terms license document, provided restriction survive relicensing conveying. add terms covered work accord section, must place, relevant source files, statement additional terms apply files, notice indicating find applicable terms. Additional terms, permissive non-permissive, may stated form separately written license, stated exceptions; requirements apply either way.","code":""},{"path":"https://github.com/paulnorthrop/exdex/LICENSE.html","id":"id_8-termination","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"8. Termination","title":"GNU General Public License","text":"may propagate modify covered work except expressly provided License. attempt otherwise propagate modify void, automatically terminate rights License (including patent licenses granted third paragraph section 11). However, cease violation License, license particular copyright holder reinstated () provisionally, unless copyright holder explicitly finally terminates license, (b) permanently, copyright holder fails notify violation reasonable means prior 60 days cessation. Moreover, license particular copyright holder reinstated permanently copyright holder notifies violation reasonable means, first time received notice violation License (work) copyright holder, cure violation prior 30 days receipt notice. Termination rights section terminate licenses parties received copies rights License. rights terminated permanently reinstated, qualify receive new licenses material section 10.","code":""},{"path":"https://github.com/paulnorthrop/exdex/LICENSE.html","id":"id_9-acceptance-not-required-for-having-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"9. Acceptance Not Required for Having Copies","title":"GNU General Public License","text":"required accept License order receive run copy Program. Ancillary propagation covered work occurring solely consequence using peer--peer transmission receive copy likewise require acceptance. However, nothing License grants permission propagate modify covered work. actions infringe copyright accept License. Therefore, modifying propagating covered work, indicate acceptance License .","code":""},{"path":"https://github.com/paulnorthrop/exdex/LICENSE.html","id":"id_10-automatic-licensing-of-downstream-recipients","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"10. Automatic Licensing of Downstream Recipients","title":"GNU General Public License","text":"time convey covered work, recipient automatically receives license original licensors, run, modify propagate work, subject License. responsible enforcing compliance third parties License. “entity transaction” transaction transferring control organization, substantially assets one, subdividing organization, merging organizations. propagation covered work results entity transaction, party transaction receives copy work also receives whatever licenses work party’s predecessor interest give previous paragraph, plus right possession Corresponding Source work predecessor interest, predecessor can get reasonable efforts. may impose restrictions exercise rights granted affirmed License. example, may impose license fee, royalty, charge exercise rights granted License, may initiate litigation (including cross-claim counterclaim lawsuit) alleging patent claim infringed making, using, selling, offering sale, importing Program portion .","code":""},{"path":"https://github.com/paulnorthrop/exdex/LICENSE.html","id":"id_11-patents","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"11. Patents","title":"GNU General Public License","text":"“contributor” copyright holder authorizes use License Program work Program based. work thus licensed called contributor’s “contributor version”. contributor’s “essential patent claims” patent claims owned controlled contributor, whether already acquired hereafter acquired, infringed manner, permitted License, making, using, selling contributor version, include claims infringed consequence modification contributor version. purposes definition, “control” includes right grant patent sublicenses manner consistent requirements License. contributor grants non-exclusive, worldwide, royalty-free patent license contributor’s essential patent claims, make, use, sell, offer sale, import otherwise run, modify propagate contents contributor version. following three paragraphs, “patent license” express agreement commitment, however denominated, enforce patent (express permission practice patent covenant sue patent infringement). “grant” patent license party means make agreement commitment enforce patent party. convey covered work, knowingly relying patent license, Corresponding Source work available anyone copy, free charge terms License, publicly available network server readily accessible means, must either (1) cause Corresponding Source available, (2) arrange deprive benefit patent license particular work, (3) arrange, manner consistent requirements License, extend patent license downstream recipients. “Knowingly relying” means actual knowledge , patent license, conveying covered work country, recipient’s use covered work country, infringe one identifiable patents country reason believe valid. , pursuant connection single transaction arrangement, convey, propagate procuring conveyance , covered work, grant patent license parties receiving covered work authorizing use, propagate, modify convey specific copy covered work, patent license grant automatically extended recipients covered work works based . patent license “discriminatory” include within scope coverage, prohibits exercise , conditioned non-exercise one rights specifically granted License. may convey covered work party arrangement third party business distributing software, make payment third party based extent activity conveying work, third party grants, parties receive covered work , discriminatory patent license () connection copies covered work conveyed (copies made copies), (b) primarily connection specific products compilations contain covered work, unless entered arrangement, patent license granted, prior 28 March 2007. Nothing License shall construed excluding limiting implied license defenses infringement may otherwise available applicable patent law.","code":""},{"path":"https://github.com/paulnorthrop/exdex/LICENSE.html","id":"id_12-no-surrender-of-others-freedom","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"12. No Surrender of Others’ Freedom","title":"GNU General Public License","text":"conditions imposed (whether court order, agreement otherwise) contradict conditions License, excuse conditions License. convey covered work satisfy simultaneously obligations License pertinent obligations, consequence may convey . example, agree terms obligate collect royalty conveying convey Program, way satisfy terms License refrain entirely conveying Program.","code":""},{"path":"https://github.com/paulnorthrop/exdex/LICENSE.html","id":"id_13-use-with-the-gnu-affero-general-public-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"13. Use with the GNU Affero General Public License","title":"GNU General Public License","text":"Notwithstanding provision License, permission link combine covered work work licensed version 3 GNU Affero General Public License single combined work, convey resulting work. terms License continue apply part covered work, special requirements GNU Affero General Public License, section 13, concerning interaction network apply combination .","code":""},{"path":"https://github.com/paulnorthrop/exdex/LICENSE.html","id":"id_14-revised-versions-of-this-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"14. Revised Versions of this License","title":"GNU General Public License","text":"Free Software Foundation may publish revised /new versions GNU General Public License time time. new versions similar spirit present version, may differ detail address new problems concerns. version given distinguishing version number. Program specifies certain numbered version GNU General Public License “later version” applies , option following terms conditions either numbered version later version published Free Software Foundation. Program specify version number GNU General Public License, may choose version ever published Free Software Foundation. Program specifies proxy can decide future versions GNU General Public License can used, proxy’s public statement acceptance version permanently authorizes choose version Program. Later license versions may give additional different permissions. However, additional obligations imposed author copyright holder result choosing follow later version.","code":""},{"path":"https://github.com/paulnorthrop/exdex/LICENSE.html","id":"id_15-disclaimer-of-warranty","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"15. Disclaimer of Warranty","title":"GNU General Public License","text":"WARRANTY PROGRAM, EXTENT PERMITTED APPLICABLE LAW. EXCEPT OTHERWISE STATED WRITING COPYRIGHT HOLDERS /PARTIES PROVIDE PROGRAM “” WITHOUT WARRANTY KIND, EITHER EXPRESSED IMPLIED, INCLUDING, LIMITED , IMPLIED WARRANTIES MERCHANTABILITY FITNESS PARTICULAR PURPOSE. ENTIRE RISK QUALITY PERFORMANCE PROGRAM . PROGRAM PROVE DEFECTIVE, ASSUME COST NECESSARY SERVICING, REPAIR CORRECTION.","code":""},{"path":"https://github.com/paulnorthrop/exdex/LICENSE.html","id":"id_16-limitation-of-liability","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"16. Limitation of Liability","title":"GNU General Public License","text":"EVENT UNLESS REQUIRED APPLICABLE LAW AGREED WRITING COPYRIGHT HOLDER, PARTY MODIFIES /CONVEYS PROGRAM PERMITTED , LIABLE DAMAGES, INCLUDING GENERAL, SPECIAL, INCIDENTAL CONSEQUENTIAL DAMAGES ARISING USE INABILITY USE PROGRAM (INCLUDING LIMITED LOSS DATA DATA RENDERED INACCURATE LOSSES SUSTAINED THIRD PARTIES FAILURE PROGRAM OPERATE PROGRAMS), EVEN HOLDER PARTY ADVISED POSSIBILITY DAMAGES.","code":""},{"path":"https://github.com/paulnorthrop/exdex/LICENSE.html","id":"id_17-interpretation-of-sections-15-and-16","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"17. Interpretation of Sections 15 and 16","title":"GNU General Public License","text":"disclaimer warranty limitation liability provided given local legal effect according terms, reviewing courts shall apply local law closely approximates absolute waiver civil liability connection Program, unless warranty assumption liability accompanies copy Program return fee. END TERMS CONDITIONS","code":""},{"path":"https://github.com/paulnorthrop/exdex/LICENSE.html","id":"how-to-apply-these-terms-to-your-new-programs","dir":"","previous_headings":"","what":"How to Apply These Terms to Your New Programs","title":"GNU General Public License","text":"develop new program, want greatest possible use public, best way achieve make free software everyone can redistribute change terms. , attach following notices program. safest attach start source file effectively state exclusion warranty; file least “copyright” line pointer full notice found. Also add information contact electronic paper mail. program terminal interaction, make output short notice like starts interactive mode: hypothetical commands show w show c show appropriate parts General Public License. course, program’s commands might different; GUI interface, use “box”. also get employer (work programmer) school, , sign “copyright disclaimer” program, necessary. information , apply follow GNU GPL, see <http://www.gnu.org/licenses/>. GNU General Public License permit incorporating program proprietary programs. program subroutine library, may consider useful permit linking proprietary applications library. want , use GNU Lesser General Public License instead License. first, please read <http://www.gnu.org/philosophy/--lgpl.html>.","code":"<one line to give the program's name and a brief idea of what it does.> Copyright (C) <year>  <name of author>  This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>. <program>  Copyright (C) <year>  <name of author> This program comes with ABSOLUTELY NO WARRANTY; for details type 'show w'. This is free software, and you are welcome to redistribute it under certain conditions; type 'show c' for details."},{"path":"https://github.com/paulnorthrop/exdex/reference/all_max_rcpp.html","id":null,"dir":"Reference","previous_headings":"","what":"Sliding and disjoint block maxima — all_max_rcpp","title":"Sliding and disjoint block maxima — all_max_rcpp","text":"Calculates (sliding) maxima blocks b contiguous values sets maxima disjoint blocks b contiguous values vector x.  provides first step computations spm.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/all_max_rcpp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sliding and disjoint block maxima — all_max_rcpp","text":"","code":"all_max_rcpp(x, b = 1, which_dj = c(\"all\", \"first\", \"last\"), ...)"},{"path":"https://github.com/paulnorthrop/exdex/reference/all_max_rcpp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sliding and disjoint block maxima — all_max_rcpp","text":"x numeric vector raw observations. b numeric scalar.  block size. which_dj character scalar.  Determines sets disjoint maxima calculated: \"\", sets; \"first\", set whose first block starts first observation x; \"last\", set whose last block end last observation x. ... arguments passed roll_max.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/all_max_rcpp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sliding and disjoint block maxima — all_max_rcpp","text":"list containing ys numeric vector containing one set sliding       block maxima. xs numeric vector containing values       contribute ys, , whole input vector x. yd which_dj = \"\" floor(n / b)       n - floor(n / b) * b + 1 numeric matrix.  column       contains set disjoint maxima.  Otherwise, floor(n / b)       1 numeric matrix containing one set block maxima. xd which_dj = \"\"       floor(n / b) * b n - floor(n / b) * b + 1 numeric       matrix.  column contains values x contribute       corresponding column yd.  Otherwise,       floor(n / b) 1 numeric matrix containing one one set       values x contribute yd.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/all_max_rcpp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sliding and disjoint block maxima — all_max_rcpp","text":"Sliding maxima. function   roll_max RcppRoll   package used. Disjoint maxima.  n = length(x) integer   multiple b, which_dj = \"first\"   which_dj = \"last\" one set n / b disjoint   block maxima returned.   Otherwise, n - floor(n / b) * b + 1 sets floor(n / b)   disjoint block maxima returned.  Set disjoint maxima   x[:(+ floor(n / b) * b - 1)].  , possible sets   contiguous disjoint maxima achieving maxima length   floor(n / b) calculated. instances na.rm = TRUE passed max   blocks containing missing values produce non-missing result. Also returned values x contribute set   block maxima.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/all_max_rcpp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sliding and disjoint block maxima — all_max_rcpp","text":"","code":"x <- 1:11 all_max_rcpp(x, 3) #> $ys #> [1]  3  4  5  6  7  8  9 10 11 #>  #> $xs #>  [1]  1  2  3  4  5  6  7  8  9 10 11 #>  #> $yd #>      [,1] [,2] [,3] #> [1,]    3    4    5 #> [2,]    6    7    8 #> [3,]    9   10   11 #>  #> $xd #>       [,1] [,2] [,3] #>  [1,]    1    2    3 #>  [2,]    2    3    4 #>  [3,]    3    4    5 #>  [4,]    4    5    6 #>  [5,]    5    6    7 #>  [6,]    6    7    8 #>  [7,]    7    8    9 #>  [8,]    8    9   10 #>  [9,]    9   10   11 #>  all_max_rcpp(x, 3, which_dj = \"first\") #> $ys #> [1]  3  4  5  6  7  8  9 10 11 #>  #> $xs #>  [1]  1  2  3  4  5  6  7  8  9 10 11 #>  #> $yd #>      [,1] #> [1,]    3 #> [2,]    6 #> [3,]    9 #>  #> $xd #>       [,1] #>  [1,]    1 #>  [2,]    2 #>  [3,]    3 #>  [4,]    4 #>  [5,]    5 #>  [6,]    6 #>  [7,]    7 #>  [8,]    8 #>  [9,]    9 #>  all_max_rcpp(x, 3, which_dj = \"last\") #> $ys #> [1]  3  4  5  6  7  8  9 10 11 #>  #> $xs #>  [1]  1  2  3  4  5  6  7  8  9 10 11 #>  #> $yd #>      [,1] #> [1,]    5 #> [2,]    8 #> [3,]   11 #>  #> $xd #>       [,1] #>  [1,]    3 #>  [2,]    4 #>  [3,]    5 #>  [4,]    6 #>  [5,]    7 #>  [6,]    8 #>  [7,]    9 #>  [8,]   10 #>  [9,]   11 #>"},{"path":"https://github.com/paulnorthrop/exdex/reference/cheeseboro.html","id":null,"dir":"Reference","previous_headings":"","what":"Cheeseboro hourly maximum wind gusts — cheeseboro","title":"Cheeseboro hourly maximum wind gusts — cheeseboro","text":"matrix cheeseboro contains hourly maximum wind gusts (miles per hour) recorded Cheeseboro weather station near Thousand Oaks, Southern California, USA month January period 2000-2009. data analysed Reich Shaby (2016).","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/cheeseboro.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cheeseboro hourly maximum wind gusts — cheeseboro","text":"","code":"cheeseboro"},{"path":"https://github.com/paulnorthrop/exdex/reference/cheeseboro.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Cheeseboro hourly maximum wind gusts — cheeseboro","text":"744 10 numeric matrix.  Column contains hourly   maximum wind gusts (miles per hour) Cheeseboro year   2000 + - 1. columns named 2000, 2001, ..., 2009   rows named dayjhourk, j day   month k hour day.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/cheeseboro.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Cheeseboro hourly maximum wind gusts — cheeseboro","text":"Remote Automated Weather Stations USA Climate Archive   https://raws.dri.edu/, specifically Daily Summaries   Cheeseboro page.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/cheeseboro.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Cheeseboro hourly maximum wind gusts — cheeseboro","text":"42 missing values, located 6 10 years, namely   2000-2003 2005-2006.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/cheeseboro.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Cheeseboro hourly maximum wind gusts — cheeseboro","text":"Reich, B. J. Shaby, B. . (2016). 'Time series Extremes', Dey, D. K. Yan, J. (eds.) Extreme Value Modeling Risk Analysis. New York: Chapman Hall/CRC, pp. 131-151.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/choose_b.html","id":null,"dir":"Reference","previous_headings":"","what":"Block length diagnostic for the semiparametric maxima estimator — choose_b","title":"Block length diagnostic for the semiparametric maxima estimator — choose_b","text":"Creates data plot aid choice block length b supply spm.  general idea select smallest value b estimates extremal index \\(\\theta\\) appear constant respect b, taking account sampling variability.  plot.choose_b creates plot.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/choose_b.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Block length diagnostic for the semiparametric maxima estimator — choose_b","text":"","code":"choose_b(   data,   b,   bias_adjust = c(\"BB3\", \"BB1\", \"N\", \"none\"),   constrain = TRUE,   varN = TRUE,   level = 0.95,   interval_type = c(\"norm\", \"lik\"),   conf_scale = c(\"theta\", \"log\"),   type = c(\"vertical\", \"cholesky\", \"spectral\", \"none\") )"},{"path":"https://github.com/paulnorthrop/exdex/reference/choose_b.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Block length diagnostic for the semiparametric maxima estimator — choose_b","text":"data numeric vector raw data.  missing values allowed. b numeric scalar.  block size. bias_adjust character scalar.  bias-adjustment raw estimate \\(\\theta\\) performed using bias-reduced estimator (bias_adjust = \"BB3\"), derived Section 5 Berghaus Bucher (2018); simpler version (bias_adjust = \"BB1\"), raw estimate multiplied \\((k-1) / k\\), \\(k\\) number blocks; bias-adjustment empirical distribution function used calculate estimate, detailed Section 2 Northrop (2015).  disjoint maxima used bias_adjust = \"BB1\" bias_adjust = \"N\" give identical estimates Berghaus Bucher (2018) variant, explained end Section 5 Berghaus Bucher (2018). bias_adjust = \"none\" bias-adjustment performed. constrain logical scalar.  constrain = TRUE estimates greater 1 set 1, , constrained lie (0, 1].  carried bias-adjustment.  Otherwise, estimates greater 1 may obtained. varN logical scalar.  varN = TRUE estimation sampling variance Northrop (2015) estimator tailored estimator.  Otherwise, sampling variance derived Berghaus Bucher (2018) used. See Details information. level numeric scalar (0, 1). confidence level required. interval_type character scalar: \"norm\" intervals type (), \"lik\" intervals type (b). conf_scale character scalar.  interval_type = \"norm\"   conf_scale determines scale use approximate   large-sample normality estimators estimate confidence intervals   type (). conf_scale = \"theta\"   confidence intervals estimated \\(\\theta\\) directly.   conf_scale = \"log\" confidence intervals first   estimated \\(\\log\\theta\\) transformed back   \\(\\theta\\)-scale. bias-adjustment requested original call spm,   using bias_adjust argument, automatically applied . type character scalar.  argument type passed conf_intervals chandwich package order estimate likelihood-based intervals. Using type = \"none\" advised intervals based naive estimated standard errors.  particular, (default) sliding = TRUE used call spm unadjusted likelihood-based confidence intervals provide vast underestimates uncertainty.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/choose_b.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Block length diagnostic for the semiparametric maxima estimator — choose_b","text":"object class c(\"choose_b\", \"exdex\") containing theta_sl,theta_dj numeric b 3 matrices estimates   \\(\\theta\\) using sliding disjoint blocks.  Columns 1-3 relate    estimators N2015, BB2018 BB2018b. lower_sl,lower_dj Similarly lower limits confidence     intervals. upper_sl,upper_dj Similarly upper limits confidence     intervals. b input b call call choose_b.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/choose_b.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Block length diagnostic for the semiparametric maxima estimator — choose_b","text":"block size b extremal index \\(\\theta\\)   estimated using spm.  estimates \\(\\theta\\)   approximate conf% confidence intervals \\(\\theta\\)   stored plotting (plot.choose_b)   produce simple graphical diagnostic inform choice   block size.  plot used choose block size   underlying value \\(\\theta\\) may approximately constant.   akin threshold stability plot: see Chapter 4 Coles (2001),   example. nature calculation sampling variances estimates   \\(\\theta\\) (see spm details) means   choose_b may little slow run b contains many   values, particularly small. small block sizes may possible estimate   confidence intervals.  See Details spm.   block sizes intervals missing plot.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/choose_b.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Block length diagnostic for the semiparametric maxima estimator — choose_b","text":"Coles, S. G. (2001) Introduction Statistical   Modeling Extreme Values, Springer-Verlag, London.   doi:10.1007/978-1-4471-3675-0_3 Northrop, P. J. (2015) efficient semiparametric maxima   estimator extremal index. Extremes 18(4), 585-603.   doi:10.1007/s10687-015-0221-5 Berghaus, B., Bucher, . (2018) Weak convergence pseudo   maximum likelihood estimator extremal index. Ann. Statist.   46(5), 2307-2335. doi:10.1214/17-AOS1621","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/choose_b.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Block length diagnostic for the semiparametric maxima estimator — choose_b","text":"","code":"# \\donttest{ # Newlyn seas surges # Plot like the top left of Northrop (2015) # Remove the last 14 values because 2880 has lots of factors b_vals <- c(2,3,4,5,6,8,9,10,12,15,16,18,20,24,30,32,36,40,45,48,54,60) res <- choose_b(newlyn[1:2880], b_vals) # Some b are too small for the sampling variance of the sliding blocks # estimator to be estimated plot(res)  plot(res, estimator = \"BB2018\")  plot(res, maxima = \"disjoint\")   # S&P 500 index: similar to Berghaus and Bucher (2018), Fig 4 top left b_vals <- c(10, seq(from = 25, to = 350, by = 25), 357) res500 <- choose_b(sp500, b_vals) plot(res500, ylim = c(0, 1))  plot(res500, estimator = \"BB2018\", ylim = c(0, 1))  # }"},{"path":"https://github.com/paulnorthrop/exdex/reference/choose_ud.html","id":null,"dir":"Reference","previous_headings":"","what":"Threshold \\(u\\) and runs parameter \\(D\\) diagnostic for the \\(D\\)-gaps estimator — choose_ud","title":"Threshold \\(u\\) and runs parameter \\(D\\) diagnostic for the \\(D\\)-gaps estimator — choose_ud","text":"Creates data plot aid choice threshold run parameter \\(D\\) \\(D\\)-gaps estimator (see dgaps).  plot.choose_ud creates plot.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/choose_ud.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Threshold \\(u\\) and runs parameter \\(D\\) diagnostic for the \\(D\\)-gaps estimator — choose_ud","text":"","code":"choose_ud(data, u, D = 1, inc_cens = TRUE)"},{"path":"https://github.com/paulnorthrop/exdex/reference/choose_ud.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Threshold \\(u\\) and runs parameter \\(D\\) diagnostic for the \\(D\\)-gaps estimator — choose_ud","text":"data numeric vector numeric matrix raw data.  data   matrix log-likelihood constructed sum   (independent) contributions different columns. common situation   column relates different year. data contains missing values split_by_NAs   used divide data sequences non-missing values. u, D Numeric vectors.  u vector   extreme value thresholds applied data.  D vector values   run parameter \\(D\\), defined Holesovsky Fusek (2020).   See dgaps details. values u greater observations   data removed without warning given. inc_cens logical scalar indicating whether include contributions right-censored inter-exceedance times, relating first last observations. known times greater equal time observed. data multiple columns right-censored first last inter-exceedance times column.  See Details dgaps.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/choose_ud.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Threshold \\(u\\) and runs parameter \\(D\\) diagnostic for the \\(D\\)-gaps estimator — choose_ud","text":"object (list) class c(\"choose_ud\", \"exdex\")   containing imt object class c(\"dgaps_imt\", \"exdex\") returned     dgaps_imt. theta length(u) length(D) matrix.     Element (,j) theta contains object (list) class     c(\"dgaps\", \"exdex\"), result call     dgaps(data, u[j], D[]) dgaps.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/choose_ud.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Threshold \\(u\\) and runs parameter \\(D\\) diagnostic for the \\(D\\)-gaps estimator — choose_ud","text":"combination threshold u \\(D\\)   D functions dgaps dgaps_imt   called order estimate \\(\\theta\\) perform   information matrix test Holesovsky Fusek (2020).","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/choose_ud.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Threshold \\(u\\) and runs parameter \\(D\\) diagnostic for the \\(D\\)-gaps estimator — choose_ud","text":"Holesovsky, J. Fusek, M. Estimation extremal index   using censored distributions. Extremes 23, 197-213 (2020).   doi:10.1007/s10687-020-00374-3","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/choose_ud.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Threshold \\(u\\) and runs parameter \\(D\\) diagnostic for the \\(D\\)-gaps estimator — choose_ud","text":"","code":"### S&P 500 index  # Multiple thresholds and left-censoring parameters u <- quantile(sp500, probs = seq(0.2, 0.9, by = 0.1)) imt_theta <- choose_ud(sp500, u = u, D = 1:5) plot(imt_theta)  plot(imt_theta, uprob = TRUE)  plot(imt_theta, y = \"theta\")   # One left-censoring parameter D, many thresholds u u <- quantile(sp500, probs = seq(0.2, 0.9, by = 0.1)) imt_theta <- choose_ud(sp500, u = u, D = 1) plot(imt_theta)  plot(imt_theta, y = \"theta\")   # One threshold u, many left-censoring parameters D u <- quantile(sp500, probs = 0.9) imt_theta <- choose_ud(sp500, u = u, D = 1:5) plot(imt_theta)  plot(imt_theta, y = \"theta\")   ### Newlyn sea surges  u <- quantile(newlyn, probs = seq(0.1, 0.9, by = 0.1)) imt_theta <- choose_ud(newlyn, u = u, D = 1:5) plot(imt_theta, uprob = TRUE)   ### Cheeseboro wind gusts (a matrix containing some NAs)  probs <- c(seq(0.5, 0.95, by = 0.05), 0.99) u <- quantile(cheeseboro, probs = probs, na.rm = TRUE) imt_theta <- choose_ud(cheeseboro, u, D = 1:6) plot(imt_theta, uprob = FALSE, lwd = 2)   ### Uccle July temperatures  probs <- c(seq(0.7, 0.95, by = 0.05), 0.99) u <- quantile(uccle720m, probs = probs, na.rm = TRUE) imt_theta <- choose_ud(uccle720m, u, D = 1:5) plot(imt_theta, uprob = TRUE, lwd = 2)"},{"path":"https://github.com/paulnorthrop/exdex/reference/choose_uk.html","id":null,"dir":"Reference","previous_headings":"","what":"Threshold \\(u\\) and runs parameter \\(K\\) diagnostic for the \\(K\\)-gaps estimator — choose_uk","title":"Threshold \\(u\\) and runs parameter \\(K\\) diagnostic for the \\(K\\)-gaps estimator — choose_uk","text":"Creates data plot aid choice threshold run parameter \\(K\\) \\(K\\)-gaps estimator (see kgaps).  plot.choose_uk creates plot.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/choose_uk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Threshold \\(u\\) and runs parameter \\(K\\) diagnostic for the \\(K\\)-gaps estimator — choose_uk","text":"","code":"choose_uk(data, u, k = 1, inc_cens = TRUE)"},{"path":"https://github.com/paulnorthrop/exdex/reference/choose_uk.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Threshold \\(u\\) and runs parameter \\(K\\) diagnostic for the \\(K\\)-gaps estimator — choose_uk","text":"data numeric vector numeric matrix raw data.  data   matrix log-likelihood constructed sum   (independent) contributions different columns. common situation   column relates different year. data contains missing values split_by_NAs   used divide data sequences non-missing values. u, k Numeric vectors.  u vector   extreme value thresholds applied data.  k vector values   run parameter \\(K\\), defined Suveges Davison (2010).   See kgaps details. values u greater observations   data removed without warning given. inc_cens logical scalar indicating whether include contributions censored inter-exceedance times, relating first last observations.  See Attalides (2015) details.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/choose_uk.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Threshold \\(u\\) and runs parameter \\(K\\) diagnostic for the \\(K\\)-gaps estimator — choose_uk","text":"object (list) class c(\"choose_uk\", \"exdex\")   containing imt object class c(\"kgaps_imt\", \"exdex\") returned     kgaps_imt. theta length(u) length(k) matrix.     Element (,j) theta contains object (list) class     c(\"kgaps\", \"exdex\"), result call     kgaps(data, u[j], k[]) kgaps.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/choose_uk.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Threshold \\(u\\) and runs parameter \\(K\\) diagnostic for the \\(K\\)-gaps estimator — choose_uk","text":"combination threshold u \\(K\\)   k functions kgaps kgaps_imt   called order estimate \\(\\theta\\) perform   information matrix test Suveges Davison (2010).","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/choose_uk.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Threshold \\(u\\) and runs parameter \\(K\\) diagnostic for the \\(K\\)-gaps estimator — choose_uk","text":"Suveges, M. Davison, . C. (2010) Model   misspecification peaks threshold analysis, Annals   Applied Statistics, 4(1), 203-221.   doi:10.1214/09-AOAS292 Attalides, N. (2015) Threshold-based extreme value modelling,   PhD thesis, University College London.   https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/choose_uk.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Threshold \\(u\\) and runs parameter \\(K\\) diagnostic for the \\(K\\)-gaps estimator — choose_uk","text":"","code":"### S&P 500 index  # Multiple thresholds and run parameters u <- quantile(sp500, probs = seq(0.1, 0.9, by = 0.1)) imt_theta <- choose_uk(sp500, u = u, k = 1:5) plot(imt_theta)  plot(imt_theta, uprob = TRUE)  plot(imt_theta, y = \"theta\")   # One run parameter K, many thresholds u u <- quantile(sp500, probs = seq(0.1, 0.9, by = 0.1)) imt_theta <- choose_uk(sp500, u = u, k = 1) plot(imt_theta)  plot(imt_theta, y = \"theta\")   # One threshold u, many run parameters K u <- quantile(sp500, probs = 0.9) imt_theta <- choose_uk(sp500, u = u, k = 1:5) plot(imt_theta)  plot(imt_theta, y = \"theta\")   ### Newlyn sea surges  u <- quantile(newlyn, probs = seq(0.1, 0.9, by = 0.1)) imt_theta <- choose_uk(newlyn, u = u, k = 1:5) plot(imt_theta, uprob = TRUE)   ### Cheeseboro wind gusts (a matrix containing some NAs)  probs <- c(seq(0.5, 0.95, by = 0.05), 0.99) u <- quantile(cheeseboro, probs = probs, na.rm = TRUE) imt_theta <- choose_uk(cheeseboro, u, k = 1:6) plot(imt_theta, uprob = FALSE, lwd = 2)   ### Uccle July temperatures  probs <- c(seq(0.7, 0.95, by = 0.05), 0.99) u <- quantile(uccle720m, probs = probs, na.rm = TRUE) imt_theta <- choose_uk(uccle720m, u, k = 1:5) plot(imt_theta, uprob = TRUE, lwd = 2)"},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps.html","id":null,"dir":"Reference","previous_headings":"","what":"Maximum likelihood estimation using left-censored inter-exceedances times — dgaps","title":"Maximum likelihood estimation using left-censored inter-exceedances times — dgaps","text":"Calculates maximum likelihood estimates extremal index \\(\\theta\\) based model threshold inter-exceedances times Holesovsky Fusek (2020).  refer \\(D\\)-gaps model, uses tuning parameter \\(D\\), whereas related \\(K\\)-gaps model Suveges Davison (2010) tuning parameter \\(K\\).","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Maximum likelihood estimation using left-censored inter-exceedances times — dgaps","text":"","code":"dgaps(data, u, D = 1, inc_cens = TRUE)"},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Maximum likelihood estimation using left-censored inter-exceedances times — dgaps","text":"data numeric vector numeric matrix raw data.  data   matrix log-likelihood constructed sum   (independent) contributions different columns. common situation   column relates different year. data contains missing values split_by_NAs   used divide data sequences non-missing values,   stored different columns matrix.  , log-likelihood   constructed sum contributions different columns. u numeric scalar.  Extreme value threshold applied data. D numeric scalar.  censoring parameter \\(D\\). Threshold inter-exceedances times larger D units left-censored, occurring probability \\(\\log(1 - \\theta e^{-\\theta d})\\), \\(d = q D\\) \\(q\\) probability threshold \\(u\\) exceeded. inc_cens logical scalar indicating whether include contributions right-censored inter-exceedance times, relating first last observations. known times greater equal time observed. data multiple columns right-censored first last inter-exceedance times column.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Maximum likelihood estimation using left-censored inter-exceedances times — dgaps","text":"object (list) class c(\"dgaps\", \"exdex\") containing theta maximum likelihood estimate (MLE)       \\(\\theta\\). se estimated standard error MLE, calculated       using algebraic expression observed information.        estimate \\(\\theta\\) 0 se NA. se_exp estimated standard error MLE,       calculated using algebraic expression expected information.       estimate \\(\\theta\\) 0 se_exp NA.       provided cases may encountered observed       information positive. ss list summary statistics returned       dgaps_stat. D, u, inc_cens input values D,       u inc_cens. max_loglik value log-likelihood MLE. call call dgaps.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Maximum likelihood estimation using left-censored inter-exceedances times — dgaps","text":"inc_cens = FALSE maximum likelihood estimate   extremal index \\(\\theta\\) \\(D\\)-gaps model   Holesovsky Fusek (2020) calculated.  model   inter-exceedance times less equal \\(D\\)   left-censored, strategy mitigate model mis-specification resulting   fact inter-exceedance times equal 0 expected   model positive inter-exceedance times can observed   practice. inc_cens = TRUE information right-censored   first last inter-exceedance times also included likelihood   maximized.   explanation idea see Attalides (2015).  form   log-likelihood given Details section   dgaps_stat. possible estimate \\(\\theta\\) equal 1, also   possible equal 0. dgaps_stat explains   respective properties data cause events occur.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Maximum likelihood estimation using left-censored inter-exceedances times — dgaps","text":"Holesovsky, J. Fusek, M. Estimation extremal index   using censored distributions. Extremes 23, 197-213 (2020).   doi:10.1007/s10687-020-00374-3 Suveges, M. Davison, . C. (2010) Model   misspecification peaks threshold analysis, Annals   Applied Statistics, 4(1), 203-221.   doi:10.1214/09-AOAS292","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Maximum likelihood estimation using left-censored inter-exceedances times — dgaps","text":"","code":"### S&P 500 index  u <- quantile(sp500, probs = 0.60) theta <- dgaps(sp500, u = u, D = 1) theta #>  #> Call: #> dgaps(data = sp500, u = u, D = 1) #>  #> Estimate of the extremal index theta: #>  theta   #> 0.9692   summary(theta) #>  #> Call: #> dgaps(data = sp500, u = u, D = 1) #>  #>       Estimate Std. Error #> theta   0.9692    0.01561 coef(theta) #>     theta  #> 0.9691789  nobs(theta) #> [1] 2901 vcov(theta) #>              theta #> theta 0.0002438123 logLik(theta) #> 'log Lik.' -3658.418 (df=1)  ### Newlyn sea surges  u <- quantile(newlyn, probs = 0.60) theta <- dgaps(newlyn, u = u, D = 2) theta #>  #> Call: #> dgaps(data = newlyn, u = u, D = 2) #>  #> Estimate of the extremal index theta: #>  theta   #> 0.1999   summary(theta) #>  #> Call: #> dgaps(data = newlyn, u = u, D = 2) #>  #>       Estimate Std. Error #> theta   0.1999    0.01176  ### Uccle July temperatures  # Using vector input, which merges data from different years u <- quantile(uccle720$temp, probs = 0.9, na.rm = TRUE) theta <- dgaps(uccle720$temp, u = u, D = 2) theta #>  #> Call: #> dgaps(data = uccle720$temp, u = u, D = 2) #>  #> Estimate of the extremal index theta: #>  theta   #> 0.5152    # Using matrix input to separate data from different years u <- quantile(uccle720m, probs = 0.9, na.rm = TRUE) theta <- dgaps(uccle720m, u = u, D = 2) theta #>  #> Call: #> dgaps(data = uccle720m, u = u, D = 2) #>  #> Estimate of the extremal index theta: #>  theta   #> 0.5541"},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_confint.html","id":null,"dir":"Reference","previous_headings":"","what":"Confidence intervals for the extremal index \\(\\theta\\) for ","title":"Confidence intervals for the extremal index \\(\\theta\\) for ","text":"confint method objects class c(\"dgaps\", \"exdex\"). Computes confidence intervals \\(\\theta\\) based object returned dgaps.  Two types interval may returned: () intervals based approximate large-sample normality estimator \\(\\theta\\), symmetric point estimate, (b) likelihood-based intervals. plot method plots log-likelihood \\(\\theta\\), required confidence interval indicated plot.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_confint.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Confidence intervals for the extremal index \\(\\theta\\) for ","text":"","code":"# S3 method for class 'dgaps' confint(   object,   parm = \"theta\",   level = 0.95,   interval_type = c(\"both\", \"norm\", \"lik\"),   conf_scale = c(\"theta\", \"log\"),   constrain = TRUE,   se_type = c(\"observed\", \"expected\"),   ... )  # S3 method for class 'confint_dgaps' plot(x, ...)  # S3 method for class 'confint_dgaps' print(x, ...)"},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_confint.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Confidence intervals for the extremal index \\(\\theta\\) for ","text":"object object class c(\"dgaps\", \"exdex\"), returned dgaps. parm Specifies parameter given confidence interval. one option: extremal index \\(\\theta\\). level confidence level required.  numeric scalar (0, 1). interval_type character scalar: \"norm\" intervals type (), \"lik\" intervals type (b). conf_scale character scalar.  interval_type = \"norm\"   conf_scale determines scale use approximate   large-sample normality estimator estimate confidence intervals. conf_scale = \"theta\"   confidence intervals estimated \\(\\theta\\) directly.   conf_scale = \"log\" confidence intervals first   estimated \\(\\log\\theta\\) transformed back   \\(\\theta\\)-scale. constrain logical scalar.  constrain = TRUE confidence limits greater 1 set 1, , constrained lie (0, 1].  Otherwise, limits greater 1 may obtained. constrain = TRUE lower confidence limits less 0 set 0. se_type character scalar. confidence intervals interval_type  = \"norm\" use estimated standard error based observed information based expected information? ... plot.confint_dgaps: arguments passed   plot.confint. print.confint_dgaps: arguments passed   print.default. x object class c(\"confint_dgaps\", \"exdex\"), result call confint.dgaps.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_confint.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Confidence intervals for the extremal index \\(\\theta\\) for ","text":"list class c(\"confint_dgaps\", \"exdex\") containing   following components. cis matrix columns giving lower upper confidence   limits. labelled (1 - level)/2 1 - (1 - level)/2   % (default 2.5% 97.5%).   row names indicate type interval:   norm intervals based large sample normality lik   likelihood-based intervals. call call spm. object input object object. level input level. plot.confint_dgaps: nothing returned. print.confint_dgaps: argument x, invisibly.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_confint.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Confidence intervals for the extremal index \\(\\theta\\) for ","text":"Two type interval calculated: () interval based   approximate large sample normality estimator \\(\\theta\\)   (conf_scale = \"theta\") \\(\\log\\theta\\)   (conf_scale = \"log\") (b) likelihood-based interval,   based approximate large sample chi-squared, 1 degree   freedom, distribution log-likelihood ratio statistic. print.confint_dgaps prints matrix confidence   intervals \\(\\theta\\).","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_confint.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Confidence intervals for the extremal index \\(\\theta\\) for ","text":"Holesovsky, J. Fusek, M. Estimation extremal index   using censored distributions. Extremes 23, 197-213 (2020).   doi:10.1007/s10687-020-00374-3","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_confint.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Confidence intervals for the extremal index \\(\\theta\\) for ","text":"","code":"u <- quantile(newlyn, probs = 0.90) theta <- dgaps(newlyn, u) cis <- confint(theta) cis #>          2.5 %    97.5 % #> norm 0.3406122 0.4345061 #> lik  0.3420138 0.4357397 plot(cis)"},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_imt.html","id":null,"dir":"Reference","previous_headings":"","what":"Information matrix test under the \\(D\\)-gaps model — dgaps_imt","title":"Information matrix test under the \\(D\\)-gaps model — dgaps_imt","text":"Performs information matrix test (IMT) diagnose misspecification \\(D\\)-gaps model Holesovsky Fusek (2020).","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_imt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Information matrix test under the \\(D\\)-gaps model — dgaps_imt","text":"","code":"dgaps_imt(data, u, D = 1, inc_cens = TRUE)"},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_imt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Information matrix test under the \\(D\\)-gaps model — dgaps_imt","text":"data numeric vector numeric matrix raw data.  data   matrix log-likelihood constructed sum   (independent) contributions different columns. common situation   column relates different year. data contains missing values split_by_NAs   used divide data sequences non-missing values. u, D Numeric vectors.  u vector extreme value   thresholds applied data.  D vector values   left-censoring parameter \\(D\\), defined Holesovsky Fusek   (2020). See dgaps. values u greater observations   data removed without warning given. inc_cens logical scalar indicating whether include contributions right-censored inter-exceedance times, relating first last observations. See dgaps.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_imt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Information matrix test under the \\(D\\)-gaps model — dgaps_imt","text":"object (list) class c(\"dgaps_imt\", \"exdex\")   containing imt length(u) length(D) numeric matrix.     Column contains, \\(D\\) = D[], values     information matrix test statistic set thresholds     u.  column names values D.     row names approximate empirical percentage quantile levels     thresholds u. p length(u) length(D) numeric matrix     containing corresponding \\(p\\)-values test. theta length(u) length(D) numeric matrix     containing corresponding estimates \\(\\theta\\). u,D input u D.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_imt.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Information matrix test under the \\(D\\)-gaps model — dgaps_imt","text":"general approach follows Suveges Davison (2010).   \\(D\\)-gaps IMT performed grid   combinations threshold \\(D\\) vectors u   D.  estimate \\(\\theta\\) 0   IMT statistic, associated \\(p\\)-value NA.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_imt.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Information matrix test under the \\(D\\)-gaps model — dgaps_imt","text":"Holesovsky, J. Fusek, M. Estimation extremal index   using censored distributions. Extremes 23, 197-213 (2020).   doi:10.1007/s10687-020-00374-3 Suveges, M. Davison, . C. (2010) Model   misspecification peaks threshold analysis, Annals   Applied Statistics, 4(1), 203-221.   doi:10.1214/09-AOAS292","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_imt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Information matrix test under the \\(D\\)-gaps model — dgaps_imt","text":"","code":"### Newlyn sea surges  u <- quantile(newlyn, probs = seq(0.1, 0.9, by = 0.1)) imt <- dgaps_imt(newlyn, u = u, D = 1:5)  ### S&P 500 index  u <- quantile(sp500, probs = seq(0.1, 0.9, by = 0.1)) imt <- dgaps_imt(sp500, u = u, D = 1:5)  ### Cheeseboro wind gusts (a matrix containing some NAs)  probs <- c(seq(0.5, 0.98, by = 0.025), 0.99) u <- quantile(cheeseboro, probs = probs, na.rm = TRUE) imt <- dgaps_imt(cheeseboro, u = u, D = 1:5)  ### Uccle July temperatures  probs <- c(seq(0.7, 0.98, by = 0.025), 0.99) u <- quantile(uccle720m, probs = probs, na.rm = TRUE) imt <- dgaps_imt(uccle720m, u = u, D = 1:5)"},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_imt_stat.html","id":null,"dir":"Reference","previous_headings":"","what":"Statistics for the \\(D\\)-gaps information matrix test — dgaps_imt_stat","title":"Statistics for the \\(D\\)-gaps information matrix test — dgaps_imt_stat","text":"Calculates components required calculate value information matrix test \\(D\\)-gaps model, using vector data input. Called dgaps_imt.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_imt_stat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Statistics for the \\(D\\)-gaps information matrix test — dgaps_imt_stat","text":"","code":"dgaps_imt_stat(data, theta, u, D = 1, inc_cens = TRUE)"},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_imt_stat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Statistics for the \\(D\\)-gaps information matrix test — dgaps_imt_stat","text":"data numeric vector raw data.  Missing values allowed, appear non-missing values, , located start end vector.  Missing values omitted using na.omit. theta numeric scalar. estimate extremal index \\(\\theta\\), produced dgaps. u numeric scalar.  Extreme value threshold applied data. D numeric scalar.  censoring parameter \\(D\\). Threshold inter-exceedances times larger D units left-censored, occurring probability \\(\\log(1 - \\theta e^{-\\theta d})\\), \\(d = q D\\) \\(q\\) probability threshold \\(u\\) exceeded. inc_cens logical scalar indicating whether include contributions right-censored inter-exceedance times, relating first last observations. See dgaps.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_imt_stat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Statistics for the \\(D\\)-gaps information matrix test — dgaps_imt_stat","text":"list relating quantities given pages 18-19   Suveges Davison (2010).  last component vectors giving   contribution quantity \\(D\\)-gap, evaluated   input value theta \\(\\theta\\). ldj derivative log-likelihood respect     \\(\\theta\\) (score) Ij observed information Jj square score dj Jj - Ij Ddj derivative Jj - Ij respect     \\(\\theta\\) n_dgaps number \\(D\\)-gaps contribute     log-likelihood.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_imt_stat.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Statistics for the \\(D\\)-gaps information matrix test — dgaps_imt_stat","text":"Holesovsky, J. Fusek, M. Estimation extremal index   using censored distributions. Extremes 23, 197-213 (2020).   doi:10.1007/s10687-020-00374-3","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_methods.html","id":null,"dir":"Reference","previous_headings":"","what":"Methods for objects of class ","title":"Methods for objects of class ","text":"Methods objects class c(\"dgaps\", \"exdex\") returned dgaps.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_methods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for objects of class ","text":"","code":"# S3 method for class 'dgaps' coef(object, ...)  # S3 method for class 'dgaps' vcov(object, type = c(\"observed\", \"expected\"), ...)  # S3 method for class 'dgaps' nobs(object, ...)  # S3 method for class 'dgaps' logLik(object, ...)  # S3 method for class 'dgaps' print(x, digits = max(3L, getOption(\"digits\") - 3L), ...)  # S3 method for class 'dgaps' summary(   object,   se_type = c(\"observed\", \"expected\"),   digits = max(3, getOption(\"digits\") - 3L),   ... )  # S3 method for class 'summary.dgaps' print(x, ...)"},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_methods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for objects of class ","text":"object object class c(\"dgaps\", \"exdex\") returned dgaps. ... print.summary.dgaps, additional arguments passed print.default. type character scalar. estimate variance based observed information expected information? x print.dgaps. object class c(\"dgaps\", \"exdex\"),   result call dgaps. print.summary.dgaps. object class \"summary.dgaps\",   result call summary.dgaps. digits print.dgaps. argument digits   print.default. summary.dgaps. integer. Used number formatting   signif. se_type character scalar. estimate standard error based observed information expected information?","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_methods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Methods for objects of class ","text":"coef.dgaps. numeric scalar: estimate extremal index   \\(\\theta\\). vcov.dgaps. \\(1 \\times 1\\) numeric matrix containing   estimated variance estimator. nobs.dgaps. numeric scalar: number inter-exceedance times   used fit. x$inc_cens = TRUE includes 2   censored observations. logLik.dgaps. object class \"logLik\": numeric scalar   value equal maximised log-likelihood.  returned object   also attributes nobs, numbers \\(K\\)-gaps   contribute log-likelihood \"df\", equal   number total number parameters estimated (1). print.dgaps. argument x, invisibly. summary.dgaps. Returns list containing list element   object$call numeric matrix summary giving estimate   extremal index \\(\\theta\\) estimated standard error   (Std. Error). print.summary.dgaps. argument x, invisibly.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_methods.html","id":"examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Methods for objects of class ","text":"See examples dgaps.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_stat.html","id":null,"dir":"Reference","previous_headings":"","what":"Sufficient statistics for the left-censored inter-exceedances time model — dgaps_stat","title":"Sufficient statistics for the left-censored inter-exceedances time model — dgaps_stat","text":"Calculates sufficient statistics left-censored inter-exceedances time \\(D\\)-gaps model extremal index \\(\\theta\\).","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_stat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sufficient statistics for the left-censored inter-exceedances time model — dgaps_stat","text":"","code":"dgaps_stat(data, u, q_u, D = 1, inc_cens = TRUE)"},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_stat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sufficient statistics for the left-censored inter-exceedances time model — dgaps_stat","text":"data numeric vector raw data.  missing values allowed. u numeric scalar.  Extreme value threshold applied data. q_u numeric scalar.  estimate probability threshold u exceeded.  q_u missing calculated using mean(data > u, na.rm = TRUE). D numeric scalar.  Run parameter \\(K\\), defined Suveges Davison (2010).  Threshold inter-exceedances times larger k units assigned cluster, resulting \\(K\\)-gap equal zero.  Specifically, \\(K\\)-gap \\(S\\) corresponding inter-exceedance time \\(T\\) given \\(S = \\max(T - K, 0)\\). inc_cens logical scalar indicating whether include contributions right-censored inter-exceedance times relating first last observation.  known times greater equal time observed. See Attalides (2015) details.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_stat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sufficient statistics for the left-censored inter-exceedances time model — dgaps_stat","text":"list containing sufficient statistics, components N0 number left-censored inter-exceedance times. N1 contribution inter-exceedance times       left-censored (see Details). sum_qtd sum (scaled) inter-exceedance times       left-censored, ,       \\(q (I_0 T_0 + \\cdots + I_N T_N)\\),       \\(q\\) estimated proportion threshold       exceedances. n_dgaps number inter-exceedances contribute       log-likelihood. q_u sample proportion values exceed       threshold. D input value D.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_stat.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sufficient statistics for the left-censored inter-exceedances time model — dgaps_stat","text":"sample inter-exceedance times   \\(T_0, T_1, ..., T_{N-1}, T_N\\),   \\(T_1, ..., T_{N-1}\\) uncensored   \\(T_0\\) \\(T_N\\) right-censored.  assumption   inter-exceedance times independent, log-likelihood   \\(D\\)-gaps model given   $$l(\\theta; T_0, \\ldots, T_N) = N_0 \\log(1 - \\theta e^{-\\theta d}) +     2 N_1 \\log \\theta - \\theta q (I_0 T_0 + \\cdots + I_N T_N),$$    \\(q\\) threshold exceedance probability, estimated         proportion threshold exceedances, \\(d = q D\\), \\(I_j = 1\\) \\(T_j > D\\) \\(I_j = 0\\) otherwise, \\(N_0\\) number sample inter-exceedance times         left-censored, , less equal \\(D\\), (apart adjustment contributions \\(T_0\\)         \\(T_N\\)) \\(N_1\\) number inter-exceedance times         uncensored, , greater \\(D\\), specifically, inc_cens = TRUE \\(N_1\\) equal         number \\(T_1, ..., T_{N-1}\\)         uncensored plus \\((I_0 + I_N) / 2\\). differing treatment uncensored censored \\(K\\)-gaps reflects    differing contributions likelihood. Right-censored    inter-exceedance times whose observed values less equal    \\(D\\) add information likelihood know    part likelihood contribute. \\(N_1 = 0\\) degenerate case one    cluster (inter-exceedance times left-censored) likelihood    maximized \\(\\theta = 0\\). \\(N_0 = 0\\) exceedances occur singly (inter-exceedance    times left-censored) likelihood maximized    \\(\\theta = 1\\).","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_stat.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Sufficient statistics for the left-censored inter-exceedances time model — dgaps_stat","text":"Holesovsky, J. Fusek, M. Estimation extremal index   using censored distributions. Extremes 23, 197-213 (2020).   doi:10.1007/s10687-020-00374-3 Attalides, N. (2015) Threshold-based extreme value modelling,   PhD thesis, University College London.   https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/dgaps_stat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sufficient statistics for the left-censored inter-exceedances time model — dgaps_stat","text":"","code":"u <- quantile(newlyn, probs = 0.90) dgaps_stat(newlyn, u = u, D = 1) #> $N0 #> [1] 184 #>  #> $N1 #> [1] 105 #>  #> $sum_qtd #> [1] 270.5256 #>  #> $n_dgaps #> [1] 290 #>"},{"path":"https://github.com/paulnorthrop/exdex/reference/exdex-internal.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal exdex functions — exdex-internal","title":"Internal exdex functions — exdex-internal","text":"Internal exdex functions","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/exdex-internal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Internal exdex functions — exdex-internal","text":"","code":"spm_check(   data,   b,   sliding = TRUE,   bias_adjust = c(\"BB3\", \"BB1\", \"N\", \"none\"),   constrain = TRUE,   varN = TRUE,   which_dj = c(\"last\", \"first\") )  spm_sigmahat_dj(data, b, check = FALSE)  spm_R_quick(   data,   b,   bias_adjust = c(\"BB3\", \"BB1\", \"N\", \"none\"),   constrain = TRUE,   varN = TRUE,   which_dj = c(\"last\", \"first\") )  ests_sigmahat_dj(all_max, b, which_dj, bias_adjust)  log0const_slow(x, const)  log0const(x, const)  ecdf3(x, y)  ecdf2(x, y)  ecdf1(x, y, lenx)  sliding_maxima(x, b = 1)  disjoint_maxima(x, b = 1, which_dj = c(\"first\", \"last\"))  all_disjoint_maxima(x, b = 1, which_dj = c(\"all\", \"first\", \"last\"))  all_maxima(x, b = 1, which_dj = c(\"all\", \"first\", \"last\"))  kgaps_loglik(theta, N0, N1, sum_qs, n_kgaps)  kgaps_conf_int(theta_mle, ss, conf = 95)  kgaps_quad_solve(N0, N1, sum_qs)  kgaps_imt_old(data, u, k = 1)  kgaps_exp_info(theta, ss, inc_cens)  dgaps_loglik(theta, N0, N1, sum_qtd, n_dgaps, q_u, D)  g_theta(theta, q_u, D)  gd_theta(theta, q_u, D)  gdd_theta(theta, q_u, D)  gddd_theta(theta, q_u, D)  dgaps_exp_info(theta, ss, inc_cens)  dgaps_conf_int(theta_mle, ss, conf = 95)  iwls_fun(n_wls, N, S_1_sort, exp_qs, ws, nx)"},{"path":"https://github.com/paulnorthrop/exdex/reference/exdex-internal.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Internal exdex functions — exdex-internal","text":"functions intended called user.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/exdex-package.html","id":null,"dir":"Reference","previous_headings":"","what":"exdex: Estimation of the Extremal Index — exdex-package","title":"exdex: Estimation of the Extremal Index — exdex-package","text":"extremal index \\(\\theta\\) measure degree local dependence extremes stationary process.  exdex package  performs frequentist inference \\(\\theta\\) using methodologies proposed Northrop (2015), Berghaus Bucher (2018), Suveges (2007), Suveges Davison (2010) Holesovsky Fusek (2020).","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/exdex-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"exdex: Estimation of the Extremal Index — exdex-package","text":"Functions implement four estimators extremal index   provided, namely spm: semiparametric maxima estimator, using block     maxima: (Northrop, 2015; Berghaus Bucher, 2018) kgaps: \\(K\\)-gaps estimator, using threshold     inter-exceedance times (Suveges Davison, 2010) dgaps: \\(D\\)-gaps estimator, using threshold     inter-exceedance times (Holesovsky Fusek, 2020)) iwls: iterated weighted least squares estimator,     using threshold inter-exceedance times: (Suveges, 2007) functions choose_b, choose_uk choose_ud provide graphical diagnostics choosing respective tuning parameters semiparametric maxima, \\(K\\)-gaps \\(D\\)-gaps estimators. \\(K\\)-gaps \\(D\\)-gaps models `exdex` package allows missing values data, can accommodate independent subsets data, monthly seasonal time series different years, can incorporate information censored inter-exceedance times. See vignette(\"exdex-vignette\", package = \"exdex\") overview package.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/exdex-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"exdex: Estimation of the Extremal Index — exdex-package","text":"Berghaus, B., Bucher, . (2018) Weak convergence pseudo   maximum likelihood estimator extremal index. Ann. Statist.   46(5), 2307-2335. doi:10.1214/17-AOS1621 Holesovsky, J. Fusek, M. Estimation extremal index   using censored distributions. Extremes 23, 197-213 (2020).   doi:10.1007/s10687-020-00374-3 Northrop, P. J. (2015) efficient semiparametric maxima   estimator extremal index. Extremes 18(4), 585-603.   doi:10.1007/s10687-015-0221-5 Suveges, M. (2007) Likelihood estimation extremal   index. Extremes, 10, 41-55.   doi:10.1007/s10687-007-0034-2 Suveges, M. Davison, . C. (2010) Model   misspecification peaks threshold analysis, Annals   Applied Statistics, 4(1), 203-221.   doi:10.1214/09-AOAS292","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/exdex-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"exdex: Estimation of the Extremal Index — exdex-package","text":"Maintainer: Paul J. Northrop p.northrop@ucl.ac.uk [copyright holder] Authors: Constantinos Christodoulides [copyright holder]","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/iwls.html","id":null,"dir":"Reference","previous_headings":"","what":"Iterated weighted least squares estimation of the extremal index — iwls","title":"Iterated weighted least squares estimation of the extremal index — iwls","text":"Estimates extremal index \\(\\theta\\) using iterated weighted least squares method Suveges (2007).  moment estimates uncertainty provided.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/iwls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Iterated weighted least squares estimation of the extremal index — iwls","text":"","code":"iwls(data, u, maxit = 100)"},{"path":"https://github.com/paulnorthrop/exdex/reference/iwls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Iterated weighted least squares estimation of the extremal index — iwls","text":"data numeric vector raw data.  missing values allowed. u numeric scalar.  Extreme value threshold applied data. maxit numeric scalar.  maximum number iterations.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/iwls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Iterated weighted least squares estimation of the extremal index — iwls","text":"object (list) class \"iwls\", \"exdex\" containing theta estimate \\(\\theta\\). conv convergence indicator: 0 indicates successful       convergence; 1 indicates maxit reached. niter number iterations performed. n_gaps number time gaps successive       exceedances. call call iwls.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/iwls.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Iterated weighted least squares estimation of the extremal index — iwls","text":"iterated weighted least squares algorithm page 46   Suveges (2007) used estimate value extremal index.   approach uses time gaps successive exceedances   data data threshold u.  \\(\\)th   gap defined \\(T_i - 1\\), \\(T_i\\) difference   occurrence time exceedance \\(\\) exceedance \\(+ 1\\).   Therefore, threshold exceedances adjacent time points produce gap   zero. model underlying approach exponential-point mas mixture   scaled gaps, , gaps multiplied proportion   values  data exceed u.  model   scaled gaps zero (`within-cluster' inter-exceedance times)   probability \\(1 - \\theta\\) otherwise (`-cluster'   inter-exceedance times) follow exponential distribution mean   \\(1 / \\theta\\).   estimation method based fitting `broken stick' model   Ferro (2003) exponential quantile-quantile plot   scaled gaps.  Specifically, broken stick horizontal line   line gradient \\(1 / \\theta\\) intersect   \\((-\\log\\theta, 0)\\).  algorithm page 46   Suveges (2007) uses weighted least squares minimization applied   exponential   part model seek compromise role \\(\\theta\\)   proportion inter-exceedance times -cluster   reciprocal mean exponential distribution   inter-exceedance times.  weights (see Ferro (2003)) based   variances order statistics standard exponential sample: larger   order statistics larger sampling variabilities therefore   receive smaller weight smaller order statistics. Note step (1) algorithm page 46 Suveges   typo: \\(N_c + 1\\) \\(N\\), \\(N\\) number   threshold exceedances.  Also, gaps scaled detailed ,   mean.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/iwls.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Iterated weighted least squares estimation of the extremal index — iwls","text":"Suveges, M. (2007) Likelihood estimation extremal   index. Extremes, 10, 41-55.   doi:10.1007/s10687-007-0034-2 Ferro, C..T. (2003) Statistical methods clusters   extreme values. Ph.D. thesis, Lancaster University.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/iwls.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Iterated weighted least squares estimation of the extremal index — iwls","text":"","code":"### S&P 500 index  u <- quantile(sp500, probs = 0.60) theta <- iwls(sp500, u) theta #>  #> Call: #> iwls(data = sp500, u = u) #>  #> Convergence (0 means success): 0  #>  #> Estimate of the extremal index theta: #> [1]  0.7707 coef(theta) #> [1] 0.770706 nobs(theta) #> [1] 2899  ### Newlyn sea surges  u <- quantile(newlyn, probs = 0.90) theta <- iwls(newlyn, u) theta #>  #> Call: #> iwls(data = newlyn, u = u) #>  #> Convergence (0 means success): 0  #>  #> Estimate of the extremal index theta: #> [1]  0.2514"},{"path":"https://github.com/paulnorthrop/exdex/reference/iwls_methods.html","id":null,"dir":"Reference","previous_headings":"","what":"Methods for objects of class ","title":"Methods for objects of class ","text":"Methods objects class c(\"iwls\", \"exdex\") returned iwls.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/iwls_methods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for objects of class ","text":"","code":"# S3 method for class 'iwls' coef(object, ...)  # S3 method for class 'iwls' nobs(object, ...)  # S3 method for class 'iwls' print(x, digits = max(3L, getOption(\"digits\") - 3L), ...)"},{"path":"https://github.com/paulnorthrop/exdex/reference/iwls_methods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for objects of class ","text":"object object class c(\"iwls\", \"exdex\") returned iwls. ... arguments.  None used. x object class c(\"iwls\", \"exdex\"), result call iwls. digits argument digits print.default.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/iwls_methods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Methods for objects of class ","text":"coef.iwls. numeric scalar: estimate extremal index   \\(\\theta\\). nobs.iwls. numeric scalar: number inter-exceedance times   used fit. print.iwls. argument x, invisibly.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/iwls_methods.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Methods for objects of class ","text":"print.iwls prints original call iwls   estimate extremal index \\(\\theta\\).","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/iwls_methods.html","id":"examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Methods for objects of class ","text":"See examples iwls.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps.html","id":null,"dir":"Reference","previous_headings":"","what":"Maximum likelihood estimation for the \\(K\\)-gaps model — kgaps","title":"Maximum likelihood estimation for the \\(K\\)-gaps model — kgaps","text":"Calculates maximum likelihood estimates extremal index \\(\\theta\\) based \\(K\\)-gaps model threshold inter-exceedances times Suveges Davison (2010).","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Maximum likelihood estimation for the \\(K\\)-gaps model — kgaps","text":"","code":"kgaps(data, u, k = 1, inc_cens = TRUE)"},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Maximum likelihood estimation for the \\(K\\)-gaps model — kgaps","text":"data numeric vector numeric matrix raw data.  data   matrix log-likelihood constructed sum   (independent) contributions different columns. common situation   column relates different year. data contains missing values split_by_NAs   used divide data sequences non-missing values,   stored different columns matrix.  , log-likelihood   constructed sum contributions different columns. u numeric scalar.  Extreme value threshold applied data. k non-negative numeric scalar. Run parameter \\(K\\), defined Suveges Davison (2010).  Threshold inter-exceedances times larger k units assigned cluster, resulting \\(K\\)-gap equal zero. Specifically, \\(K\\)-gap \\(S\\) corresponding inter-exceedance time \\(T\\) given \\(S = \\max(T - K, 0)\\).  practice, \\(k\\) smaller 1, \\(k\\) less 1 estimate \\(\\theta\\) always equal 1. inc_cens logical scalar indicating whether include contributions right-censored inter-exceedance times, relating first last observations.  known times greater equal time observed. See Attalides (2015) details. data multiple columns right-censored first last inter-exceedance times column.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Maximum likelihood estimation for the \\(K\\)-gaps model — kgaps","text":"object (list) class c(\"kgaps\", \"exdex\") containing theta maximum likelihood estimate (MLE)       \\(\\theta\\). se estimated standard error MLE, calculated       using algebraic expression observed information.       k = 0 se returned 0. se_exp estimated standard error MLE,       calculated using algebraic expression expected information.       estimate \\(\\theta\\) 0 1 se_exp       NA. ss list summary statistics returned       kgaps_stat. k, u, inc_cens input values k,       u inc_cens. max_loglik value log-likelihood MLE. call call kgaps.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Maximum likelihood estimation for the \\(K\\)-gaps model — kgaps","text":"inc_cens = FALSE maximum likelihood estimate   extremal index \\(\\theta\\) \\(K\\)-gaps model   Suveges Davison (2010) calculated. inc_cens = TRUE information right-censored   first last inter-exceedance times also included likelihood   maximized, following Attalides (2015).  form   log-likelihood given Details section   kgaps_stat. possible estimate \\(\\theta\\) equal 1, also   possible equal 0. kgaps_stat explains   respective properties data cause events occur.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Maximum likelihood estimation for the \\(K\\)-gaps model — kgaps","text":"Suveges, M. Davison, . C. (2010) Model   misspecification peaks threshold analysis, Annals   Applied Statistics, 4(1), 203-221.   doi:10.1214/09-AOAS292 Attalides, N. (2015) Threshold-based extreme value modelling,   PhD thesis, University College London.   https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Maximum likelihood estimation for the \\(K\\)-gaps model — kgaps","text":"","code":"### S&P 500 index  u <- quantile(sp500, probs = 0.60) theta <- kgaps(sp500, u) theta #>  #> Call: #> kgaps(data = sp500, u = u) #>  #> Estimate of the extremal index theta: #>  theta   #> 0.6953   summary(theta) #>  #> Call: #> kgaps(data = sp500, u = u) #>  #>       Estimate Std. Error #> theta   0.6953   0.007234 coef(theta) #>     theta  #> 0.6953391  nobs(theta) #> [1] 2901 vcov(theta) #>              theta #> theta 5.232578e-05 logLik(theta) #> 'log Lik.' -3811.894 (df=1)  ### Newlyn sea surges  u <- quantile(newlyn, probs = 0.60) theta <- kgaps(newlyn, u, k = 2) theta #>  #> Call: #> kgaps(data = newlyn, u = u, k = 2) #>  #> Estimate of the extremal index theta: #>  theta   #> 0.1758   summary(theta) #>  #> Call: #> kgaps(data = newlyn, u = u, k = 2) #>  #>       Estimate Std. Error #> theta   0.1758   0.009211  ### Cheeseboro wind gusts  theta <- kgaps(cheeseboro, 45, k = 3) theta #>  #> Call: #> kgaps(data = cheeseboro, u = 45, k = 3) #>  #> Estimate of the extremal index theta: #>  theta   #> 0.2405   summary(theta) #>  #> Call: #> kgaps(data = cheeseboro, u = 45, k = 3) #>  #>       Estimate Std. Error #> theta   0.2405    0.02336"},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_confint.html","id":null,"dir":"Reference","previous_headings":"","what":"Confidence intervals for the extremal index \\(\\theta\\) for ","title":"Confidence intervals for the extremal index \\(\\theta\\) for ","text":"confint method objects class c(\"kgaps\", \"exdex\"). Computes confidence intervals \\(\\theta\\) based object returned kgaps.  Two types interval may returned: () intervals based approximate large-sample normality estimator \\(\\theta\\), symmetric point estimate, (b) likelihood-based intervals. plot method plots log-likelihood \\(\\theta\\), required confidence interval indicated plot.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_confint.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Confidence intervals for the extremal index \\(\\theta\\) for ","text":"","code":"# S3 method for class 'kgaps' confint(   object,   parm = \"theta\",   level = 0.95,   interval_type = c(\"both\", \"norm\", \"lik\"),   conf_scale = c(\"theta\", \"log\"),   constrain = TRUE,   se_type = c(\"observed\", \"expected\"),   ... )  # S3 method for class 'confint_kgaps' plot(x, ...)  # S3 method for class 'confint_kgaps' print(x, ...)"},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_confint.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Confidence intervals for the extremal index \\(\\theta\\) for ","text":"object object class c(\"kgaps\", \"exdex\"), returned kgaps. parm Specifies parameter given confidence interval. one option: extremal index \\(\\theta\\). level confidence level required.  numeric scalar (0, 1). interval_type character scalar: \"norm\" intervals type (), \"lik\" intervals type (b). conf_scale character scalar.  interval_type = \"norm\"   conf_scale determines scale use approximate   large-sample normality estimator estimate confidence intervals. conf_scale = \"theta\"   confidence intervals estimated \\(\\theta\\) directly.   conf_scale = \"log\" confidence intervals first   estimated \\(\\log\\theta\\) transformed back   \\(\\theta\\)-scale. constrain logical scalar.  constrain = TRUE confidence limits greater 1 set 1, , constrained lie (0, 1].  Otherwise, limits greater 1 may obtained. constrain = TRUE lower confidence limits less 0 set 0. se_type character scalar. confidence intervals interval_type  = \"norm\" use estimated standard error based observed information based expected information? ... plot.confint_kgaps: arguments passed   plot.confint. print.confint_kgaps: arguments passed   print.default. x object class c(\"confint_kgaps\", \"exdex\"), result call confint.kgaps.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_confint.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Confidence intervals for the extremal index \\(\\theta\\) for ","text":"list class c(\"confint_kgaps\", \"exdex\") containing   following components. cis matrix columns giving lower upper confidence   limits. labelled (1 - level)/2 1 - (1 - level)/2   % (default 2.5% 97.5%).   row names indicate type interval:   norm intervals based large sample normality lik   likelihood-based intervals.   object$k = 0 confidence limits returned   equal point estimate \\(\\theta\\). call call spm. object input object object. level input level. plot.confint_kgaps: nothing returned.    x$object$k = 0 plot produced. print.confint_kgaps: argument x, invisibly.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_confint.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Confidence intervals for the extremal index \\(\\theta\\) for ","text":"Two type interval calculated: () interval based   approximate large sample normality estimator \\(\\theta\\)   (conf_scale = \"theta\") \\(\\log\\theta\\)   (conf_scale = \"log\") (b) likelihood-based interval,   based approximate large sample chi-squared, 1 degree   freedom, distribution log-likelihood ratio statistic. print.confint_kgaps prints matrix confidence   intervals \\(\\theta\\).","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_confint.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Confidence intervals for the extremal index \\(\\theta\\) for ","text":"Suveges, M. Davison, . C. (2010) Model   misspecification peaks threshold analysis, Annals   Applied Statistics, 4(1), 203-221.   doi:10.1214/09-AOAS292","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_confint.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Confidence intervals for the extremal index \\(\\theta\\) for ","text":"","code":"u <- quantile(newlyn, probs = 0.90) theta <- kgaps(newlyn, u) cis <- confint(theta) cis #>          2.5 %    97.5 % #> norm 0.3334645 0.4223252 #> lik  0.3345564 0.4233067 plot(cis)"},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_imt.html","id":null,"dir":"Reference","previous_headings":"","what":"Information matrix test under the \\(K\\)-gaps model — kgaps_imt","title":"Information matrix test under the \\(K\\)-gaps model — kgaps_imt","text":"Performs information matrix test (IMT) Suveges Davison (2010) diagnose misspecification \\(K\\)-gaps model.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_imt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Information matrix test under the \\(K\\)-gaps model — kgaps_imt","text":"","code":"kgaps_imt(data, u, k = 1, inc_cens = TRUE)"},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_imt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Information matrix test under the \\(K\\)-gaps model — kgaps_imt","text":"data numeric vector numeric matrix raw data.  data   matrix log-likelihood constructed sum   (independent) contributions different columns. common situation   column relates different year. data contains missing values split_by_NAs   used divide data sequences non-missing values. u, k Numeric vectors.  u vector extreme value   thresholds applied data.  k vector values run   parameter \\(K\\), defined Suveges Davison (2010).   See kgaps details. values u greater observations   data removed without warning given. inc_cens logical scalar indicating whether include contributions censored inter-exceedance times, relating first last observations.  See Attalides (2015) details.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_imt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Information matrix test under the \\(K\\)-gaps model — kgaps_imt","text":"object (list) class c(\"kgaps_imt\", \"exdex\")   containing imt length(u) length(k) numeric matrix.     Column contains, \\(K\\) = k[], values     information matrix test statistic set thresholds     u.  column names values k.     row names approximate empirical percentage quantile levels     thresholds u. p length(u) length(k) numeric matrix     containing corresponding \\(p\\)-values test. theta length(u) length(k) numeric matrix     containing corresponding estimates \\(\\theta\\). u,k input u k.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_imt.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Information matrix test under the \\(K\\)-gaps model — kgaps_imt","text":"\\(K\\)-gaps IMT performed grid   combinations threshold \\(K\\) vectors u   k.  estimate \\(\\theta\\) 0   IMT statistic, associated \\(p\\)-value NA. details IMT see Suveges Davison   (2010).  typing errors pages 18-19   corrected producing code: penultimate term inside {...}   middle equation page 18 \\((c_j(K))^2\\),   penultimate term first equation page 19; {...}   bracket squared 4th equation page 19; factor   \\(n\\) \\(N-1\\) final equation page 19.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_imt.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Information matrix test under the \\(K\\)-gaps model — kgaps_imt","text":"Suveges, M. Davison, . C. (2010) Model   misspecification peaks threshold analysis, Annals   Applied Statistics, 4(1), 203-221.   doi:10.1214/09-AOAS292 Attalides, N. (2015) Threshold-based extreme value modelling,   PhD thesis, University College London.   https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_imt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Information matrix test under the \\(K\\)-gaps model — kgaps_imt","text":"","code":"### Newlyn sea surges  u <- quantile(newlyn, probs = seq(0.1, 0.9, by = 0.1)) imt <- kgaps_imt(newlyn, u = u, k = 1:5)  ### S&P 500 index  u <- quantile(sp500, probs = seq(0.1, 0.9, by = 0.1)) imt <- kgaps_imt(sp500, u = u, k = 1:5)  ### Cheeseboro wind gusts (a matrix containing some NAs)  probs <- c(seq(0.5, 0.98, by = 0.025), 0.99) u <- quantile(cheeseboro, probs = probs, na.rm = TRUE) imt <- kgaps_imt(cheeseboro, u = u, k = 1:5)"},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_imt_stat.html","id":null,"dir":"Reference","previous_headings":"","what":"Statistics for the information matrix test — kgaps_imt_stat","title":"Statistics for the information matrix test — kgaps_imt_stat","text":"Calculates components required calculate value information matrix test \\(K\\)-gaps model, using vector data input. Called kgaps_imt.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_imt_stat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Statistics for the information matrix test — kgaps_imt_stat","text":"","code":"kgaps_imt_stat(data, theta, u, k = 1, inc_cens = TRUE)"},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_imt_stat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Statistics for the information matrix test — kgaps_imt_stat","text":"data numeric vector raw data.  Missing values allowed, appear non-missing values, , located start end vector.  Missing values omitted using na.omit. theta numeric scalar. estimate extremal index \\(\\theta\\), produced kgaps. u numeric scalar.  Extreme value threshold applied data. k numeric scalar.  Run parameter \\(K\\), defined Suveges Davison (2010).  Threshold inter-exceedances times larger k units assigned cluster, resulting \\(K\\)-gap equal zero.  Specifically, \\(K\\)-gap \\(S\\) corresponding inter-exceedance time \\(T\\) given \\(S = \\max(T - K, 0)\\). inc_cens logical scalar indicating whether include contributions censored inter-exceedance times relating first last observation.  See Attalides (2015) details.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_imt_stat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Statistics for the information matrix test — kgaps_imt_stat","text":"list relating quantities given pages 18-19   Suveges Davison (2010).  last component vectors giving   contribution quantity \\(K\\)-gap, evaluated   input value theta \\(\\theta\\). ldj derivative log-likelihood respect     \\(\\theta\\) (score) Ij observed information Jj square score dj Jj - Ij Ddj derivative Jj - Ij respect     \\(\\theta\\) n_kgaps number \\(K\\)-gaps contribute     log-likelihood.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_imt_stat.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Statistics for the information matrix test — kgaps_imt_stat","text":"Suveges, M. Davison, . C. (2010) Model   misspecification peaks threshold analysis, Annals   Applied Statistics, 4(1), 203-221.   doi:10.1214/09-AOAS292 Attalides, N. (2015) Threshold-based extreme value modelling,   PhD thesis, University College London.   https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_methods.html","id":null,"dir":"Reference","previous_headings":"","what":"Methods for objects of class ","title":"Methods for objects of class ","text":"Methods objects class c(\"kgaps\", \"exdex\") returned kgaps.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_methods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for objects of class ","text":"","code":"# S3 method for class 'kgaps' coef(object, ...)  # S3 method for class 'kgaps' vcov(object, type = c(\"observed\", \"expected\"), ...)  # S3 method for class 'kgaps' nobs(object, ...)  # S3 method for class 'kgaps' logLik(object, ...)  # S3 method for class 'kgaps' print(x, digits = max(3L, getOption(\"digits\") - 3L), ...)  # S3 method for class 'kgaps' summary(   object,   se_type = c(\"observed\", \"expected\"),   digits = max(3, getOption(\"digits\") - 3L),   ... )  # S3 method for class 'summary.kgaps' print(x, ...)"},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_methods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for objects of class ","text":"object object class c(\"kgaps\", \"exdex\") returned kgaps. ... print.summary.kgaps, additional arguments passed print.default. type character scalar. estimate variance based observed information expected information? x print.kgaps. object class c(\"kgaps\", \"exdex\"),   result call kgaps. print.summary.kgaps. object class \"summary.kgaps\",   result call summary.kgaps. digits print.kgaps. argument digits   print.default. summary.kgaps. integer. Used number formatting   signif. se_type character scalar. estimate standard error based observed information expected information?","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_methods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Methods for objects of class ","text":"coef.kgaps. numeric scalar: estimate extremal index   \\(\\theta\\). vcov.kgaps. \\(1 \\times 1\\) numeric matrix containing   estimated variance estimator. nobs.kgaps. numeric scalar: number inter-exceedance times   used fit. x$inc_cens = TRUE includes 2   censored observations. logLik.kgaps. object class \"logLik\": numeric scalar   value equal maximised log-likelihood.  returned object   also attributes nobs, numbers \\(K\\)-gaps   contribute log-likelihood \"df\", equal   number total number parameters estimated (1). print.kgaps. argument x, invisibly. summary.kgaps. Returns list containing list element   object$call numeric matrix summary giving estimate   extremal index \\(\\theta\\) estimated standard error   (Std. Error). print.summary.kgaps. argument x, invisibly.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_methods.html","id":"examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Methods for objects of class ","text":"See examples kgaps.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_stat.html","id":null,"dir":"Reference","previous_headings":"","what":"Sufficient statistics for the \\(K\\)-gaps model — kgaps_stat","title":"Sufficient statistics for the \\(K\\)-gaps model — kgaps_stat","text":"Calculates sufficient statistics \\(K\\)-gaps model extremal index \\(\\theta\\). Called kgaps.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_stat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sufficient statistics for the \\(K\\)-gaps model — kgaps_stat","text":"","code":"kgaps_stat(data, u, q_u, k = 1, inc_cens = TRUE)"},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_stat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sufficient statistics for the \\(K\\)-gaps model — kgaps_stat","text":"data numeric vector raw data. u numeric scalar.  Extreme value threshold applied data. q_u numeric scalar.  estimate probability threshold u exceeded.  q_u missing calculated using mean(data > u, na.rm = TRUE). k numeric scalar.  Run parameter \\(K\\), defined Suveges Davison (2010).  Threshold inter-exceedances times larger k units assigned cluster, resulting \\(K\\)-gap equal zero.  Specifically, \\(K\\)-gap \\(S\\) corresponding inter-exceedance time \\(T\\) given \\(S = \\max(T - K, 0)\\). inc_cens logical scalar indicating whether include contributions right-censored inter-exceedance times relating first last observation.  known times greater equal time observed. See Attalides (2015) details.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_stat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sufficient statistics for the \\(K\\)-gaps model — kgaps_stat","text":"list containing sufficient statistics, components N0 number zero \\(K\\)-gaps. N1 contribution non-zero \\(K\\)-gaps (see       Details). sum_qs sum (scaled) \\(K\\)-gaps, ,       \\(q (S_0 + \\cdots + S_N)\\), \\(q\\)       estimated proportion threshold exceedances. n_kgaps number \\(K\\)-gaps contribute       log-likelihood.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_stat.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sufficient statistics for the \\(K\\)-gaps model — kgaps_stat","text":"sample \\(K\\)-gaps   \\(S_0, S_1, ..., S_{N-1}, S_N\\),   \\(S_1, ..., S_{N-1}\\) uncensored   \\(S_0\\) \\(S_N\\) right-censored.  assumption   \\(K\\)-gaps independent, log-likelihood \\(K\\)-gaps   model given   $$l(\\theta; S_0, \\ldots, S_N) = N_0 \\log(1 - \\theta) +     2 N_1 \\log \\theta - \\theta q (S_0 + \\cdots + S_N),$$    \\(q\\) threshold exceedance probability, estimated         proportion threshold exceedances, \\(N_0\\) number uncensored sample \\(K\\)-gaps         equal zero, (apart adjustment contributions \\(S_0\\)         \\(S_N\\)) \\(N_1\\) number positive sample         \\(K\\)-gaps, specifically, inc_cens = TRUE \\(N_1\\) equal         number \\(S_1, ..., S_{N-1}\\)         positive plus \\((I_0 + I_N) / 2\\), \\(I_0 = 1\\)         \\(S_0\\) greater zero \\(I_0 = 0\\) otherwise,         similarly \\(I_N\\). differing treatment uncensored right-censored \\(K\\)-gaps    reflects differing contributions likelihood.  Right-censored    \\(K\\)-gaps equal zero add information likelihood.    full details see Suveges Davison (2010) Attalides (2015). \\(N_1 = 0\\) degenerate case one    cluster (\\(K\\)-gaps zero) likelihood maximized    \\(\\theta = 0\\). \\(N_0 = 0\\) exceedances occur singly (\\(K\\)-gaps    positive) likelihood maximized \\(\\theta = 1\\).","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_stat.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Sufficient statistics for the \\(K\\)-gaps model — kgaps_stat","text":"Suveges, M. Davison, . C. (2010) Model   misspecification peaks threshold analysis, Annals   Applied Statistics, 4(1), 203-221.   doi:10.1214/09-AOAS292 Attalides, N. (2015) Threshold-based extreme value modelling,   PhD thesis, University College London.   https://discovery.ucl.ac.uk/1471121/1/Nicolas_Attalides_Thesis.pdf","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/kgaps_stat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sufficient statistics for the \\(K\\)-gaps model — kgaps_stat","text":"","code":"u <- quantile(newlyn, probs = 0.90) kgaps_stat(newlyn, u) #> $N0 #> [1] 184 #>  #> $N1 #> [1] 105 #>  #> $sum_qs #> [1] 259.9402 #>  #> $n_kgaps #> [1] 290 #>"},{"path":"https://github.com/paulnorthrop/exdex/reference/newlyn.html","id":null,"dir":"Reference","previous_headings":"","what":"Newlyn sea surges — newlyn","title":"Newlyn sea surges — newlyn","text":"vector newlyn contains 2894 maximum sea-surges measured Newlyn, Cornwall, UK period 1971-1976. observations maximum hourly sea-surge heights contiguous 15-hour time periods.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/newlyn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Newlyn sea surges — newlyn","text":"","code":"newlyn"},{"path":"https://github.com/paulnorthrop/exdex/reference/newlyn.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Newlyn sea surges — newlyn","text":"vector length 2894.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/newlyn.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Newlyn sea surges — newlyn","text":"Coles, S.G. (1991) Modelling extreme multivariate events. PhD thesis,   University Sheffield, U.K.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/newlyn.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Newlyn sea surges — newlyn","text":"Fawcett, L. Walshaw, D. (2012) Estimating return levels   serially dependent extremes. Environmetrics, 23(3),   272-283.  doi:10.1002/env.2133 Northrop, P. J. (2015) efficient semiparametric maxima   estimator extremal index. Extremes, 18,   585-603.  doi:10.1007/s10687-015-0221-5","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/plot.choose_b.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot block length diagnostic for the semiparametric maxima estimator — plot.choose_b","title":"Plot block length diagnostic for the semiparametric maxima estimator — plot.choose_b","text":"plot method objects inheriting class \"choose_b\", returned choose_b","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/plot.choose_b.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot block length diagnostic for the semiparametric maxima estimator — plot.choose_b","text":"","code":"# S3 method for class 'choose_b' plot(   x,   y,   ...,   estimator = c(\"N2015\", \"BB2018\"),   maxima = c(\"sliding\", \"disjoint\") )"},{"path":"https://github.com/paulnorthrop/exdex/reference/plot.choose_b.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot block length diagnostic for the semiparametric maxima estimator — plot.choose_b","text":"x object class c(\"choose_b\", \"exdex\"), result call choose_b. y used. ... Additional arguments passed matplot /axis. estimator Choice estimator: \"N2015\" Northrop (2015), \"BB2018\" Berghaus Bucher (2018). See spm details. maxima estimator based sliding disjoint maxima?","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/plot.choose_b.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot block length diagnostic for the semiparametric maxima estimator — plot.choose_b","text":"Nothing returned.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/plot.choose_b.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot block length diagnostic for the semiparametric maxima estimator — plot.choose_b","text":"Produces simple diagnostic plot aid choice block   length \\(b\\) based object returned choose_b.   Estimates \\(b\\) approximate conf% confidence intervals   plotted value \\(b\\) used produce estimate.   type confidence interval determined arguments   interval_type, conf_scale type provided   call choose_b.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/plot.choose_b.html","id":"examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot block length diagnostic for the semiparametric maxima estimator — plot.choose_b","text":"See examples choose_b.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/plot.choose_b.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Plot block length diagnostic for the semiparametric maxima estimator — plot.choose_b","text":"Northrop, P. J. (2015) efficient semiparametric maxima   estimator extremal index. Extremes 18(4), 585-603.   doi:10.1007/s10687-015-0221-5 Berghaus, B., Bucher, . (2018) Weak convergence pseudo   maximum likelihood estimator extremal index. Ann. Statist.   46(5), 2307-2335. doi:10.1214/17-AOS1621","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/plot.choose_ud.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot threshold \\(u\\) and runs parameter \\(D\\) diagnostic for the \\(D\\)-gaps estimator — plot.choose_ud","title":"Plot threshold \\(u\\) and runs parameter \\(D\\) diagnostic for the \\(D\\)-gaps estimator — plot.choose_ud","text":"plot method objects inheriting class \"choose_ud\", returned choose_ud","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/plot.choose_ud.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot threshold \\(u\\) and runs parameter \\(D\\) diagnostic for the \\(D\\)-gaps estimator — plot.choose_ud","text":"","code":"# S3 method for class 'choose_ud' plot(   x,   y = c(\"imts\", \"theta\"),   level = 0.95,   interval_type = c(\"norm\", \"lik\"),   conf_scale = c(\"theta\", \"log\"),   alpha = 0.05,   constrain = TRUE,   for_abline = list(lty = 2, lwd = 1, col = 1),   digits = 3,   uprob = FALSE,   leg_pos = if (y == \"imts\") \"topright\" else \"topleft\",   ... )"},{"path":"https://github.com/paulnorthrop/exdex/reference/plot.choose_ud.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot threshold \\(u\\) and runs parameter \\(D\\) diagnostic for the \\(D\\)-gaps estimator — plot.choose_ud","text":"x object class c(\"choose_ud\", \"exdex\"), result call choose_ud. y character scalar indicating plotted vertical axes plot: information matrix test statistics (IMTS) y = \"imts\" estimates \\(\\theta\\) y = \"theta\". y = \"theta\", either x$u x$D length one, 100level% confidence intervals added plot. level numeric scalar (0, 1).  confidence level used calculating confidence intervals \\(\\theta\\).  relevant y = \"theta\" either x$u x$D length one. interval_type character scalar.  type confidence interval plotted, y = \"theta\".  See confint.dgaps. conf_scale character scalar.  interval_type = \"norm\" conf_scale determines scale use approximate large-sample normality estimator estimate confidence intervals. See confint.dgaps. alpha numeric vector entries (0, 1). size test performed. constrain logical scalar.  argument constrain confint.dgaps. for_abline relevant y = \"imts\" one u D scalar. list graphical parameters passed abline indicate critical value information matrix test (IMT) implied alpha. digits integer. Used formatting value threshold signif adding value plot. uprob logical scalar. plot x$u horizontal axis (uprob = FALSE) approximate sample quantile x$u corresponds (uprob = TRUE)? leg_pos character scalar.  position legend added plot.  relevant arguments u D call choose_ud length greater one. ... Additional arguments passed matplot.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/plot.choose_ud.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot threshold \\(u\\) and runs parameter \\(D\\) diagnostic for the \\(D\\)-gaps estimator — plot.choose_ud","text":"Nothing returned.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/plot.choose_ud.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot threshold \\(u\\) and runs parameter \\(D\\) diagnostic for the \\(D\\)-gaps estimator — plot.choose_ud","text":"type plot produced depends mainly y. y = \"imts\" values IMTS plotted   thresholds x$u (corresponding approximate sample   quantile levels uprob = TRUE) value \\(D\\)   x$D.  Horizontal lines added indicate critical   values IMT significance levels alpha.   reject 100alpha% level combinations   threshold \\(D\\) corresponding values IMTS fall   line. y = \"theta\" estimates \\(\\theta\\) plotted   vertical axis.  x$u x$D$ length greater   one estimates plotted.  either x$u   x$D length one approximate 100level%   confidence intervals added plot variable,   x$u x$D length greater one plotted   horizontal axis.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/plot.choose_ud.html","id":"examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot threshold \\(u\\) and runs parameter \\(D\\) diagnostic for the \\(D\\)-gaps estimator — plot.choose_ud","text":"See examples choose_ud.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/plot.choose_uk.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot threshold \\(u\\) and runs parameter \\(K\\) diagnostic for the \\(K\\)-gaps estimator — plot.choose_uk","title":"Plot threshold \\(u\\) and runs parameter \\(K\\) diagnostic for the \\(K\\)-gaps estimator — plot.choose_uk","text":"plot method objects inheriting class \"choose_uk\", returned choose_uk","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/plot.choose_uk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot threshold \\(u\\) and runs parameter \\(K\\) diagnostic for the \\(K\\)-gaps estimator — plot.choose_uk","text":"","code":"# S3 method for class 'choose_uk' plot(   x,   y = c(\"imts\", \"theta\"),   level = 0.95,   interval_type = c(\"norm\", \"lik\"),   conf_scale = c(\"theta\", \"log\"),   alpha = 0.05,   constrain = TRUE,   for_abline = list(lty = 2, lwd = 1, col = 1),   digits = 3,   uprob = FALSE,   leg_pos = if (y == \"imts\") \"topright\" else \"topleft\",   ... )"},{"path":"https://github.com/paulnorthrop/exdex/reference/plot.choose_uk.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot threshold \\(u\\) and runs parameter \\(K\\) diagnostic for the \\(K\\)-gaps estimator — plot.choose_uk","text":"x object class c(\"choose_uk\", \"exdex\"), result call choose_uk. y character scalar indicating plotted vertical axes plot: information matrix test statistics (IMTS) y = \"imts\" estimates \\(\\theta\\) y = \"theta\". y = \"theta\", either x$u x$k length one, 100level% confidence intervals added plot. level numeric scalar (0, 1).  confidence level used calculating confidence intervals \\(\\theta\\).  relevant y = \"theta\" either x$u x$k length one. interval_type character scalar.  type confidence interval plotted, y = \"theta\".  See confint.kgaps. conf_scale character scalar.  interval_type = \"norm\" conf_scale determines scale use approximate large-sample normality estimator estimate confidence intervals. See confint.kgaps. alpha numeric vector entries (0, 1). size test performed. constrain logical scalar.  argument constrain confint.kgaps. for_abline relevant y = \"imts\" one u k scalar. list graphical parameters passed abline indicate critical value information matrix test (IMT) implied alpha. digits integer. Used formatting value threshold signif adding value plot. uprob logical scalar. plot x$u horizontal axis (uprob = FALSE) approximate sample quantile x$u corresponds (uprob = TRUE)? leg_pos character scalar.  position legend added plot.  relevant arguments u k call choose_uk length greater one. ... Additional arguments passed matplot.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/plot.choose_uk.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot threshold \\(u\\) and runs parameter \\(K\\) diagnostic for the \\(K\\)-gaps estimator — plot.choose_uk","text":"Nothing returned.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/plot.choose_uk.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot threshold \\(u\\) and runs parameter \\(K\\) diagnostic for the \\(K\\)-gaps estimator — plot.choose_uk","text":"type plot produced depends mainly y. y = \"imts\" values IMTS plotted   thresholds x$u (corresponding approximate sample   quantile levels uprob = TRUE) value \\(K\\)   x$k.  Horizontal lines added indicate critical   values IMT significance levels alpha.   reject 100alpha% level combinations   threshold \\(K\\) corresponding values IMTS fall   line. y = \"theta\" estimates \\(\\theta\\) plotted   vertical axis.  x$u x$k$ length greater   one estimates plotted.  either x$u   x$k length one approximate 100level%   confidence intervals added plot variable,   x$u x$k length greater one plotted   horizontal axis.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/plot.choose_uk.html","id":"examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot threshold \\(u\\) and runs parameter \\(K\\) diagnostic for the \\(K\\)-gaps estimator — plot.choose_uk","text":"See examples choose_uk.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/sp500.html","id":null,"dir":"Reference","previous_headings":"","what":"Daily log returns of the Standard and Poor (S&P) 500 index — sp500","title":"Daily log returns of the Standard and Poor (S&P) 500 index — sp500","text":"Daily log returns S&P 500 index, , log ratio successive daily closing prices, 3rd January 1990 9th October 2018.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/sp500.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Daily log returns of the Standard and Poor (S&P) 500 index — sp500","text":"","code":"sp500"},{"path":"https://github.com/paulnorthrop/exdex/reference/sp500.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Daily log returns of the Standard and Poor (S&P) 500 index — sp500","text":"vector length 7250, created using zoo   \"index\" attribute giving date corresponding negated   log return.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/sp500.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Daily log returns of the Standard and Poor (S&P) 500 index — sp500","text":"Yahoo finance: https://finance.yahoo.com/quote/^SPX/history/","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/split_by_NAs.html","id":null,"dir":"Reference","previous_headings":"","what":"Divides data into parts that contain no missing values — split_by_NAs","title":"Divides data into parts that contain no missing values — split_by_NAs","text":"Splits values numeric matrix column-wise sequences non-missing values.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/split_by_NAs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Divides data into parts that contain no missing values — split_by_NAs","text":"","code":"split_by_NAs(x)"},{"path":"https://github.com/paulnorthrop/exdex/reference/split_by_NAs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Divides data into parts that contain no missing values — split_by_NAs","text":"x vector matrix.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/split_by_NAs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Divides data into parts that contain no missing values — split_by_NAs","text":"matrix containing column run non-missing values   x.  number rows equal longest run non-missing   values x therefore nrow{x}.    matrix padded NA values end column,   necessary. returned object attribute called split_by_NAs_done   whose value TRUE, programming one can avoid calling   split_by_NAs .","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/split_by_NAs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Divides data into parts that contain no missing values — split_by_NAs","text":"column x, split_by_NAs finds runs   values contain missing values assigns column   matrix returned.  Different columns treated separately.   missing values column column appears   unmodified output matrix.  Please see Examples   illustrations.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/split_by_NAs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Divides data into parts that contain no missing values — split_by_NAs","text":"","code":"# Create a simple numeric matrix and insert some NAs x <- matrix(1:50, 10, 5) x[c(3, 8), 1] <- NA x[c(1:2, 5, 10), 3] <- NA x[1:3, 4] <- NA x[7:10, 5] <- NA x #>       [,1] [,2] [,3] [,4] [,5] #>  [1,]    1   11   NA   NA   41 #>  [2,]    2   12   NA   NA   42 #>  [3,]   NA   13   23   NA   43 #>  [4,]    4   14   24   34   44 #>  [5,]    5   15   NA   35   45 #>  [6,]    6   16   26   36   46 #>  [7,]    7   17   27   37   NA #>  [8,]   NA   18   28   38   NA #>  [9,]    9   19   29   39   NA #> [10,]   10   20   NA   40   NA  res <- split_by_NAs(x) res #>       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] #>  [1,]    1    4    9   11   23   26   34   41 #>  [2,]    2    5   10   12   24   27   35   42 #>  [3,]   NA    6   NA   13   NA   28   36   43 #>  [4,]   NA    7   NA   14   NA   29   37   44 #>  [5,]   NA   NA   NA   15   NA   NA   38   45 #>  [6,]   NA   NA   NA   16   NA   NA   39   46 #>  [7,]   NA   NA   NA   17   NA   NA   40   NA #>  [8,]   NA   NA   NA   18   NA   NA   NA   NA #>  [9,]   NA   NA   NA   19   NA   NA   NA   NA #> [10,]   NA   NA   NA   20   NA   NA   NA   NA #> attr(,\"split_by_NAs_done\") #> [1] TRUE  # An example of a character matrix x <- matrix(c(letters, letters[1:18]), 11, 4) x[c(1:2, 5:11), 2] <- NA x[c(2:4, 6:11), 3] <- NA x[1:10, 4] <- NA  res <- split_by_NAs(x) res #>       [,1] [,2] [,3] [,4] [,5] #>  [1,] \"a\"  \"n\"  \"w\"  \"a\"  \"r\"  #>  [2,] \"b\"  \"o\"  NA   NA   NA   #>  [3,] \"c\"  NA   NA   NA   NA   #>  [4,] \"d\"  NA   NA   NA   NA   #>  [5,] \"e\"  NA   NA   NA   NA   #>  [6,] \"f\"  NA   NA   NA   NA   #>  [7,] \"g\"  NA   NA   NA   NA   #>  [8,] \"h\"  NA   NA   NA   NA   #>  [9,] \"i\"  NA   NA   NA   NA   #> [10,] \"j\"  NA   NA   NA   NA   #> [11,] \"k\"  NA   NA   NA   NA   #> attr(,\"split_by_NAs_done\") #> [1] TRUE"},{"path":"https://github.com/paulnorthrop/exdex/reference/spm.html","id":null,"dir":"Reference","previous_headings":"","what":"Semiparametric maxima estimator of the extremal index — spm","title":"Semiparametric maxima estimator of the extremal index — spm","text":"Estimates extremal index \\(\\theta\\) using semiparametric block maxima estimator Northrop (2015) (\"N2015\") variant estimator studied Berghaus Bucher (2018) (\"BB2018\"), using sliding (overlapping) block maxima disjoint (non-overlapping) block maxima.  simple modification (subtraction \\(1 / b\\), \\(b\\) block size) Berghaus Bucher (2018) estimator (\"BB2018b\") also calculated.  Estimates uncertainty calculated using asymptotic theory developed Berghaus Bucher (2018).","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/spm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Semiparametric maxima estimator of the extremal index — spm","text":"","code":"spm(   data,   b,   bias_adjust = c(\"BB3\", \"BB1\", \"N\", \"none\"),   constrain = TRUE,   varN = TRUE,   which_dj = c(\"last\", \"first\") )"},{"path":"https://github.com/paulnorthrop/exdex/reference/spm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Semiparametric maxima estimator of the extremal index — spm","text":"data numeric vector raw data.  missing values allowed. b numeric scalar.  block size. bias_adjust character scalar.  bias-adjustment raw estimate \\(\\theta\\) performed using bias-reduced estimator (bias_adjust = \"BB3\"), derived Section 5 Berghaus Bucher (2018); simpler version (bias_adjust = \"BB1\"), raw estimate multiplied \\((k-1) / k\\), \\(k\\) number blocks; bias-adjustment empirical distribution function used calculate estimate, detailed Section 2 Northrop (2015).  disjoint maxima used bias_adjust = \"BB1\" bias_adjust = \"N\" give identical estimates Berghaus Bucher (2018) variant, explained end Section 5 Berghaus Bucher (2018). bias_adjust = \"none\" bias-adjustment performed. constrain logical scalar.  constrain = TRUE estimates greater 1 set 1, , constrained lie (0, 1].  carried bias-adjustment.  Otherwise, estimates greater 1 may obtained. varN logical scalar.  varN = TRUE estimation sampling variance Northrop (2015) estimator tailored estimator.  Otherwise, sampling variance derived Berghaus Bucher (2018) used. See Details information. which_dj character scalar.  Determines set disjoint maxima used calculate estimate \\(\\theta\\): \"first\", set whose first block starts first observation x; \"last\", set whose last block ends last observation x.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/spm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Semiparametric maxima estimator of the extremal index — spm","text":"list class c(\"spm\", \"exdex\") containing   components listed .  components vectors   labelled indicate estimator constituent values   relate: \"N2015\" Northrop (2015), \"BB2018\"   Berghaus Bucher (2018) \"BB2018b\" modified version. theta_sl, theta_dj Vectors containing estimates     \\(\\theta\\) resulting sliding maxima disjoint maxima     respectively. se_sl, se_dj estimated standard errors associated     estimates theta_sl theta_dj.     values \"BB2018\" \"BB2018b\" identical. bias_sl, bias_dj respective values       bias-adjustment applied raw estimates, , values       subtracted raw estimates.  estimator       BB2018b includes contribution subtraction       1 / b.       bias_adjust = \"N\" \"none\"       bias_sl bias_dj c(0, 0, 1 / b). raw_theta_sl, raw_theta_dj Vectors containing raw estimates     \\(\\theta\\), prior bias_adjustment. uncon_theta_sl, uncon_theta_dj (bias_adjusted) estimates     \\(\\theta\\) constraint lie (0, 1]     applied. data_sl, data_dj Matrices containing \\(Y\\)-data     \\(Z\\)-data sliding disjoint maxima respectively.     first columns \\(Y\\)-data, second columns     \\(Z\\)-data. sigma2dj, sigma2dj_for_sl Estimates variance    \\(\\sigma_{{\\rm dj}}^2\\)    defined pages 2314-2315 Berghaus Bucher (2018).    form estimates given page 2319.    sigma2dj used estimating standard error se_dj,    sigma2dj_for_sl estimating standard error se_sl. sigma2sl Estimates variance     \\(\\sigma_{{\\rm sl}}^2\\).     defined pages 2314-2315 Berghaus Bucher (2018).     form estimates given page 2319.     sigma2dj_for_sl used estimate     \\(\\sigma_{{\\rm dj}}^2\\) purpose. b input value b. bias_adjust input value bias_adjust. call call spm.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/spm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Semiparametric maxima estimator of the extremal index — spm","text":"extremal index \\(\\theta\\) estimated using   semiparametric maxima estimator Northrop (2015) variant   studied Berghaus Bucher (2018).  case sample   'data' derived input data data, based   empirical distribution function data evaluated   maximum values  blocks b contiguous values data. estimators based assumption 'data' sampled   approximately exponential distribution mean \\(1/\\theta\\).   details see page 2309 Berghaus Bucher (2018),   'data' Northrop (2015) estimator denoted \\(Y\\)   Berghaus Bucher (2018) denoted \\(Z\\).   convenience, refer values   \\(Y\\)-data \\(Z\\)-data. approximate nature model \\(Y\\)-data arises   estimation distribution function \\(F\\).    approximation motivates use \\(Z\\)-data.  \\(F\\) known   variable \\(Z / b\\) beta(1, \\(b\\theta\\)) distribution,   , \\(Z\\) mean \\(1 / (\\theta + 1/b)\\).   Therefore, exponential distribution mean \\(1 / (\\theta + 1/b)\\)   may provide better approximate model, provides motivation   subtracting \\(1 / b\\) Berghaus Bucher (2018) estimator.   Indeed, resulting estimates typically close   Northrop (2015) estimator. sliding = TRUE function uses sliding block maxima,   , largest value observed   (length(data) - b + 1) blocks b observations.   sliding = FALSE disjoint block maxima, ,   largest values (floor(n / b)) disjoint blocks b   observations, used. Estimation sampling variances estimators based   Proposition 4.1 page 2319 Berghaus Bucher (2018).   Northrop (2015) variant user choice either   use sampling variance based Berghaus Bucher (2018)   estimator, .e. \\(Z\\)-data (varN = FALSE) analogous   version tailored Northrop (2015) estimator uses   \\(Y\\)-data (varN = TRUE). estimates sampling variances sliding blocks estimators   inferred disjoint blocks estimators (see page 2319   Berhaus Bucher (2018)).  calculation latter uses set   disjoint block maxima.  length(data) integer   multiple b one set ,   equally valid.  event perform calculation   sets use mean resulting estimates.  reduces   sampling variability estimates expense slowing   calculation somewhat, particularly b small.  may   become apparent calling spm repeatedly   choose_b. estimator sampling variance sliding blocks estimator   constrained positive: negative estimate may result   block size small.  event   warning given returned object printed ,   affected estimator (\"N2015\" \"BB2018/BB2018b\"), corresponding estimated standard errors using sliding             blocks missing se_sl returned object, bias_adjust == \"BB3\" bias-adjustment             based bias_adjust == \"BB1\" instead performed             using sliding blocks, former relies             estimated variances estimators. Similarly, bias adjustment adjust = \"BB3\" /subtraction  \\(1 / b\\) \"BB2018b\" case may, rare cases, produce  negative estimate \\(\\theta\\).  instances estimate  zero returned, values returned bias_dj  bias_sl changed.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/spm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Semiparametric maxima estimator of the extremal index — spm","text":"Northrop, P. J. (2015) efficient semiparametric maxima   estimator extremal index. Extremes 18(4), 585-603.   doi:10.1007/s10687-015-0221-5 Berghaus, B., Bucher, . (2018) Weak convergence pseudo   maximum likelihood estimator extremal index. Ann. Statist.   46(5), 2307-2335. doi:10.1214/17-AOS1621","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/spm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Semiparametric maxima estimator of the extremal index — spm","text":"","code":"### Newlyn sea surges theta <- spm(newlyn, 20) theta #>  #> Call: #> spm(data = newlyn, b = 20) #>  #> Estimates of the extremal index theta: #>           N2015   BB2018  BB2018b #> sliding   0.2392  0.3078  0.2578  #> disjoint  0.2350  0.3042  0.2542  summary(theta) #>  #> Call: #> spm(data = newlyn, b = 20) #>  #>                   Estimate Std. Error Bias adj. #> N2015, sliding      0.2392    0.01990  0.003317 #> BB2018, sliding     0.3078    0.01642  0.003026 #> BB2018b, sliding    0.2578    0.01642  0.053030 #> N2015, disjoint     0.2350    0.02222  0.003726 #> BB2018, disjoint    0.3042    0.02101  0.003571 #> BB2018b, disjoint   0.2542    0.02101  0.053570 coef(theta) #>     N2015    BB2018   BB2018b  #> 0.2392234 0.3078219 0.2578219  nobs(theta) #> [1] 2875 vcov(theta) #>        N2015       BB2018      BB2018b  #> 0.0003960306 0.0002694754 0.0002694754   ### S&P 500 index theta <- spm(sp500, 100) theta #>  #> Call: #> spm(data = sp500, b = 100) #>  #> Estimates of the extremal index theta: #>           N2015   BB2018  BB2018b #> sliding   0.3264  0.3359  0.3259  #> disjoint  0.3248  0.3343  0.3243  summary(theta) #>  #> Call: #> spm(data = sp500, b = 100) #>  #>                   Estimate Std. Error Bias adj. #> N2015, sliding      0.3264    0.03348  0.007996 #> BB2018, sliding     0.3359    0.03343  0.008026 #> BB2018b, sliding    0.3259    0.03343  0.018030 #> N2015, disjoint     0.3248    0.03836  0.009045 #> BB2018, disjoint    0.3343    0.03862  0.009114 #> BB2018b, disjoint   0.3243    0.03862  0.019110"},{"path":"https://github.com/paulnorthrop/exdex/reference/spm_confint.html","id":null,"dir":"Reference","previous_headings":"","what":"Confidence intervals for the extremal index \\(\\theta\\) for ","title":"Confidence intervals for the extremal index \\(\\theta\\) for ","text":"confint method objects class c(\"spm\", \"exdex\"). Computes confidence intervals \\(\\theta\\) based object returned spm.  Two types interval may returned: () intervals based approximate large-sample normality estimators \\(\\theta\\) (\\(\\log\\theta\\) conf_scale = \"log\"), symmetric respective point estimates, (b) likelihood-based intervals based adjustment naive (pseudo-) loglikelihood, using adjust_loglik function chandwich package. plot method plots log-likelihood \\(\\theta\\), required confidence interval(s) indicated plot.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/spm_confint.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Confidence intervals for the extremal index \\(\\theta\\) for ","text":"","code":"# S3 method for class 'spm' confint(   object,   parm = \"theta\",   level = 0.95,   maxima = c(\"sliding\", \"disjoint\"),   interval_type = c(\"norm\", \"lik\", \"both\"),   conf_scale = c(\"theta\", \"log\"),   constrain = TRUE,   bias_adjust = TRUE,   type = c(\"vertical\", \"cholesky\", \"spectral\", \"none\"),   ... )  # S3 method for class 'confint_spm' plot(x, estimator = \"all\", ndec = 2, ...)  # S3 method for class 'confint_spm' print(x, ...)"},{"path":"https://github.com/paulnorthrop/exdex/reference/spm_confint.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Confidence intervals for the extremal index \\(\\theta\\) for ","text":"object object class c(\"spm\", \"exdex\"), returned spm. parm Specifies parameter given confidence interval. one option: extremal index \\(\\theta\\). level numeric scalar (0, 1). confidence level required. maxima character scalar specifying whether estimate confidence intervals based sliding maxima disjoint maxima. interval_type character scalar: \"norm\" intervals type (), \"lik\" intervals type (b). conf_scale character scalar.  interval_type = \"norm\"   conf_scale determines scale use approximate   large-sample normality estimators estimate confidence intervals   type (). conf_scale = \"theta\"   confidence intervals estimated \\(\\theta\\) directly.   conf_scale = \"log\" confidence intervals first   estimated \\(\\log\\theta\\) transformed back   \\(\\theta\\)-scale. bias-adjustment requested original call spm,   using bias_adjust argument, automatically applied . constrain logical scalar.  constrain = TRUE confidence limits greater 1 set 1, , constrained lie (0, 1].  Otherwise, limits greater 1 may obtained. constrain = TRUE lower confidence limits less 0 set 0. bias_adjust logical scalar.  bias_adjust = TRUE ,   appropriate, bias-adjustment also applied loglikelihood   adjusted using adjust_loglik.   performed , call   spm, bias_adjust = \"BB3\"   \"BB1\" specified, ,   object$bias_adjust = \"BB3\"   \"BB1\".  cases relevant   component object$bias_sl object$bias_dj   used scale \\(\\theta\\)   location maximum loglikelihood lies   bias-adjusted estimate \\(\\theta\\). bias_adjust = FALSE object$bias_adjust = \"none\"   \"N\" bias-adjustment   intervals performed.  latter case   bias-adjustment applied creation data   object$N2015_data object$BB2018_data,   naive likelihood based. type character scalar.  argument type passed conf_intervals chandwich package order estimate likelihood-based intervals. Using type = \"none\" advised intervals based naive estimated standard errors.  particular, (default) sliding = TRUE used call spm unadjusted likelihood-based confidence intervals provide vast underestimates uncertainty. ... Additional optional arguments passed print.default x object class c(\"confint_spm\", \"exdex\"), result call confint.spm. estimator character vector specifying three variants semiparametric maxima estimator include plot: \"N2015\", \"BB2018\" \"BB2018b\".  See spm details. estimator = \"\" three included. ndec integer scalar.  legend (included plot) contains confidence limits rounded ndec decimal places.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/spm_confint.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Confidence intervals for the extremal index \\(\\theta\\) for ","text":"list class c(\"confint_spm\", \"exdex\") containing   following components. cis matrix columns giving lower upper confidence   limits. labelled (1 - level)/2 1 - (1 - level)/2   % (default 2.5% 97.5%).   row names concatenation variant estimator   (N2015 Northrop (2015), BB2018   Berghaus Bucher (2018)), BB2018b modified   (subtracting 1 / b) Berghaus Bucher (2018)   type interval (norm symmetric lik   likelihood-based). ciN object returned     conf_intervals contains information     adjusted loglikelihood Northrop (2015) variant     estimator. ciBB object returned     conf_intervals contains information     adjusted loglikelihood Berghaus Bucher (2018) variant     estimator. ciBBb object returned     conf_intervals contains information     adjusted loglikelihood modified Berghaus Bucher (2018)     variant estimator. call call spm. object input object. maxima input maxima. theta relevant estimates \\(\\theta\\) returned     adjust_loglik.  equal     object$theta_sl maxima = \"sliding\",     object$theta_dj maxima = \"disjoint\",     provides check results correct. level input level. plot.confint_spm: nothing returned. print.confint_spm: argument x, invisibly.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/spm_confint.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Confidence intervals for the extremal index \\(\\theta\\) for ","text":"likelihood-based intervals estimated using   adjust_loglik function   chandwich package, followed call   conf_intervals.   adjusts naive (pseudo-)loglikelihood curvature   adjust loglikelihood agrees estimated standard errors   estimators.  option type = \"none\" used   practice resulting confidence intervals wrong.   particular, intervals based sliding maxima provide   vast underestimates uncertainty. object$se contains NAs, block size b   small large call spm   confidence intervals estimated.  matrix NAs   returned.  See Details section   spm documentation information. print.confint_spm prints matrix confidence   intervals \\(\\theta\\).","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/spm_confint.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Confidence intervals for the extremal index \\(\\theta\\) for ","text":"Northrop, P. J. (2015) efficient semiparametric maxima estimator extremal index. Extremes 18(4), 585-603.   doi:10.1007/s10687-015-0221-5 Berghaus, B., Bucher, . (2018) Weak convergence pseudo   maximum likelihood estimator extremal index. Ann. Statist.   46(5), 2307-2335. doi:10.1214/17-AOS1621","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/spm_confint.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Confidence intervals for the extremal index \\(\\theta\\) for ","text":"","code":"# Newlyn sea surges theta <- spm(newlyn, 20) confint(theta) #>                 2.5 %    97.5 % #> N2015norm   0.2002191 0.2782277 #> BB2018norm  0.2756477 0.3399961 #> BB2018bnorm 0.2256477 0.2899961 cis <- confint(theta, interval_type = \"lik\") cis #>                2.5 %    97.5 % #> N2015lik   0.2028802 0.2797593 #> BB2018lik  0.2771474 0.3407445 #> BB2018blik 0.2321583 0.2853566 plot(cis)   # S&P 500 index theta <- spm(sp500, 100) confint(theta) #>                 2.5 %    97.5 % #> N2015norm   0.2607322 0.3919727 #> BB2018norm  0.2704307 0.4014686 #> BB2018bnorm 0.2604307 0.3914686 cis <- confint(theta, interval_type = \"lik\") cis #>                2.5 %    97.5 % #> N2015lik   0.2664968 0.3946247 #> BB2018lik  0.2760426 0.4040249 #> BB2018blik 0.2678191 0.3919123 plot(cis)"},{"path":"https://github.com/paulnorthrop/exdex/reference/spm_methods.html","id":null,"dir":"Reference","previous_headings":"","what":"Methods for objects of class ","title":"Methods for objects of class ","text":"Methods objects class c(\"spm\", \"exdex\") returned spm.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/spm_methods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for objects of class ","text":"","code":"# S3 method for class 'spm' coef(   object,   maxima = c(\"sliding\", \"disjoint\"),   estimator = \"all\",   constrain = FALSE,   ... )  # S3 method for class 'spm' vcov(object, maxima = c(\"sliding\", \"disjoint\"), estimator = \"all\", ...)  # S3 method for class 'spm' nobs(object, maxima = c(\"sliding\", \"disjoint\"), ...)  # S3 method for class 'spm' print(x, digits = max(3L, getOption(\"digits\") - 3L), ...)  # S3 method for class 'spm' summary(object, digits = max(3, getOption(\"digits\") - 3L), ...)  # S3 method for class 'summary.spm' print(x, ...)"},{"path":"https://github.com/paulnorthrop/exdex/reference/spm_methods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for objects of class ","text":"object object class \"spm\", result call spm. maxima character scalar specifying whether return number observed sliding maxima disjoint maxima. estimator character vector specifying three variants semiparametric maxima estimator use: \"N2015\", \"BB2018\" \"BB2018b\". See spm details. estimator = \"\" estimated variances variants returned. constrain logical scalar.  constrain = TRUE estimates greater 1 set 1, , constrained lie (0, 1].  Otherwise, estimates greater 1 may obtained. ... print.summary.spm, additional arguments passed print.default. x print.spm. object class c(\"spm\", \"exdex\"),   result call spm. print.summary.spm. object class \"summary.spm\",   result call summary.spm. digits integer. Used number formatting signif.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/spm_methods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Methods for objects of class ","text":"coef.spm. numeric scalar (vector length 3   estimator = \"\"): required estimate(s) extremal index   \\(\\theta\\). vcov.spm. \\(1 \\times 1\\) numeric matrix   estimator = \"N2015\" \"BB2018\" vector length 3   estimator = \"\", containing estimated variance(s)   estimator(s). nobs.spm. numeric scalar: number observations used   fit. print.spm. argument x, invisibly. summary.spm. Returns object (list) class   \"summary.spm\" containing list element object$call   numeric matrix matrix giving, three variants   semiparametric estimator sliding disjoint blocks,   (bias-adjusted) Estimate extremal index \\(\\theta\\),   estimated standard error (Std. Error),   bias adjustment (Bias adj.) applied obtain estimate, .e.   value subtracted raw estimate.    (bias-adjusted) estimates greater 1 column   containing unconstrained estimates (Uncon. estimate) added. print.summary.spm. argument x, invisibly.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/spm_methods.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Methods for objects of class ","text":"print.spm prints original call spm   estimates extremal index \\(\\theta\\), based three   variants semiparametric maxima estimator sliding   disjoint blocks.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/spm_methods.html","id":"examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Methods for objects of class ","text":"See examples spm.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/exdex/reference/uccle.html","id":null,"dir":"Reference","previous_headings":"","what":"Uccle maximum daily temperatures — uccle","title":"Uccle maximum daily temperatures — uccle","text":"dataframe uccle contains daily maximum temperatures degrees C recorded Uccle, Belgium 1/1/1833 23/1/2011.  Station identifier source file 17 Source identifier 117882.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/uccle.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Uccle maximum daily temperatures — uccle","text":"","code":"uccle"},{"path":"https://github.com/paulnorthrop/exdex/reference/uccle.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Uccle maximum daily temperatures — uccle","text":"data frame 65036 observations following 5 variables. temp: daily maximum temperature degrees C. year: year. month: month year. day: day month. date: date Date class,   format YYYY-MM-DD.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/uccle.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Uccle maximum daily temperatures — uccle","text":"Klein Tank, .M.G. Coauthors, 2002. Daily dataset  20th-century surface air temperature precipitation series  European Climate Assessment. Int. J. Climatol., 22,  1441-1453 doi:10.1002/joc.773 . Data metadata available  https://www.ecad.eu.  data downloaded  27/3/2022 using  Custom query (ASCII),  selecting \"non-blend\" type series.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/uccle.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Uccle maximum daily temperatures — uccle","text":"5336 missing values.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/uccle720.html","id":null,"dir":"Reference","previous_headings":"","what":"20th century Uccle maximum daily temperatures in July - data frame — uccle720","title":"20th century Uccle maximum daily temperatures in July - data frame — uccle720","text":"dataframe uccle720 contains daily maximum temperatures degrees C recorded Uccle, Belgium July years 1901 1999. Station identifier source file 17 Source identifier 117882.  data analysed Holesovsky Fusek (2020).","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/uccle720.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"20th century Uccle maximum daily temperatures in July - data frame — uccle720","text":"","code":"uccle720"},{"path":"https://github.com/paulnorthrop/exdex/reference/uccle720.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"20th century Uccle maximum daily temperatures in July - data frame — uccle720","text":"data frame 3100 observations following 5 variables. temp: daily maximum temperature degrees C. year: year. month: month year. day: day month. date: date Date class,   format YYYY-MM-DD.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/uccle720.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"20th century Uccle maximum daily temperatures in July - data frame — uccle720","text":"Klein Tank, .M.G. Coauthors, 2002. Daily dataset  20th-century surface air temperature precipitation series  European Climate Assessment. Int. J. Climatol., 22,  1441-1453 doi:10.1002/joc.773 . Data metadata available  https://www.ecad.eu.  data downloaded  27/3/2022 using  Custom query (ASCII),  selecting \"non-blend\" type series.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/uccle720.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"20th century Uccle maximum daily temperatures in July - data frame — uccle720","text":"6 missing values, one located years   1925, 1926, 1956, 1963, 1969 1976.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/uccle720.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"20th century Uccle maximum daily temperatures in July - data frame — uccle720","text":"Holesovsky, J. Fusek, M. Estimation extremal index   using censored distributions. Extremes, 23, 197-213   (2020). doi:10.1007/s10687-020-00374-3","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/uccle720.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"20th century Uccle maximum daily temperatures in July - data frame — uccle720","text":"","code":"uccle720_ts <- ts(uccle720$temp, start = c(1901, 1), frequency = 31) plot(uccle720_ts, ylab = \"daily maximum temperature in July / degrees C\",      xlab = \"year\")"},{"path":"https://github.com/paulnorthrop/exdex/reference/uccle720m.html","id":null,"dir":"Reference","previous_headings":"","what":"20th century Uccle maximum daily temperatures in July - matrix — uccle720m","title":"20th century Uccle maximum daily temperatures in July - matrix — uccle720m","text":"matrix uccle720m contains daily maximum temperatures degrees C recorded Uccle, Belgium July years 1901 1999. Station identifier source file 17 Source identifier 117882.  data analysed Holesovsky Fusek (2020).","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/uccle720m.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"20th century Uccle maximum daily temperatures in July - matrix — uccle720m","text":"","code":"uccle720m"},{"path":"https://github.com/paulnorthrop/exdex/reference/uccle720m.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"20th century Uccle maximum daily temperatures in July - matrix — uccle720m","text":"31 100 numeric matrix.  Column contains maximum   daily temperature degrees C Uccle year 1900 + - 1.   columns named 1900, 1901, ..., 1999 rows named   day month: 1, 2, .., 31.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/uccle720m.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"20th century Uccle maximum daily temperatures in July - matrix — uccle720m","text":"Klein Tank, .M.G. Coauthors, 2002. Daily dataset  20th-century surface air temperature precipitation series  European Climate Assessment. Int. J. Climatol., 22,  1441-1453 doi:10.1002/joc.773 . Data metadata available  https://www.ecad.eu.  data downloaded  27/3/2022 using  Custom query (ASCII),  selecting \"non-blend\" type series.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/uccle720m.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"20th century Uccle maximum daily temperatures in July - matrix — uccle720m","text":"6 missing values, one located years   1925, 1926, 1956, 1963, 1969 1976.","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/uccle720m.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"20th century Uccle maximum daily temperatures in July - matrix — uccle720m","text":"Holesovsky, J. Fusek, M. Estimation extremal index   using censored distributions. Extremes, 23, 197-213   (2020). doi:10.1007/s10687-020-00374-3","code":""},{"path":"https://github.com/paulnorthrop/exdex/reference/uccle720m.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"20th century Uccle maximum daily temperatures in July - matrix — uccle720m","text":"","code":"uccle720_ts <- ts(uccle720$temp, start = c(1901, 1), frequency = 31) plot(uccle720_ts, ylab = \"daily maximum temperature in July / degrees C\",      xlab = \"year\")"},{"path":"https://github.com/paulnorthrop/exdex/news/index.html","id":"exdex-124","dir":"Changelog","previous_headings":"","what":"exdex 1.2.4","title":"exdex 1.2.4","text":"CRAN release: 2026-01-11","code":""},{"path":"https://github.com/paulnorthrop/exdex/news/index.html","id":"bug-fixes-and-minor-improvements-1-2-4","dir":"Changelog","previous_headings":"","what":"Bug fixes and minor improvements","title":"exdex 1.2.4","text":"Implements patch described Rcpp Issue #1406 avoid masking Rf_error().","code":""},{"path":"https://github.com/paulnorthrop/exdex/news/index.html","id":"exdex-123","dir":"Changelog","previous_headings":"","what":"exdex 1.2.3","title":"exdex 1.2.3","text":"CRAN release: 2023-12-02","code":""},{"path":"https://github.com/paulnorthrop/exdex/news/index.html","id":"bug-fixes-and-minor-improvements-1-2-3","dir":"Changelog","previous_headings":"","what":"Bug fixes and minor improvements","title":"exdex 1.2.3","text":"issue described https://github.com/RcppCore/Rcpp/issues/1287 fixed avoid WARNINGs CRAN checks platforms. Thank Dirk Eddelbuettel providing fix quickly! Fixed issues incorrect use Rd files.","code":""},{"path":"https://github.com/paulnorthrop/exdex/news/index.html","id":"exdex-122","dir":"Changelog","previous_headings":"","what":"exdex 1.2.2","title":"exdex 1.2.2","text":"CRAN release: 2023-09-10","code":""},{"path":"https://github.com/paulnorthrop/exdex/news/index.html","id":"bug-fixes-and-minor-improvements-1-2-2","dir":"Changelog","previous_headings":"","what":"Bug fixes and minor improvements","title":"exdex 1.2.2","text":"argument k = 0 supplied kgaps() estimate 1 returned extremal index input data. special case estimated standard error associated estimate set zero confidence intervals width zero. Corrected typing error description uprob documentation plot.choose_uk() plot.choose_ud(). unnecessary C++11 specification dropped avoid CRAN Package Check NOTE. README.md: Used app.codecov.io base codecov link. Create help file package correctly, alias exdex-package.","code":""},{"path":"https://github.com/paulnorthrop/exdex/news/index.html","id":"exdex-121","dir":"Changelog","previous_headings":"","what":"exdex 1.2.1","title":"exdex 1.2.1","text":"CRAN release: 2022-04-16","code":""},{"path":"https://github.com/paulnorthrop/exdex/news/index.html","id":"new-features-1-2-1","dir":"Changelog","previous_headings":"","what":"New features","title":"exdex 1.2.1","text":"new estimator implemented, based call D-gaps model Holesovsky, J. Fusek, M. Estimation extremal index using censored distributions. Extremes 23, 197–213 (2020). doi: 10.1007/s10687-020-00374-3","code":""},{"path":"https://github.com/paulnorthrop/exdex/news/index.html","id":"bug-fixes-and-minor-improvements-1-2-1","dir":"Changelog","previous_headings":"","what":"Bug fixes and minor improvements","title":"exdex 1.2.1","text":"value returned nobs.kgaps() incorrect cases censored K-gaps equal zero. K-gaps contribute number observations. corrected. cases data used kgaps split separate sequences, threshold exceedance probability estimated using data rather locally within sequence. logLik method objects inheriting class \"kgaps\" added. (unexported, internal) function kgaps_conf_int() limits confidence intervals extremal index based K-gaps model constrained manually (0, 1) avoid problems calculating likelihood-based confidence intervals cases log-likelihood greater interval cutoff theta = 1. documentation argument k kgaps() noted practice k smaller 1. function kgaps() also return standard errors based expected information. package manual related functions arranged sections easier reading. Activated 3rd edition testthat package","code":""},{"path":"https://github.com/paulnorthrop/exdex/news/index.html","id":"exdex-111","dir":"Changelog","previous_headings":"","what":"exdex 1.1.1","title":"exdex 1.1.1","text":"CRAN release: 2022-03-25","code":""},{"path":"https://github.com/paulnorthrop/exdex/news/index.html","id":"new-features-1-1-1","dir":"Changelog","previous_headings":"","what":"New features","title":"exdex 1.1.1","text":"matrix independent subsets data, monthly seasonal time series different years, contains missing values, , NAs. new dataset cheeseboro included, matrix containing missing values. addition kgaps(), functions kgaps_imt() choose_uk() now extra argument inc_cens, allows contributions censored K-gaps included log-likelihood extremal index. default value inc_cens kgaps() (kgaps_imt() choose_uk()) now inc_cens = TRUE.","code":""},{"path":"https://github.com/paulnorthrop/exdex/news/index.html","id":"bug-fixes-and-minor-improvements-1-1-1","dir":"Changelog","previous_headings":"","what":"Bug fixes and minor improvements","title":"exdex 1.1.1","text":"Plot print methods added objects class \"confint_gaps\" returned confint.kgaps(). confint.spm() confint.kgaps() input confidence level included output object.","code":""},{"path":"https://github.com/paulnorthrop/exdex/news/index.html","id":"exdex-101","dir":"Changelog","previous_headings":"","what":"exdex 1.0.1","title":"exdex 1.0.1","text":"CRAN release: 2019-08-06","code":""},{"path":"https://github.com/paulnorthrop/exdex/news/index.html","id":"bug-fixes-and-minor-improvements-1-0-1","dir":"Changelog","previous_headings":"","what":"Bug fixes and minor improvements","title":"exdex 1.0.1","text":"overloading ambiguity corrected ensure installation Solaris.","code":""}]
